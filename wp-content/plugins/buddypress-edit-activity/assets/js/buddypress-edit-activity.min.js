function buddypress_edit_activity_initiate(a){return jQuery(a).hasClass("action-save")?buddypress_edit_activity_save(a):buddypress_edit_activity_get(a),!1}function buddypress_edit_activity_get(a){if(1==jQuery("li.activity-item #buddypress-edit-activity-wrapper").length&&($edit_wrapper=jQuery("li.activity-item #buddypress-edit-activity-wrapper"),$cancel_button=$edit_wrapper.next().children(".buddyboss_edit_activity_cancel"),$cancel_button.trigger("click"),window.keep_activity_changes))return!1;$link=jQuery(a),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),$link.hasClass("buddyboss_edit_activity_comment")?B_E_A_.current_activity_org=$link.closest("[id^=acomment]").find(" > .acomment-content").html():B_E_A_.current_activity_org=$link.closest(".activity-content").find(".activity-inner").html();var b={action:$form.find('input[name="action_get"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id")};jQuery.ajax({type:"POST",url:ajaxurl,data:b,success:function(a){if(a=jQuery.parseJSON(a),a.status){$link.removeClass("loading").addClass("action-save").html(B_E_A_.button_text.save);var c=jQuery("<a href='#'>").addClass("bp-secondary-action buddyboss_edit_activity_cancel").html(B_E_A_.button_text.cancel);$link.before(c),c.attr("onclick","return buddypress_edit_activity_cancel(this);"),c.data("target_type","activity"),$link.hasClass("buddyboss_edit_activity_comment")?($link.closest("[id^=acomment]").find(" > .acomment-content").html("").hide().after($form_wrapper),c.data("target_type","comment")):($link.closest(".activity-content").find(".activity-inner").html("").hide().after($form_wrapper),c.addClass("button")),$form_wrapper.show(),$form.find('input[name="activity_id"]').val(b.activity_id),$form.find("textarea").val(a.content)}}})}function buddypress_edit_activity_save(a){$link=jQuery(a),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),jQuery(".buddyboss_edit_activity_cancel").remove();var b={action:$form.find('input[name="action_save"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id"),content:$form.find("textarea").val()};jQuery.ajax({type:"POST",url:ajaxurl,data:b,success:function(a){a=jQuery.parseJSON(a),a.status&&($link.removeClass("loading").removeClass("action-save").html(B_E_A_.button_text.edit),$link.hasClass("buddyboss_edit_activity_comment")?$link.closest("[id^=acomment]").find(" > .acomment-content").html(a.content).show():$link.closest(".activity-content").find(".activity-inner").html(a.content).show(),$form_wrapper.hide(),jQuery("body").append($form_wrapper),window.activity_content_changed=!1,window.keep_activity_changes=!1)}})}function buddypress_edit_activity_cancel(a){if(window.activity_content_changed&&!window.confirm(B_E_A_.warn_activity_changes))return window.keep_activity_changes=!0,!1;var b=jQuery(a),c=jQuery("#frm_buddypress-edit-activity"),d=c.parent(),e="";return"comment"==b.data("target_type")?(b.closest("[id^=acomment]").find(" > .acomment-content").html(B_E_A_.current_activity_org).show(),e=b.closest("[id^=acomment]").find(".buddyboss_edit_activity_comment.action-save")):(b.closest(".activity-content").find(".activity-inner").html(B_E_A_.current_activity_org).show(),e=b.closest(".activity-content").find(".buddyboss_edit_activity.action-save")),e.removeClass("action-save").html(B_E_A_.button_text.edit),d.hide(),jQuery("body").append(d),b.remove(),window.activity_content_changed=!1,window.keep_activity_changes=!1,!1}jQuery('textarea[name="activity_content"]').on("change",function(a){window.activity_content_changed=!0}),jQuery(".acomment-reply").on("click",function(a){1==jQuery("li.activity-item #buddypress-edit-activity-wrapper").length&&($edit_wrapper=jQuery("li.activity-item #buddypress-edit-activity-wrapper"),$cancel_button=$edit_wrapper.next().children(".buddyboss_edit_activity_cancel"),$cancel_button.trigger("click"))});