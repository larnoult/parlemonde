!function t(e,i,n){function o(d,_){if(!i[d]){if(!e[d]){var s="function"==typeof require&&require;if(!_&&s)return s(d,!0);if(a)return a(d,!0);var r=new Error("Cannot find module '"+d+"'");throw r.code="MODULE_NOT_FOUND",r}var m=i[d]={exports:{}};e[d][0].call(m.exports,function(t){var i=e[d][1][t];return o(i||t)},m,m.exports,t,e,i,n)}return i[d].exports}for(var a="function"==typeof require&&require,d=0;d<n.length;d++)o(n[d]);return o}({1:[function(t,e,i){"use strict";window.wpmdb=window.wpmdb||{},wpmdb.mst={remote_mst_unavailable:!1},function(t,e){function i(){return!("1"!==C.attr("data-available")||!C.is(":checked"))}function n(){return"true"===wpmdb_data.site_details.is_multisite}function o(){return void 0!==e.mst.remote_connection_data&&void 0!==e.mst.remote_connection_data.site_details&&void 0!==e.mst.remote_connection_data.site_details.is_multisite&&"true"===e.mst.remote_connection_data.site_details.is_multisite}function a(){t.wpmdb.do_action("wpmdb_lock_replace_url",!1),t.wpmdb.do_action("wpmdb_enable_table_migration_options"),C.attr("data-available","0"),C.prop("checked",!1),C.attr("disabled","disabled"),t(".mst").addClass("disabled"),k.hide()}function d(){C.attr("data-available","1"),C.removeAttr("disabled"),t(".mst").removeClass("disabled")}function _(_){if(-1!==t.inArray(e.functions.wpmdb_migration_type(),["savefile","find_replace"])&&!n())return a(),void x.hide();if("import"===e.functions.wpmdb_migration_type())return a(),void x.hide();if(T&&(void 0!==e.mst.remote_connection_data||-1===t.inArray(e.migration_selection,["push","pull"]))){if(!n()&&!o())return a(),void x.hide();if(n()&&o())return a(),void x.hide();if("savefile"!==e.functions.wpmdb_migration_type()&&!1===_&&void 0!==e.mst.remote_connection_data&&void 0!==e.mst.remote_connection_data.site_details&&wpmdb_data.site_details.prefix!==e.mst.remote_connection_data.site_details.prefix)return a(),f(!1),t(".mst-remote-location").html(e.mst.remote_connection_data.url),t(".mst-remote-prefix").html(e.mst.remote_connection_data.site_details.prefix),void R.show();if(R.hide(),_&&"savefile"!==e.functions.wpmdb_migration_type())return a(),f(!1),void L.show();if(L.hide(),"savefile"!==e.functions.wpmdb_migration_type()&&void 0!==e.mst.remote_connection_data&&wpmdb_data.mst_version!==e.mst.remote_connection_data.mst_version)return a(),f(!1),t(".mst-remote-location").html(e.mst.remote_connection_data.url),t(".mst-remote-version").html(e.mst.remote_connection_data.mst_version),void D.show();D.hide(),d(),i()?(k.show(),u()):k.hide(),s(),x.show()}}function s(){i()&&-1===t.inArray(e.functions.wpmdb_migration_type(),["savefile","find_replace"])?t.wpmdb.do_action("wpmdb_lock_replace_url",!0):t.wpmdb.do_action("wpmdb_lock_replace_url",!1)}function r(){n()||o()?t.wpmdb.do_action("wpmdb_pin_replace_url",!0):t.wpmdb.do_action("wpmdb_pin_replace_url",!1)}function m(){return"pull"===e.functions.wpmdb_migration_type()&&n()||"push"===e.functions.wpmdb_migration_type()&&o()}function l(){if(""!==q.val()){if("savefile"!==e.functions.wpmdb_migration_type()){E.hide(),O.show(),A.children("label").addClass("disabled");var t=z,i=p();m()&&void 0!==i.blog_id&&1<i.blog_id&&(t=t+i.blog_id+"_"),E.val(t),N.val(t),O.text(t)}else E.show(),O.hide(),A.children("label").removeClass("disabled");A.show()}else A.hide()}function c(){var e=i();s(),t.wpmdb.do_action("wpmdbmst_select_subsite_changed",e)}function p(){var t={};if(i()){var e=q.find("option:selected").val();""===e&&(e=b()),""===e?t=!1:(t.blog_id=e,t.domain_and_path=q.find("option:selected").text())}return t}function b(){var t="";return void 0===wpmdb_data.mst_selected_subsite||isNaN(wpmdb_data.mst_selected_subsite)||(t=wpmdb_data.mst_selected_subsite),t}function u(){var e=p();t.wpmdb.do_action("wpmdbmst_selected_subsite_changed",e)}function f(i){var n=U;if(void 0!==i&&"find_replace"!==e.functions.wpmdb_migration_type()){void 0!==i.domain_and_path&&(n="//"+i.domain_and_path);var o=!1;m()&&(o=!0),j&&(o=!o),o?t('.replace-row.pin .replace-right-col input[type="text"]').val(n):t('.replace-row.pin .old-replace-col input[type="text"]').val(n)}}function w(t,i){var n=p();if(void 0!==n.blog_id){if(!(1<n.blog_id)){var o=e.preg_quote(i);return null==new RegExp(t+"([0-9]+)_","i").exec(o)}if(t=t+n.blog_id+"_",0===i.toLowerCase().indexOf(t.toLowerCase()))return!0}return!1}function v(t){var i=e.preg_quote(t);return null==new RegExp("[^a-z0-9_]","i").exec(i)}function g(t){e.mst.remote_connection_data=t,e.mst.remote_mst_unavailable=void 0===t.mst_available}function h(){!1!==i()&&o()&&(n()&&!o()?y(wpmdb_data.site_details.subsites):!n()&&o()&&y(e.mst.remote_connection_data.site_details.subsites))}function y(e){var i=p();t(q).empty(),t(q).append('<option value="">-- '+wpmdbmst_strings.select_subsite+" --</option>"),t.each(e,function(e,n){if(!t.wpmdb.apply_filters("wpmdb_exclude_subsite",!1,n)){var o=" ";!1!==i&&e===i.blog_id&&(o=' selected="selected" '),t(q).append("<option"+o+'value="'+e+'">'+n+"</option>")}})}var x=t(".mst-options"),C=t("#mst-select-subsite"),k=t(".mst-options .expandable-content"),q=t("#mst-selected-subsite"),A=t(".new-prefix-field"),E=t("#new-prefix"),N=t("#new-prefix-hidden"),O=t("#new-prefix-readonly"),L=t(".mst-unavailable"),D=t(".mst-different-plugin-version-notice"),R=t(".mst-different-prefix-notice"),T=!1,U=null,j=!1,z=t(".table-select-wrap .table-prefix").text(),F=!1;t.wpmdb.add_action("move_connection_info_box",function(i){z=t(".table-select-wrap .table-prefix").text(),null===U&&(U=t.wpmdb.apply_filters("wpmdb_base_old_url")),void 0!==i.migration_type&&void 0!==i.last_migration_type&&(i.migration_type===i.last_migration_type||"pull"!==i.migration_type&&"pull"!==i.last_migration_type||(j=!0)),e.functions.wpmdb_toggle_migration_action_text(),_(e.mst.remote_mst_unavailable),t.wpmdb.do_action("wpmdb_refresh_table_selects"),j&&(j=!1)}),t.wpmdb.add_action("verify_connection_to_remote_site",function(t){g(t),_(e.mst.remote_mst_unavailable),T=!0}),t.wpmdb.add_action("wpmdbmst_select_subsite_changed",h),t.wpmdb.add_action("wpmdbmst_select_subsite_changed",u),t.wpmdb.add_action("wpmdbmst_selected_subsite_changed",function(n){t.wpmdb.do_action("wpmdb_refresh_table_selects"),"pull"===e.functions.wpmdb_migration_type()?t.wpmdb.do_action("wpmdb_update_pull_table_select"):t.wpmdb.do_action("wpmdb_update_push_table_select"),i()?(t.wpmdb.do_action("wpmdb_disable_table_migration_options"),(T&&(!1===F||void 0!==F.blog_id&&void 0!==n.blog_id&&F.blog_id!==n.blog_id)||-1!==t.inArray(e.functions.wpmdb_migration_type(),["savefile","find_replace"]))&&t.wpmdb.do_action("wpmdb_select_all_tables")):t.wpmdb.do_action("wpmdb_enable_table_migration_options"),F=n}),t.wpmdb.add_action("wpmdbmst_selected_subsite_changed",f),t.wpmdb.add_action("wpmdbmst_selected_subsite_changed",l),t.wpmdb.add_action("move_connection_info_box",r),t.wpmdb.add_action("move_connection_info_box",h),t.wpmdb.add_action("move_connection_info_box",function(n){void 0!==e.mst.remote_connection_data&&i()&&n.last_migration_type!==n.migration_type&&setTimeout(function(){t.wpmdb.do_action("wpmdb_select_all_tables")})}),t.wpmdb.add_action("wpmdb_connection_data_updated",g),t.wpmdb.add_action("wpmdb_connection_data_updated",r),t.wpmdb.add_action("wpmdb_connection_data_updated",h),t.wpmdb.add_filter("wpmdb_exclude_table",function(a,d){if(i()){if(!1===p())return!0;if(d.substr(0,z.length)!==z)return!0;if(1===e.subsite_for_table(z,d)){if(e.table_is(z,"users",d)||e.table_is(z,"usermeta",d))return a;var _=["blog_versions","blogs","registration_log","signups","site","sitemeta"];t.each(_,function(t,i){e.table_is(z,i,d)&&(a=!0)})}if("pull"===e.functions.wpmdb_migration_type()&&!o())return a;if("push"===e.functions.wpmdb_migration_type()&&!n())return a;!1===w(z,d)&&(a=!0)}return a}),t.wpmdb.add_filter("wpmdb_migration_profile_ready",function(t,e){if(!1===i())return t;var n=E.val();return!1===p()?(alert(wpmdbmst_strings.please_select_a_subsite),t=!1):0===n.trim().length?(alert(wpmdbmst_strings.please_enter_a_prefix),t=!1):!1===v(n)&&(alert(wpmdbmst_strings.new_prefix_contents),t=!1),t}),t.wpmdb.add_filter("wpmdb_backup_selected_tables",function(a){if(i()&&"find_replace"!==e.functions.wpmdb_migration_type()){var d=p();!(void 0!==d.blog_id&&1<d.blog_id)||n()&&o()||t.each(a,function(t,i){!1===e.table_is(z,"users",i)&&!1===e.table_is(z,"usermeta",i)&&(!1===w(z,i)&&m()&&(a[t]=E.val()+i.substr(z.length)),!0!==w(z,i)||m()||(a[t]=E.val()+i.substr((z+d.blog_id+"_").length)))})}return a}),t.wpmdb.add_filter("wpmdbmf_enable_select_subsites",function(t){return!1!==t&&i()&&(t=!1),t}),l(),t(document).ready(function(){t("body").on("change","#mst-select-subsite",function(t){c()}),t("body").on("change","#mst-selected-subsite",function(t){u()}),_(e.mst.remote_mst_unavailable)})}(jQuery,wpmdb)},{}]},{},[1]);