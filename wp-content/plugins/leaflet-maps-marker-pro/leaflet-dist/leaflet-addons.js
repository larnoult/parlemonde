/*
* Async Google Maps API loading
*/
L.DeferredLayer=L.LayerGroup.extend({options:{js:[],init:null},_script_cache:{},initialize:function(a){L.Util.setOptions(this,a),L.LayerGroup.prototype.initialize.apply(this),this._loaded=!1},onAdd:function(a){if(L.LayerGroup.prototype.onAdd.apply(this,[a]),!this._loaded){var b=function(){this._loaded=!0;var a=this.options.init();a&&this.addLayer(a)};this._loadScripts(this.options.js.reverse(),L.Util.bind(b,this))}},_loadScripts:function(a,b,c){function h(){d._loadScripts(a,b,c)}if(!a||0===a.length)return b(c);var f,d=this,e=a.pop();if(f=this._script_cache[e],void 0===f){f={url:e,wait:[]};var g=document.createElement("script");g.src=e,g.type="text/javascript",g.onload=function(){f.e.readyState="completed";var a=0;for(a=0;a<f.wait.length;a++)f.wait[a]()},f.e=g,document.getElementsByTagName("head")[0].appendChild(g)}f.wait.push(h),"completed"===f.e.readyState&&h(),this._script_cache[e]=f}});
/*
 * ES6 Promise for IE11 (needed for GoogleMutant)
*/
"undefined"==typeof Promise&&"google_mutant"==mapsmarkerjspro.google_maps_plugin&&function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){z=t}function r(t){B=t}function o(){return void 0!==W?function(){W(s)}:i()}function i(){var t=setTimeout;return function(){return t(s,1)}}function s(){for(var t=0;t<U;t+=2)(0,R[t])(R[t+1]),R[t]=void 0,R[t+1]=void 0;U=0}function u(t,e){var n=arguments,r=this,o=new this.constructor(a);void 0===o[X]&&M(o);var i=r._state;return i?function(){var t=n[i-1];B(function(){return E(i,o,t,r._result)})}():w(r,o,t,e),o}function c(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(a);return y(n,t),n}function a(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function l(){return new TypeError("A promises callback cannot return that same promise.")}function h(t){try{return t.then}catch(t){return et.error=t,et}}function p(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function d(t,e,n){B(function(t){var r=!1,o=p(n,e,function(n){r||(r=!0,e!==n?y(t,n):g(t,n))},function(e){r||(r=!0,b(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,b(t,o))},t)}function _(t,e){e._state===$?g(t,e._result):e._state===tt?b(t,e._result):w(e,void 0,function(e){return y(t,e)},function(e){return b(t,e)})}function v(t,n,r){n.constructor===t.constructor&&r===u&&n.constructor.resolve===c?_(t,n):r===et?(b(t,et.error),et.error=null):void 0===r?g(t,n):e(r)?d(t,n,r):g(t,n)}function y(e,n){e===n?b(e,f()):t(n)?v(e,n,h(n)):g(e,n)}function m(t){t._onerror&&t._onerror(t._result),A(t)}function g(t,e){t._state===Z&&(t._result=e,t._state=$,0!==t._subscribers.length&&B(A,t))}function b(t,e){t._state===Z&&(t._state=tt,t._result=e,B(m,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+$]=n,o[i+tt]=r,0===i&&t._state&&B(A,t)}function A(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?E(n,r,o,i):o(i);t._subscribers.length=0}}function j(){this.error=null}function S(t,e){try{return t(e)}catch(t){return nt.error=t,nt}}function E(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=S(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void b(n,l())}else s=o,c=!0;n._state!==Z||(i&&c?y(n,s):a?b(n,u):t===$?g(n,s):t===tt&&b(n,s))}function P(t,e){try{e(function(e){y(t,e)},function(e){b(t,e)})}catch(e){b(t,e)}}function T(){return rt++}function M(t){t[X]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function x(t,e){this._instanceConstructor=t,this.promise=new t(a),this.promise[X]||M(this.promise),N(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?g(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&g(this.promise,this._result))):b(this.promise,C())}function C(){return new Error("Array Methods must be provided an Array")}function O(t){return new x(this,t).promise}function k(t){var e=this;return new e(N(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function Y(t){var e=new this(a);return b(e,t),e}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this[X]=T(),this._result=this._state=void 0,this._subscribers=[],a!==t&&("function"!=typeof t&&q(),this instanceof D?P(this,t):F())}function K(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=D}var L=void 0,N=L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},U=0,W=void 0,z=void 0,B=function(t,e){R[U]=t,R[U+1]=e,2===(U+=2)&&(z?z(s):V())},G="undefined"!=typeof window?window:void 0,H=G||{},I=H.MutationObserver||H.WebKitMutationObserver,J="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,R=new Array(1e3),V=void 0;V=J?function(){return function(){return process.nextTick(s)}}():I?function(){var t=0,e=new I(s),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():Q?function(){var t=new MessageChannel;return t.port1.onmessage=s,function(){return t.port2.postMessage(0)}}():void 0===G&&"function"==typeof require?function(){try{var t=require("vertx");return W=t.runOnLoop||t.runOnContext,o()}catch(t){return i()}}():i();var X=Math.random().toString(36).substring(16),Z=void 0,$=1,tt=2,et=new j,nt=new j,rt=0;return x.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===Z&&n<t;n++)this._eachEntry(e[n],n)},x.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===c){var o=h(t);if(o===u&&t._state!==Z)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===D){var i=new n(a);v(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},x.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===Z&&(this._remaining--,t===tt?b(r,n):this._result[e]=n),0===this._remaining&&g(r,this._result)},x.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){return n._settledAt($,e,t)},function(t){return n._settledAt(tt,e,t)})},D.all=O,D.race=k,D.resolve=c,D.reject=Y,D._setScheduler=n,D._setAsap=r,D._asap=B,D.prototype={constructor:D,then:u,catch:function(t){return this.then(null,t)}},D.polyfill=K,D.Promise=D,D.polyfill(),D});
/*
 * Google Maps plugins
 * GoogleMutant: https://gitlab.com/IvanSanchez/Leaflet.GridLayer.GoogleMutant
 * Legacy plugin: http://psha.org.ru/b/leaflet-plugins.html
*/
if("enabled"==mapsmarkerjspro.google_maps_api_status)if("google_mutant"==mapsmarkerjspro.google_maps_plugin){if("disabled"==mapsmarkerjspro.google_deferred_loading&&google.load("maps","3",{other_params:mapsmarkerjspro.googlemaps_language+mapsmarkerjspro.googlemaps_base_domain+"&key="+mapsmarkerjspro.google_maps_api_key}),"disabled"==mapsmarkerjspro.google_styling_json)var custom_google_maps_styles="";else var custom_google_maps_styles=eval(mapsmarkerjspro.google_styling_json);L.GridLayer.GoogleMutant=L.GridLayer.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:mapsmarkerjspro.maxzoom,tileSize:256,subdomains:"abc",edgeBufferTiles:0,errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,type:"roadmap",maxNativeZoom:21,styles:custom_google_maps_styles},initialize:function(t){L.GridLayer.prototype.initialize.call(this,t),this._ready=!!window.google&&!!window.google.maps&&!!window.google.maps.Map,this._GAPIPromise=this._ready?Promise.resolve(window.google):new Promise(function(t,e){var i=0,o=null;o=setInterval(function(){return i>=10?(clearInterval(o),e(new Error("window.google not found after 10 attempts"))):window.google&&window.google.maps&&window.google.maps.Map?(clearInterval(o),t(window.google)):void i++},500)}),this._tileCallbacks={},this._freshTiles={},this._imagesPerTile="hybrid"===this.options.type?2:1},onAdd:function(t){L.GridLayer.prototype.onAdd.call(this,t),this._initMutantContainer(),this._GAPIPromise.then(function(){if(this._ready=!0,this._map=t,this._initMutant(),t.on("viewreset",this._reset,this),t.on("move",this._update,this),t.on("zoomend",this._handleZoomAnim,this),t.on("resize",this._resize,this),google.maps.event.addListenerOnce(this._mutant,"idle",function(){this._checkZoomLevels(),this._mutantIsReady=!0}.bind(this)),t._controlCorners.bottomright.style.marginBottom="14px",t._controlCorners.bottomleft.style.marginBottom="21px",this._reset(),this._update(),this._subLayers)for(var e in this._subLayers)this._subLayers[e].setMap(this._mutant)}.bind(this))},onRemove:function(t){L.GridLayer.prototype.onRemove.call(this,t),t._container.removeChild(this._mutantContainer),this._mutantContainer=void 0,google.maps.event.clearListeners(t,"idle"),google.maps.event.clearListeners(this._mutant,"idle"),t.off("viewreset",this._reset,this),t.off("move",this._update,this),t.off("zoomend",this._handleZoomAnim,this),t.off("resize",this._resize,this),t._controlCorners.bottomright.style.marginBottom="0em",t._controlCorners.bottomleft.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(t){this.options.opacity=t,t<1&&L.DomUtil.setOpacity(this._mutantContainer,t)},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},addGoogleLayer:function(t,e){return this._subLayers||(this._subLayers={}),this._GAPIPromise.then(function(){var i=new(0,google.maps[t])(e);return i.setMap(this._mutant),this._subLayers[t]=i,i}.bind(this))},removeGoogleLayer:function(t){var e=this._subLayers&&this._subLayers[t];e&&(e.setMap(null),delete this._subLayers[t])},_initMutantContainer:function(){this._mutantContainer||(this._mutantContainer=L.DomUtil.create("div","leaflet-google-mutant leaflet-top leaflet-left"),this._mutantContainer.id="_MutantContainer_"+L.Util.stamp(this._mutantContainer),this._mutantContainer.style.zIndex="399",this._mutantContainer.style.pointerEvents="none",this._map.getContainer().appendChild(this._mutantContainer)),this.setOpacity(this.options.opacity),this.setElementSize(this._mutantContainer,this._map.getSize()),this._attachObserver(this._mutantContainer)},_initMutant:function(){if(this._ready&&this._mutantContainer){this._mutantCenter=new google.maps.LatLng(0,0);var t=new google.maps.Map(this._mutantContainer,{center:this._mutantCenter,zoom:0,tilt:0,mapTypeId:this.options.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.styles||{},backgroundColor:"transparent"});this._mutant=t,google.maps.event.addListenerOnce(t,"idle",function(){for(var t=this._mutantContainer.querySelectorAll("a"),e=0;e<t.length;e++)t[e].style.pointerEvents="auto"}.bind(this)),this.fire("spawned",{mapObject:t})}},_attachObserver:function(t){new MutationObserver(this._onMutations.bind(this)).observe(t,{childList:!0,subtree:!0})},_onMutations:function(t){for(var e=0;e<t.length;++e)for(var i=t[e],o=0;o<i.addedNodes.length;++o){var s=i.addedNodes[o];s instanceof HTMLImageElement?this._onMutatedImage(s):s instanceof HTMLElement&&Array.prototype.forEach.call(s.querySelectorAll("img"),this._onMutatedImage.bind(this))}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+)/,_staticRegExp:/StaticMapService\.GetMapImage/,_onMutatedImage:function(t){var e,i=t.src.match(this._roadRegexp),o=0;if(i?(e={z:i[1],x:i[2],y:i[3]},this._imagesPerTile>1&&(t.style.zIndex=1,o=1)):((i=t.src.match(this._satRegexp))&&(e={x:i[1],y:i[2],z:i[3]}),o=0),e){var s=this._tileCoordsToKey(e);t.style.position="absolute",t.style.visibility="hidden";var n=s+"/"+o;if(this._freshTiles[n]=t,n in this._tileCallbacks&&this._tileCallbacks[n])this._tileCallbacks[n].pop()(t),this._tileCallbacks[n].length||delete this._tileCallbacks[n];else if(this._tiles[s]){var a=this._tiles[s].el,r=0===o?a.firstChild:a.firstChild.nextSibling,l=this._clone(t);a.replaceChild(l,r)}}else t.src.match(this._staticRegExp)&&(t.style.visibility="hidden")},createTile:function(t,e){var i=this._tileCoordsToKey(t),o=L.DomUtil.create("div");o.dataset.pending=this._imagesPerTile,e=e.bind(this,null,o);for(var s=0;s<this._imagesPerTile;s++){var n=i+"/"+s;if(n in this._freshTiles){var a=this._freshTiles[n];o.appendChild(this._clone(a)),o.dataset.pending--}else this._tileCallbacks[n]=this._tileCallbacks[n]||[],this._tileCallbacks[n].push(function(t){return function(i){t.appendChild(this._clone(i)),t.dataset.pending--,parseInt(t.dataset.pending)||e()}.bind(this)}.bind(this)(o))}return parseInt(o.dataset.pending)||L.Util.requestAnimFrame(e),o},_clone:function(t){var e=t.cloneNode(!0);return e.style.visibility="visible",e},_checkZoomLevels:function(){var t=this._map.getZoom(),e=this._mutant.getZoom();t&&e&&(e!==t||e>this.options.maxNativeZoom)&&this._setMaxNativeZoom(e)},_setMaxNativeZoom:function(t){t!=this.options.maxNativeZoom&&(this.options.maxNativeZoom=t,this._resetView())},_reset:function(){this._initContainer()},_update:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e);var i=this._map.getZoom(),o=i!==Math.round(i),s=this._mutant.getZoom();o||i==s||(this._mutant.setZoom(i),this._mutantIsReady&&this._checkZoomLevels())}L.GridLayer.prototype._update.call(this)},_resize:function(){var t=this._map.getSize();this._mutantContainer.style.width===t.x&&this._mutantContainer.style.height===t.y||(this.setElementSize(this._mutantContainer,t),this._mutant&&google.maps.event.trigger(this._mutant,"resize"))},_handleZoomAnim:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e),this._mutant.setZoom(Math.round(this._map.getZoom()))}},_removeTile:function(t){if(this._mutant)return setTimeout(this._pruneTile.bind(this,t),1e3),L.GridLayer.prototype._removeTile.call(this,t)},_pruneTile:function(t){for(var e=this._mutant.getZoom(),i=t.split(":")[2],o=this._mutant.getBounds(),s=o.getSouthWest(),n=o.getNorthEast(),a=L.latLngBounds([[s.lat(),s.lng()],[n.lat(),n.lng()]]),r=0;r<this._imagesPerTile;r++){var l=t+"/"+r;if(l in this._freshTiles){var h=this._map&&this._keyToBounds(t);this._map&&h.overlaps(a)&&i==e||delete this._freshTiles[l]}}}}),L.gridLayer.googleMutant=function(t){return new L.GridLayer.GoogleMutant(t)}}else"google_legacy"==mapsmarkerjspro.google_maps_plugin&&("disabled"==mapsmarkerjspro.google_deferred_loading&&google.load("maps","3",{other_params:mapsmarkerjspro.googlemaps_language+mapsmarkerjspro.googlemaps_base_domain+"&key="+mapsmarkerjspro.google_maps_api_key}),L.Google=L.Layer.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:mapsmarkerjspro.maxzoom,maxNativeZoom:21,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,mapOptions:{backgroundColor:"#F6F6F6"}},initialize:function(t,e){L.Util.setOptions(this,e),this._ready=L.Google.isGoogleMapsReady(),this._ready||L.Google.asyncWait.push(this),this._type=t||"SATELLITE"},onAdd:function(t,e){this._map=t,this._insertAtTheBottom=e,this._initContainer(),this._initMapObject(),t.on("viewreset",this._reset,this),this._limitedUpdate=L.Util.throttle(this._update,0,this),t.on("move drag",this._update,this),t.on("zoomanim",this._handleZoomAnim,this),t._controlCorners.bottomright.style.marginBottom="15px",t._controlCorners.bottomleft.style.marginBottom="21px",this._reset(),this._update(),L.polyline([[0,0]]).addTo(this._map)},onRemove:function(t){t._container.removeChild(this._container),t.off("viewreset",this._reset,this),t.off("move drag",this._update,this),t.off("zoomanim",this._handleZoomAnim,this),t._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(t){this.options.opacity=t,t<1&&L.DomUtil.setOpacity(this._container,t)},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},_initContainer:function(){var t=this._map._container,e=t.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),t.insertBefore(this._container,e),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready&&this._container){this._google_center=new google.maps.LatLng(0,0);var map=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,backgroundColor:this.options.mapOptions.backgroundColor});if("disabled"!=mapsmarkerjspro.google_styling_json){var styles=eval(mapsmarkerjspro.google_styling_json);map.setOptions({styles:styles})}var _this=this;this._reposition=google.maps.event.addListenerOnce(map,"center_changed",function(){_this.onReposition()}),this._google=map,google.maps.event.addListenerOnce(map,"idle",function(){_this._checkZoomLevels()}),google.maps.event.addListenerOnce(map,"tilesloaded",function(){_this.fire("load")}),this.fire("MapObjectInitialized",{mapObject:map})}},_checkZoomLevels:function(){void 0!==this._map.getZoom()&&this._google.getZoom()!==this._map.getZoom()&&this._map.setZoom(this._google.getZoom())},_reset:function(){this._initContainer()},_update:function(){if(this._google){this._resize();var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(e),void 0!==this._map.getZoom()&&this._google.setZoom(Math.round(this._map.getZoom())),this._checkZoomLevels()}},_resize:function(){var t=this._map.getSize();this._container.style.width===t.x&&this._container.style.height===t.y||(this.setElementSize(this._container,t),this.onReposition())},_handleZoomAnim:function(t){var e=t.center,i=new google.maps.LatLng(e.lat,e.lng);this._google.setCenter(i),this._google.setZoom(Math.round(t.zoom))},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[],L.Google.asyncInitialize=function(){var t;for(t=0;t<L.Google.asyncWait.length;t++){var e=L.Google.asyncWait[t];e._ready=!0,e._container&&(e._initMapObject(),e._update())}L.Google.asyncWait=[]},L.Google.isGoogleMapsReady=function(){return!!window.google&&!!window.google.maps&&!!window.google.maps.Map});
/*
 * bing maps plugins - http://psha.org.ru/b/leaflet-plugins.html
*/
L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:this.type,attribution:'<a href="https://www.bing.com/maps/" target="_blank">Bing Maps</a>',culture:mapsmarkerjspro.bing_culture},initialize:function(a,b){L.Util.setOptions(this,b),this._key=a,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(a,b,c){for(var d="",e=c;e>0;e--){var f=0,g=1<<e-1;0!==(a&g)&&(f+=1),0!==(b&g)&&(f+=2),d+=f}return d},getTileUrl:function(a){var b=this._getZoomForUrl(),c=this.options.subdomains,d=this.options.subdomains[Math.abs((a.x+a.y)%c.length)];return this._url.replace("{subdomain}",d).replace("{quadkey}",this.tile2quad(a.x,a.y,b)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var a=this,b="_bing_metadata_"+L.Util.stamp(this);window[b]=function(c){window[b]=void 0;var d=document.getElementById(b);if(d.parentNode.removeChild(d),c.errorDetails)throw new Error(c.errorDetails);a.initMetadata(c)};var c="file:"===document.location.protocol?"http":"https",d=c+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+b+"&key="+this._key+"&UriScheme="+c,e=document.createElement("script");e.type="text/javascript",e.src=d,e.id=b,document.getElementsByTagName("head")[0].appendChild(e)}},initMetadata:function(a){var b=a.resourceSets[0].resources[0];if(this.options.subdomains=b.imageUrlSubdomains,this._url=b.imageUrl,b.imageryProviders)for(var c=0;c<b.imageryProviders.length;c++)for(var d=b.imageryProviders[c],e=0;e<d.coverageAreas.length;e++){var f=d.coverageAreas[e],g={zoomMin:f.zoomMin,zoomMax:f.zoomMax,active:!1},h=new L.LatLngBounds(new L.LatLng(f.bbox[0]+.01,f.bbox[1]+.01),new L.LatLng(f.bbox[2]-.01,f.bbox[3]-.01));g.bounds=h,g.attrib=d.attribution,this._providers.push(g)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var a=L.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap()),b=this._map.getZoom(),c=0;c<this._providers.length;c++){var d=this._providers[c];b<=d.zoomMax&&b>=d.zoomMin&&a.intersects(d.bounds)?(d.active||this._map.attributionControl&&this._map.attributionControl.addAttribution(d.attrib),d.active=!0):(d.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(d.attrib),d.active=!1)}},onAdd:function(a){this.loadMetadata(),L.TileLayer.prototype.onAdd.apply(this,[a])},onRemove:function(a){for(var b=0;b<this._providers.length;b++){var c=this._providers[b];c.active&&(this._map.attributionControl&&this._map.attributionControl.removeAttribution(c.attrib),c.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[a])}}),L.bingLayer=function(a,b){return new L.BingLayer(a,b)};
/*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster (v1.0.6, 16/09/17)
 (c) 2012-2017, Dave Leaver, smartrak
*/
!function(e,t,i){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(e){L.Util.setOptions(this,e),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var t=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,t?this._withAnimation:this._noAnimation),this._markerCluster=t?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(e){if(e instanceof L.LayerGroup)return this.addLayers([e]);if(!e.getLatLng)return this._nonPointGroup.addLayer(e),this.fire("layeradd",{layer:e}),this;if(!this._map)return this._needsClustering.push(e),this.fire("layeradd",{layer:e}),this;if(this.hasLayer(e))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(e,this._maxZoom),this.fire("layeradd",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var t=e,i=this._zoom;if(e.__parent)for(;t.__parent._zoom>=i;)t=t.__parent;return this._currentShownBounds.contains(t.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(e,t):this._animationAddLayerNonAnimated(e,t)),this},removeLayer:function(e){return e instanceof L.LayerGroup?this.removeLayers([e]):e.getLatLng?this._map?e.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(e)),this._removeLayer(e,!0),this.fire("layerremove",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),e.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(e)&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,e)&&this.hasLayer(e)&&this._needsRemoving.push({layer:e,latlng:e._latlng}),this.fire("layerremove",{layer:e}),this):(this._nonPointGroup.removeLayer(e),this.fire("layerremove",{layer:e}),this)},addLayers:function(e,t){if(!L.Util.isArray(e))return this.addLayer(e);var i,n=this._featureGroup,r=this._nonPointGroup,s=this.options.chunkedLoading,o=this.options.chunkInterval,a=this.options.chunkProgress,h=e.length,l=0,_=!0;if(this._map){var u=(new Date).getTime(),d=L.bind(function(){for(var c=(new Date).getTime();h>l;l++){if(s&&0===l%200){var p=(new Date).getTime()-c;if(p>o)break}if(i=e[l],i instanceof L.LayerGroup)_&&(e=e.slice(),_=!1),this._extractNonGroupLayers(i,e),h=e.length;else if(i.getLatLng){if(!this.hasLayer(i)&&(this._addLayer(i,this._maxZoom),t||this.fire("layeradd",{layer:i}),i.__parent&&2===i.__parent.getChildCount())){var f=i.__parent.getAllChildMarkers(),m=f[0]===i?f[1]:f[0];n.removeLayer(m)}}else r.addLayer(i),t||this.fire("layeradd",{layer:i})}a&&a(l,h,(new Date).getTime()-u),l===h?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(d,this.options.chunkDelay)},this);d()}else for(var c=this._needsClustering;h>l;l++)i=e[l],i instanceof L.LayerGroup?(_&&(e=e.slice(),_=!1),this._extractNonGroupLayers(i,e),h=e.length):i.getLatLng?this.hasLayer(i)||c.push(i):r.addLayer(i);return this},removeLayers:function(e){var t,i,n=e.length,r=this._featureGroup,s=this._nonPointGroup,o=!0;if(!this._map){for(t=0;n>t;t++)i=e[t],i instanceof L.LayerGroup?(o&&(e=e.slice(),o=!1),this._extractNonGroupLayers(i,e),n=e.length):(this._arraySplice(this._needsClustering,i),s.removeLayer(i),this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}));return this}if(this._unspiderfy){this._unspiderfy();var a=e.slice(),h=n;for(t=0;h>t;t++)i=a[t],i instanceof L.LayerGroup?(this._extractNonGroupLayers(i,a),h=a.length):this._unspiderfyLayer(i)}for(t=0;n>t;t++)i=e[t],i instanceof L.LayerGroup?(o&&(e=e.slice(),o=!1),this._extractNonGroupLayers(i,e),n=e.length):i.__parent?(this._removeLayer(i,!0,!0),this.fire("layerremove",{layer:i}),r.hasLayer(i)&&(r.removeLayer(i),i.clusterShow&&i.clusterShow())):(s.removeLayer(i),this.fire("layerremove",{layer:i}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(e){e.off(this._childMarkerEventHandlers,this),delete e.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var e=new L.LatLngBounds;this._topClusterLevel&&e.extend(this._topClusterLevel._bounds);for(var t=this._needsClustering.length-1;t>=0;t--)e.extend(this._needsClustering[t].getLatLng());return e.extend(this._nonPointGroup.getBounds()),e},eachLayer:function(e,t){var i,n,r,s=this._needsClustering.slice(),o=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(s),n=s.length-1;n>=0;n--){for(i=!0,r=o.length-1;r>=0;r--)if(o[r].layer===s[n]){i=!1;break}i&&e.call(t,s[n])}this._nonPointGroup.eachLayer(e,t)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var t=null;return e=parseInt(e,10),this.eachLayer(function(i){L.stamp(i)===e&&(t=i)}),t},hasLayer:function(e){if(!e)return!1;var t,i=this._needsClustering;for(t=i.length-1;t>=0;t--)if(i[t]===e)return!0;for(i=this._needsRemoving,t=i.length-1;t>=0;t--)if(i[t].layer===e)return!1;return!(!e.__parent||e.__parent._group!==this)||this._nonPointGroup.hasLayer(e)},zoomToShowLayer:function(e,t){"function"!=typeof t&&(t=function(){});var i=function(){!e._icon&&!e.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",i,this),this.off("animationend",i,this),e._icon?t():e.__parent._icon&&(this.once("spiderfied",t,this),e.__parent.spiderfy()))};e._icon&&this._map.getBounds().contains(e.getLatLng())?t():e.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",i,this),this._map.panTo(e.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),e.__parent.zoomToBounds())},onAdd:function(e){this._map=e;var t,i,n;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(e),this._nonPointGroup.addTo(e),this._gridClusters||this._generateInitialClusters(),this._maxLat=e.options.crs.projection.MAX_LATITUDE,t=0,i=this._needsRemoving.length;i>t;t++)n=this._needsRemoving[t],n.newlatlng=n.layer._latlng,n.layer._latlng=n.latlng;for(t=0,i=this._needsRemoving.length;i>t;t++)n=this._needsRemoving[t],this._removeLayer(n.layer,!0),n.layer._latlng=n.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i,!0)},onRemove:function(e){e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(e){for(var t=e;t&&!t._icon;)t=t.__parent;return t||null},_arraySplice:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]===t)return e.splice(i,1),!0},_removeFromGridUnclustered:function(e,t){for(var i=this._map,n=this._gridUnclustered,r=Math.floor(this._map.getMinZoom());t>=r&&n[t].removeObject(e,i.project(e.getLatLng(),t));t--);},_childMarkerDragStart:function(e){e.target.__dragStart=e.target._latlng},_childMarkerMoved:function(e){if(!this._ignoreMove&&!e.target.__dragStart){var t=e.target._popup&&e.target._popup.isOpen();this._moveChild(e.target,e.oldLatLng,e.latlng),t&&e.target.openPopup()}},_moveChild:function(e,t,i){e._latlng=t,this.removeLayer(e),e._latlng=i,this.addLayer(e)},_childMarkerDragEnd:function(e){e.target.__dragStart&&this._moveChild(e.target,e.target.__dragStart,e.target._latlng),delete e.target.__dragStart},_removeLayer:function(e,t,i){var n=this._gridClusters,r=this._gridUnclustered,s=this._featureGroup,o=this._map,a=Math.floor(this._map.getMinZoom());t&&this._removeFromGridUnclustered(e,this._maxZoom);var h,l=e.__parent,_=l._markers;for(this._arraySplice(_,e);l&&(l._childCount--,l._boundsNeedUpdate=!0,!(l._zoom<a));)t&&l._childCount<=1?(h=l._markers[0]===e?l._markers[1]:l._markers[0],n[l._zoom].removeObject(l,o.project(l._cLatLng,l._zoom)),r[l._zoom].addObject(h,o.project(h.getLatLng(),l._zoom)),this._arraySplice(l.__parent._childClusters,l),l.__parent._markers.push(h),h.__parent=l.__parent,l._icon&&(s.removeLayer(l),i||s.addLayer(h))):l._iconNeedsUpdate=!0,l=l.__parent;delete e.__parent},_isOrIsParent:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},fire:function(e,t,i){if(t&&t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;e="cluster"+e}L.FeatureGroup.prototype.fire.call(this,e,t,i)},listens:function(e,t){return L.FeatureGroup.prototype.listens.call(this,e,t)||L.FeatureGroup.prototype.listens.call(this,"cluster"+e,t)},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),i=" marker-cluster-";return i+=10>t?"small":100>t?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var e=this._map,t=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(t||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),e.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(e){for(var t=e.layer,i=t;1===i._childClusters.length;)i=i._childClusters[0];i._zoom===this._maxZoom&&i._childCount===t._childCount&&this.options.spiderfyOnMaxZoom?t.spiderfy():this.options.zoomToBoundsOnClick&&t.zoomToBounds(),e.originalEvent&&13===e.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(e){var t=this._map;this._inZoomAnimation||(this._shownPolygon&&t.removeLayer(this._shownPolygon),e.layer.getChildCount()>2&&e.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(e.layer.getConvexHull(),this.options.polygonOptions),t.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.spiderfyOnMaxZoom,t=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(e||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),t&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var e=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),e),this._currentShownBounds=e}},_generateInitialClusters:function(){var e=Math.ceil(this._map.getMaxZoom()),t=Math.floor(this._map.getMinZoom()),i=this.options.maxClusterRadius,n=i;"function"!=typeof i&&(n=function(){return i}),null!==this.options.disableClusteringAtZoom&&(e=this.options.disableClusteringAtZoom-1),this._maxZoom=e,this._gridClusters={},this._gridUnclustered={};for(var r=e;r>=t;r--)this._gridClusters[r]=new L.DistanceGrid(n(r)),this._gridUnclustered[r]=new L.DistanceGrid(n(r));this._topClusterLevel=new this._markerCluster(this,t-1)},_addLayer:function(e,t){var i,n,r=this._gridClusters,s=this._gridUnclustered,o=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(e),e.on(this._childMarkerEventHandlers,this);t>=o;t--){i=this._map.project(e.getLatLng(),t);var a=r[t].getNearObject(i);if(a)return a._addChild(e),e.__parent=a,void 0;if(a=s[t].getNearObject(i)){var h=a.__parent;h&&this._removeLayer(a,!1);var l=new this._markerCluster(this,t,a,e);r[t].addObject(l,this._map.project(l._cLatLng,t)),a.__parent=l,e.__parent=l;var _=l;for(n=t-1;n>h._zoom;n--)_=new this._markerCluster(this,n,_),r[n].addObject(_,this._map.project(a.getLatLng(),n));return h._addChild(_),this._removeFromGridUnclustered(a,t),void 0}s[t].addObject(e,i)}this._topClusterLevel._addChild(e),e.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()})},_enqueue:function(e){this._queue.push(e),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var e=0;e<this._queue.length;e++)this._queue[e].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var e=Math.round(this._map._zoom);this._processQueue(),this._zoom<e&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,e)):this._zoom>e?(this._animationStart(),this._animationZoomOut(this._zoom,e)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(e){var t=this._maxLat;return t!==i&&(e.getNorth()>=t&&(e._northEast.lat=1/0),e.getSouth()<=-t&&(e._southWest.lat=-1/0)),e},_animationAddLayerNonAnimated:function(e,t){if(t===e)this._featureGroup.addLayer(e);else if(2===t._childCount){t._addToMap();var i=t.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else t._updateIcon()},_extractNonGroupLayers:function(e,t){var i,n=e.getLayers(),r=0;for(t=t||[];r<n.length;r++)i=n[r],i instanceof L.LayerGroup?this._extractNonGroupLayers(i,t):t.push(i);return t},_overrideMarkerIcon:function(e){var t=e.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[e]}});return t}}),L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(e,t){this._animationAddLayerNonAnimated(e,t)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(e,t){var i,n=this._getExpandedVisibleBounds(),r=this._featureGroup,s=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(n,e,s,function(s){var o,a=s._latlng,h=s._markers;for(n.contains(a)||(a=null),s._isSingleParent()&&e+1===t?(r.removeLayer(s),s._recursivelyAddChildrenToMap(null,t,n)):(s.clusterHide(),s._recursivelyAddChildrenToMap(a,t,n)),i=h.length-1;i>=0;i--)o=h[i],n.contains(o._latlng)||r.removeLayer(o)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,t),r.eachLayer(function(e){e instanceof L.MarkerCluster||!e._icon||e.clusterShow()}),this._topClusterLevel._recursively(n,e,t,function(e){e._recursivelyRestoreChildPositions(t)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(n,e,s,function(e){r.removeLayer(e),e.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(e,t){this._animationZoomOutSingle(this._topClusterLevel,e-1,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e,this._getExpandedVisibleBounds())},_animationAddLayer:function(e,t){var i=this,n=this._featureGroup;n.addLayer(e),t!==e&&(t._childCount>2?(t._updateIcon(),this._forceLayout(),this._animationStart(),e._setPos(this._map.latLngToLayerPoint(t.getLatLng())),e.clusterHide(),this._enqueue(function(){n.removeLayer(e),e.clusterShow(),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(t,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(e,t,i){var n=this._getExpandedVisibleBounds(),r=Math.floor(this._map.getMinZoom());e._recursivelyAnimateChildrenInAndAddSelfToMap(n,r,t+1,i);var s=this;this._forceLayout(),e._recursivelyBecomeVisible(n,i),this._enqueue(function(){if(1===e._childCount){var o=e._markers[0];this._ignoreMove=!0,o.setLatLng(o.getLatLng()),this._ignoreMove=!1,o.clusterShow&&o.clusterShow()}else e._recursively(n,i,r,function(e){e._recursivelyRemoveChildrenFromMap(n,r,t+1)});s._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(t.body.offsetWidth)}}),L.markerClusterGroup=function(e){return new L.MarkerClusterGroup(e)},L.MarkerCluster=L.Marker.extend({initialize:function(e,t,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=e,this._zoom=t,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(e){e=e||[];for(var t=this._childClusters.length-1;t>=0;t--)this._childClusters[t].getAllChildMarkers(e);for(var i=this._markers.length-1;i>=0;i--)e.push(this._markers[i]);return e},getChildCount:function(){return this._childCount},zoomToBounds:function(e){for(var t,i=this._childClusters.slice(),n=this._group._map,r=n.getBoundsZoom(this._bounds),s=this._zoom+1,o=n.getZoom();i.length>0&&r>s;){s++;var a=[];for(t=0;t<i.length;t++)a=a.concat(i[t]._childClusters);i=a}r>s?this._group._map.setView(this._latlng,s):o>=r?this._group._map.setView(this._latlng,o+1):this._group._map.fitBounds(this._bounds,e)},getBounds:function(){var e=new L.LatLngBounds;return e.extend(this._bounds),e},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(e,t){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(e),e instanceof L.MarkerCluster?(t||(this._childClusters.push(e),e.__parent=this),this._childCount+=e._childCount):(t||this._markers.push(e),this._childCount++),this.__parent&&this.__parent._addChild(e,!0)},_setClusterCenter:function(e){this._cLatLng||(this._cLatLng=e._cLatLng||e._latlng)},_resetBounds:function(){var e=this._bounds;e._southWest&&(e._southWest.lat=1/0,e._southWest.lng=1/0),e._northEast&&(e._northEast.lat=-1/0,e._northEast.lng=-1/0)},_recalculateBounds:function(){var e,t,i,n,r=this._markers,s=this._childClusters,o=0,a=0,h=this._childCount;if(0!==h){for(this._resetBounds(),e=0;e<r.length;e++)i=r[e]._latlng,this._bounds.extend(i),o+=i.lat,a+=i.lng;for(e=0;e<s.length;e++)t=s[e],t._boundsNeedUpdate&&t._recalculateBounds(),this._bounds.extend(t._bounds),i=t._wLatLng,n=t._childCount,o+=i.lat*n,a+=i.lng*n;this._latlng=this._wLatLng=new L.LatLng(o/h,a/h),this._boundsNeedUpdate=!1}},_addToMap:function(e){e&&(this._backupLatlng=this._latlng,this.setLatLng(e)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(e,t,i){this._recursively(e,this._group._map.getMinZoom(),i-1,function(e){var i,n,r=e._markers;for(i=r.length-1;i>=0;i--)n=r[i],n._icon&&(n._setPos(t),n.clusterHide())},function(e){var i,n,r=e._childClusters;for(i=r.length-1;i>=0;i--)n=r[i],n._icon&&(n._setPos(t),n.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,t,i,n){this._recursively(e,n,t,function(r){r._recursivelyAnimateChildrenIn(e,r._group._map.latLngToLayerPoint(r.getLatLng()).round(),i),r._isSingleParent()&&i-1===n?(r.clusterShow(),r._recursivelyRemoveChildrenFromMap(e,t,i)):r.clusterHide(),r._addToMap()})},_recursivelyBecomeVisible:function(e,t){this._recursively(e,this._group._map.getMinZoom(),t,null,function(e){e.clusterShow()})},_recursivelyAddChildrenToMap:function(e,t,i){this._recursively(i,this._group._map.getMinZoom()-1,t,function(n){if(t!==n._zoom)for(var r=n._markers.length-1;r>=0;r--){var s=n._markers[r];i.contains(s._latlng)&&(e&&(s._backupLatlng=s.getLatLng(),s.setLatLng(e),s.clusterHide&&s.clusterHide()),n._group._featureGroup.addLayer(s))}},function(t){t._addToMap(e)})},_recursivelyRestoreChildPositions:function(e){for(var t=this._markers.length-1;t>=0;t--){var i=this._markers[t];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(e-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var r=this._childClusters.length-1;r>=0;r--)this._childClusters[r]._recursivelyRestoreChildPositions(e)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(e,t,i,n){var r,s;this._recursively(e,t-1,i-1,function(e){for(s=e._markers.length-1;s>=0;s--)r=e._markers[s],n&&n.contains(r._latlng)||(e._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())},function(e){for(s=e._childClusters.length-1;s>=0;s--)r=e._childClusters[s],n&&n.contains(r._latlng)||(e._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())})},_recursively:function(e,t,i,n,r){var s,o,a=this._childClusters,h=this._zoom;if(h>=t&&(n&&n(this),r&&h===i&&r(this)),t>h||i>h)for(s=a.length-1;s>=0;s--)o=a[s],e.intersects(o._bounds)&&o._recursively(e,t,i,n,r)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var e=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,e}}),L.DistanceGrid=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(e,t){var i=this._getCoord(t.x),n=this._getCoord(t.y),r=this._grid,s=r[n]=r[n]||{},o=s[i]=s[i]||[],a=L.Util.stamp(e);this._objectPoint[a]=t,o.push(e)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(e,t){var i,n,r=this._getCoord(t.x),s=this._getCoord(t.y),o=this._grid,a=o[s]=o[s]||{},h=a[r]=a[r]||[];for(delete this._objectPoint[L.Util.stamp(e)],i=0,n=h.length;n>i;i++)if(h[i]===e)return h.splice(i,1),1===n&&delete a[r],!0},eachObject:function(e,t){var i,n,r,s,o,a,h,l=this._grid;for(i in l){o=l[i];for(n in o)for(a=o[n],r=0,s=a.length;s>r;r++)h=e.call(t,a[r]),h&&(r--,s--)}},getNearObject:function(e){var t,i,n,r,s,o,a,h,l=this._getCoord(e.x),_=this._getCoord(e.y),u=this._objectPoint,d=this._sqCellSize,c=null;for(t=_-1;_+1>=t;t++)if(r=this._grid[t])for(i=l-1;l+1>=i;i++)if(s=r[i])for(n=0,o=s.length;o>n;n++)a=s[n],h=this._sqDist(u[L.Util.stamp(a)],e),d>h&&(d=h,c=a);return c},_getCoord:function(e){return Math.floor(e/this._cellSize)},_sqDist:function(e,t){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}},function(){L.QuickHull={getDistant:function(e,t){var i=t[1].lat-t[0].lat,n=t[0].lng-t[1].lng;return n*(e.lat-t[0].lat)+i*(e.lng-t[0].lng)},findMostDistantPointFromBaseLine:function(e,t){var i,n,r,s=0,o=null,a=[];for(i=t.length-1;i>=0;i--)n=t[i],r=this.getDistant(n,e),r>0&&(a.push(n),r>s&&(s=r,o=n));return{maxPoint:o,newPoints:a}},buildConvexHull:function(e,t){var i=[],n=this.findMostDistantPointFromBaseLine(e,t);return n.maxPoint?(i=i.concat(this.buildConvexHull([e[0],n.maxPoint],n.newPoints)),i=i.concat(this.buildConvexHull([n.maxPoint,e[1]],n.newPoints))):[e[0]]},getConvexHull:function(e){var t,i=!1,n=!1,r=!1,s=!1,o=null,a=null,h=null,l=null,_=null,u=null;for(t=e.length-1;t>=0;t--){var d=e[t];(i===!1||d.lat>i)&&(o=d,i=d.lat),(n===!1||d.lat<n)&&(a=d,n=d.lat),(r===!1||d.lng>r)&&(h=d,r=d.lng),(s===!1||d.lng<s)&&(l=d,s=d.lng)}n!==i?(u=a,_=o):(u=l,_=h);var c=[].concat(this.buildConvexHull([u,_],e),this.buildConvexHull([_,u],e));return c}}}(),L.MarkerCluster.include({getConvexHull:function(){var e,t,i=this.getAllChildMarkers(),n=[];for(t=i.length-1;t>=0;t--)e=i[t].getLatLng(),n.push(e);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var e,t=this.getAllChildMarkers(),i=this._group,n=i._map,r=n.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,t.length>=this._circleSpiralSwitchover?e=this._generatePointsSpiral(t.length,r):(r.y+=10,e=this._generatePointsCircle(t.length,r)),this._animationSpiderfy(t,e)}},unspiderfy:function(e){this._group._inZoomAnimation||(this._animationUnspiderfy(e),this._group._spiderfied=null)},_generatePointsCircle:function(e,t){var i,n,r=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+e),s=r/this._2PI,o=this._2PI/e,a=[];for(a.length=e,i=e-1;i>=0;i--)n=this._circleStartAngle+i*o,a[i]=new L.Point(t.x+s*Math.cos(n),t.y+s*Math.sin(n))._round();return a},_generatePointsSpiral:function(e,t){var i,n=this._group.options.spiderfyDistanceMultiplier,r=n*this._spiralLengthStart,s=n*this._spiralFootSeparation,o=n*this._spiralLengthFactor*this._2PI,a=0,h=[];for(h.length=e,i=e-1;i>=0;i--)a+=s/r+5e-4*i,h[i]=new L.Point(t.x+r*Math.cos(a),t.y+r*Math.sin(a))._round(),r+=o/a;return h},_noanimationUnspiderfy:function(){var e,t,i=this._group,n=i._map,r=i._featureGroup,s=this.getAllChildMarkers();for(i._ignoreMove=!0,this.setOpacity(1),t=s.length-1;t>=0;t--)e=s[t],r.removeLayer(e),e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(n.removeLayer(e._spiderLeg),delete e._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:s}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(e,t){var i,n,r,s,o=this._group,a=o._map,h=o._featureGroup,l=this._group.options.spiderLegPolylineOptions;for(o._ignoreMove=!0,i=0;i<e.length;i++)s=a.layerPointToLatLng(t[i]),n=e[i],r=new L.Polyline([this._latlng,s],l),a.addLayer(r),n._spiderLeg=r,n._preSpiderfyLatlng=n._latlng,n.setLatLng(s),n.setZIndexOffset&&n.setZIndexOffset(1e6),h.addLayer(n);this.setOpacity(.3),o._ignoreMove=!1,o.fire("spiderfied",{cluster:this,markers:e})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(e,t){var n,r,s,o,a,h,l=this,_=this._group,u=_._map,d=_._featureGroup,c=this._latlng,p=u.latLngToLayerPoint(c),f=L.Path.SVG,m=L.extend({},this._group.options.spiderLegPolylineOptions),g=m.opacity;for(g===i&&(g=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),f?(m.opacity=0,m.className=(m.className||"")+" leaflet-cluster-spider-leg"):m.opacity=g,_._ignoreMove=!0,n=0;n<e.length;n++)r=e[n],h=u.layerPointToLatLng(t[n]),s=new L.Polyline([c,h],m),u.addLayer(s),r._spiderLeg=s,f&&(o=s._path,a=o.getTotalLength()+.1,o.style.strokeDasharray=a,o.style.strokeDashoffset=a),r.setZIndexOffset&&r.setZIndexOffset(1e6),r.clusterHide&&r.clusterHide(),d.addLayer(r),r._setPos&&r._setPos(p);for(_._forceLayout(),_._animationStart(),n=e.length-1;n>=0;n--)h=u.layerPointToLatLng(t[n]),r=e[n],r._preSpiderfyLatlng=r._latlng,r.setLatLng(h),r.clusterShow&&r.clusterShow(),f&&(s=r._spiderLeg,o=s._path,o.style.strokeDashoffset=0,s.setStyle({opacity:g}));this.setOpacity(.3),_._ignoreMove=!1,setTimeout(function(){_._animationEnd(),_.fire("spiderfied",{cluster:l,markers:e})},200)},_animationUnspiderfy:function(e){var t,i,n,r,s,o,a=this,h=this._group,l=h._map,_=h._featureGroup,u=e?l._latLngToNewLayerPoint(this._latlng,e.zoom,e.center):l.latLngToLayerPoint(this._latlng),d=this.getAllChildMarkers(),c=L.Path.SVG;for(h._ignoreMove=!0,h._animationStart(),this.setOpacity(1),i=d.length-1;i>=0;i--)t=d[i],t._preSpiderfyLatlng&&(t.closePopup(),t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng,o=!0,t._setPos&&(t._setPos(u),o=!1),t.clusterHide&&(t.clusterHide(),o=!1),o&&_.removeLayer(t),c&&(n=t._spiderLeg,r=n._path,s=r.getTotalLength()+.1,r.style.strokeDashoffset=s,n.setStyle({opacity:0})));h._ignoreMove=!1,setTimeout(function(){var e=0;for(i=d.length-1;i>=0;i--)t=d[i],t._spiderLeg&&e++;for(i=d.length-1;i>=0;i--)t=d[i],t._spiderLeg&&(t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),e>1&&_.removeLayer(t),l.removeLayer(t._spiderLeg),delete t._spiderLeg);h._animationEnd(),h.fire("unspiderfied",{cluster:a,markers:d})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(e){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(e))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(e){this._spiderfied&&this._spiderfied.unspiderfy(e)
},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(e){e._spiderLeg&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),this._map.removeLayer(e._spiderLeg),delete e._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(e){return e?e instanceof L.MarkerClusterGroup?e=e._topClusterLevel.getAllChildMarkers():e instanceof L.LayerGroup?e=e._layers:e instanceof L.MarkerCluster?e=e.getAllChildMarkers():e instanceof L.Marker&&(e=[e]):e=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(e),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(e),this},_flagParentsIconsNeedUpdate:function(e){var t,i;for(t in e)for(i=e[t].__parent;i;)i._iconNeedsUpdate=!0,i=i.__parent},_refreshSingleMarkerModeMarkers:function(e){var t,i;for(t in e)i=e[t],this.hasLayer(i)&&i.setIcon(this._overrideMarkerIcon(i))}}),L.Marker.include({refreshIconOptions:function(e,t){var i=this.options.icon;return L.setOptions(i,e),this.setIcon(i),t&&this.__parent&&this.__parent._group.refreshClusters(this),this}})}(window,document);
/*
* MiniMap plugin by Norkart, Copyright (c) 2016, Norkart AS, All rights reserved.
* License details: https://github.com/Norkart/Leaflet-MiniMap/blob/master/LICENSE.txt
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.Control.MiniMap=a(L),b.L.control.minimap=function(a,c){return new b.L.Control.MiniMap(a,c)})}(function(a){var b=a.Control.extend({options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,interactive:!1},shadowRectOptions:{color:"#000000",weight:1,interactive:!1,opacity:0,fillOpacity:0},strings:{hideText:mapsmarkerjspro.minimap_hide,showText:mapsmarkerjspro.minimap_show},mapOptions:{}},initialize:function(b,c){a.Util.setOptions(this,c),this.options.aimingRectOptions.interactive=!1,this.options.shadowRectOptions.interactive=!1,this._layer=b},onAdd:function(b){this._mainMap=b,this._container=a.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",a.DomEvent.disableClickPropagation(this._container),a.DomEvent.on(this._container,"mousewheel",a.DomEvent.stopPropagation);var c={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:b.options.crs};return c=a.Util.extend(this.options.mapOptions,c),this._miniMap=new a.Map(this._container,c),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(a.Util.bind(function(){this._aimingRect=a.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=a.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(b){a.Control.prototype.addTo.call(this,b);var c=this.options.centerFixed||this._mainMap.getCenter();return this._miniMap.setView(c,this._decideZoom(!0)),this._setDisplay(this.options.minimized),this},onRemove:function(a){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(a){this._miniMap.removeLayer(this._layer),this._layer=a,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this._toggleButtonInitialTitleText(),"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_toggleButtonInitialTitleText:function(){return this.options.minimized?this.options.strings.showText:this.options.strings.hideText},_createButton:function(b,c,d,e,f,g){var h=a.DomUtil.create("a",d,e);h.innerHTML=b,h.href="#",h.title=c;var i=a.DomEvent.stopPropagation;return a.DomEvent.on(h,"click",i).on(h,"mousedown",i).on(h,"dblclick",i).on(h,"click",a.DomEvent.preventDefault).on(h,"click",f,g),h},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?this._restore():this._minimize()},_setDisplay:function(a){a!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position,this._toggleDisplayButton.title=this.options.strings.showText):this._container.style.display="none",this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,""),this._toggleDisplayButton.title=this.options.strings.hideText):this._container.style.display="block",this._minimized=!1},_onMainMapMoved:function(a){if(this._miniMapMoving)this._miniMapMoving=!1;else{var b=this.options.centerFixed||this._mainMap.getCenter();this._mainMapMoving=!0,this._miniMap.setView(b,this._decideZoom(!0)),this._setDisplay(this._decideMinimized())}this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(a){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(a){if(!this.options.centerFixed){var b=this._aimingRect.getBounds(),c=this._miniMap.latLngToContainerPoint(b.getSouthWest()),d=this._miniMap.latLngToContainerPoint(b.getNorthEast());this._lastAimingRectPosition={sw:c,ne:d}}},_onMiniMapMoving:function(b){this.options.centerFixed||!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new a.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(a){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var a=this.options.zoomLevelFixed;return this._isDefined(a)&&this._isInteger(a)},_decideZoom:function(a){if(this._isZoomLevelFixed())return a?this.options.zoomLevelFixed:this._mainMap.getZoom();if(a)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var d,b=this._miniMap.getZoom()-this._mainMap.getZoom(),c=this._miniMap.getZoom()-this.options.zoomLevelOffset;return b>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(d=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):d=this._mainMap.getZoom():d=c,this._lastMiniMapZoom=this._miniMap.getZoom(),d},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?this._mainMap.getBounds().contains(this._miniMap.getBounds())?!0:!1:this._minimized},_isInteger:function(a){return"number"==typeof a},_isDefined:function(a){return"undefined"!=typeof a}});return a.Map.mergeOptions({miniMapControl:!1}),a.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new b).addTo(this))}),b},window);
/*
* Fullscreen plugin by https://github.com/mapbox/Leaflet.fullscreen
* License: https://github.com/mapbox/Leaflet.fullscreen/blob/master/LICENSE
*/
L.Control.Fullscreen=L.Control.extend({options:{position:mapsmarkerjspro.fullscreen_button_position,title:{false:mapsmarkerjspro.fullscreen_button_title,true:mapsmarkerjspro.fullscreen_button_title_exit}},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",b),this.link.href="#",this._map=a,this._map.on("fullscreenchange",this._toggleTitle,this),this._toggleTitle(),L.DomEvent.on(this.link,"click",this._click,this),b},_click:function(a){L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a),this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}}),L.Map.include({isFullscreen:function(){return this._isFullscreen||!1},toggleFullscreen:function(a){var b=this.getContainer();this.isFullscreen()?a&&a.pseudoFullscreen?this._disablePseudoFullscreen(b):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():this._disablePseudoFullscreen(b):a&&a.pseudoFullscreen?this._enablePseudoFullscreen(b):b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):b.msRequestFullscreen?b.msRequestFullscreen():this._enablePseudoFullscreen(b)},_enablePseudoFullscreen:function(a){L.DomUtil.addClass(a,"leaflet-pseudo-fullscreen"),this._setFullscreen(!0),this.fire("fullscreenchange")},_disablePseudoFullscreen:function(a){L.DomUtil.removeClass(a,"leaflet-pseudo-fullscreen"),this._setFullscreen(!1),this.fire("fullscreenchange")},_setFullscreen:function(a){this._isFullscreen=a;var b=this.getContainer();a?L.DomUtil.addClass(b,"leaflet-fullscreen-on"):L.DomUtil.removeClass(b,"leaflet-fullscreen-on"),this.invalidateSize()},_onFullscreenChange:function(a){var b=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;b!==this.getContainer()||this._isFullscreen?b!==this.getContainer()&&this._isFullscreen&&(this._setFullscreen(!1),this.fire("fullscreenchange")):(this._setFullscreen(!0),this.fire("fullscreenchange"))}}),L.Map.mergeOptions({fullscreenControl:!1}),L.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=new L.Control.Fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl));var a;if("onfullscreenchange"in document?a="fullscreenchange":"onmozfullscreenchange"in document?a="mozfullscreenchange":"onwebkitfullscreenchange"in document?a="webkitfullscreenchange":"onmsfullscreenchange"in document&&(a="MSFullscreenChange"),a){var b=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,a,b)}),this.on("unload",function(){L.DomEvent.off(document,a,b)})}}),L.control.fullscreen=function(a){return new L.Control.Fullscreen(a)};
/*
* GPX plugin, Copyright (C) 2011-2012 Pavel Shramov, Copyright (C) 2013 Maxime Petazzoni <maxime.petazzoni@bulix.org>
* License: https://github.com/mpetazzoni/leaflet-gpx/blob/master/LICENSE
*/
var _SECOND_IN_MILLIS=1e3,_MINUTE_IN_MILLIS=60*_SECOND_IN_MILLIS,_HOUR_IN_MILLIS=60*_MINUTE_IN_MILLIS;L.GPX=L.FeatureGroup.extend({initialize:function(a,b){L.Util.setOptions(this,b),"show"==mapsmarkerjspro.gpx_icons_status&&(L.GPXTrackIcon=L.Icon.extend({options:b.marker_options})),this._gpx=a,this._layers={},this._info={name:null,length:0,elevation:{gain:0,loss:0,_points:[]},hr:{avg:0,_total:0,_points:[]},duration:{start:null,end:null,moving:0,total:0}},a&&this._prepare_parsing(a,b,this.options.async)},get_duration_string:function(a,b){var c="";a>=_HOUR_IN_MILLIS&&(c+=Math.floor(a/_HOUR_IN_MILLIS)+":",a%=_HOUR_IN_MILLIS);var d=Math.floor(a/_MINUTE_IN_MILLIS);a%=_MINUTE_IN_MILLIS,10>d&&(c+="0"),c+=d+"'";var e=Math.floor(a/_SECOND_IN_MILLIS);return a%=_SECOND_IN_MILLIS,10>e&&(c+="0"),c+=e,c+=!b&&a>0?"."+Math.round(1e3*Math.floor(a))/1e3:'"'},to_miles:function(a){return a/1.60934},to_ft:function(a){return 3.28084*a},m_to_km:function(a){return a/1e3},m_to_mi:function(a){return a/1609.34},get_name:function(){return this._info.name},get_distance:function(){return this._info.length},get_distance_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))},get_start_time:function(){return this._info.duration.start},get_end_time:function(){return this._info.duration.end},get_moving_time:function(){return this._info.duration.moving},get_total_time:function(){return this._info.duration.total},get_moving_pace:function(){return this.get_moving_time()/this.m_to_km(this.get_distance())},get_moving_pace_imp:function(){return this.get_moving_time()/this.get_distance_imp()},get_elevation_gain:function(){return this._info.elevation.gain},get_elevation_loss:function(){return this._info.elevation.loss},get_elevation_data:function(){var a=this;return this._info.elevation._points.map(function(b){return a._prepare_data_point(b,a.m_to_km,null,function(a,b){return a.toFixed(2)+" km, "+b.toFixed(0)+" m"})})},get_elevation_data_imp:function(){var a=this;return this._info.elevation._points.map(function(b){return a._prepare_data_point(b,a.m_to_mi,a.to_ft,function(a,b){return a.toFixed(2)+" mi, "+b.toFixed(0)+" ft"})})},get_average_hr:function(){return this._info.hr.avg},get_heartrate_data:function(){var a=this;return this._info.hr._points.map(function(b){return a._prepare_data_point(b,a.m_to_km,null,function(a,b){return a.toFixed(2)+" km, "+b.toFixed(0)+" bpm"})})},get_heartrate_data_imp:function(){var a=this;return this._info.hr._points.map(function(b){return a._prepare_data_point(b,a.m_to_mi,null,function(a,b){return a.toFixed(2)+" mi, "+b.toFixed(0)+" bpm"})})},_htmlspecialchars_decode:function(a,b){var c=0,d=0,e=!1;"undefined"==typeof b&&(b=2),a=a.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var f={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===b&&(e=!0),"number"!=typeof b){for(b=[].concat(b),d=0;d<b.length;d++)0===f[b[d]]?e=!0:f[b[d]]&&(c|=f[b[d]]);b=c}return b&&f.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/&#0*39;/g,"'")),e||(a=a.replace(/&quot;/g,'"')),a=a.replace(/&amp;/g,"&")},_merge_objs:function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},_prepare_data_point:function(a,b,c,d){var e=[b&&b(a[0])||a[0],c&&c(a[1])||a[1]];return e.push(d&&d(e[0],e[1])||e[0]+": "+e[1]),e},_prepare_parsing:function(a,b,c){var d=this,e=function(a,b){var c=d._parse_gpx_data(a,b);c&&(d.addLayer(c),setTimeout(function(){d.fire("gpx_loaded")},0))};void 0==c&&(c=this.options.async),void 0==b&&(b=this.options);var f=this._htmlspecialchars_decode(this.options.gpx_content),g=this._parse_xml(f);g?e(this._parse_xml(f),b):window.console&&console.log("error parsing xml")},_parse_xml:function(a){if("undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(a,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var b=new window.ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b}throw new Error("No XML parser found")},_parse_gpx_data:function(a,b){var c,d,e,f=[],g=[["rte","rtept"],["trkseg","trkpt"]],h=a.getElementsByTagName("name");for(h.length>0&&(this._info.name=h[0].textContent||h[0].text||h[0].innerText),c=0;c<g.length;c++)for(e=a.getElementsByTagName(g[c][0]),d=0;d<e.length;d++){var i=this._parse_trkseg(e[d],a,b,g[c][1]);if(0!==i.length){var j=new L.Polyline(i,b.polyline_options);if(this.fire("addline",{line:j}),f.push(j),"show"==mapsmarkerjspro.gpx_icons_status){var k=new L.Marker(i[0],{interactive:!1,icon:new L.GPXTrackIcon({iconUrl:b.marker_options.startIconUrl})});this.fire("addpoint",{point:k}),f.push(k),k=new L.Marker(i[i.length-1],{interactive:!1,icon:new L.GPXTrackIcon({iconUrl:b.marker_options.endIconUrl})}),this.fire("addpoint",{point:k}),f.push(k)}}}if(this._info.hr.avg=Math.round(this._info.hr._total/this._info.hr._points.length),f.length){var l=f[0];return f.length>1&&(l=new L.FeatureGroup(f)),l}},_parseDate_for_IE8:function(a){var b=/^(\d{4})(?:-?W(\d+)(?:-?(\d+)D?)?|(?:-(\d+))?-(\d+))(?:[T ](\d+):(\d+)(?::(\d+)(?:\.(\d+))?)?)?(?:Z(-?\d*))?$/,c=a.match(b);if(null==c)throw new Error("Invalid Date");var d=Number(c[1]);if("undefined"!=typeof c[2]){var e=Number(c[2])-1,f=Number(c[3]);"undefined"==typeof f&&(f=0),f+=7*e;var g=0}else{if("undefined"!=typeof c[4])var g=Number(c[4])-1;else var g=0;var f=Number(c[5])}if("undefined"!=typeof c[6]&&"undefined"!=typeof c[7]){var h=Number(c[6]),i=Number(c[7]);if("undefined"!=typeof c[8]){var j=Number(c[8]);if("undefined"!=typeof c[9])var k=Number(c[9]),l=k/100;else var l=0}else var j=0,l=0}else var h=0,i=0,j=0,k=0,l=0;if("undefined"!=typeof c[10]){var m=-(new Date).getTimezoneOffset(),n=60*c[10];i=Number(i)+(n-m)}return new Date(d,g,f,h,i,j,l)},_parse_trkseg:function(a,b,c,d){var e=a.getElementsByTagName(d);if(!e.length)return[];for(var f=[],g=null,h=0;h<e.length;h++){var i,j=new L.LatLng(e[h].getAttribute("lat"),e[h].getAttribute("lon"));if(j.meta={time:null,ele:null,hr:null},i=e[h].getElementsByTagName("time"),i.length>0)if(window.addEventListener){var k=Date.parse(i[0].textContent);j.meta.time=new Date(k)}else j.meta.time=this._parseDate_for_IE8(i[0].text);if(i=e[h].getElementsByTagName("ele"),i.length>0&&(j.meta.ele=parseFloat(i[0].textContent||i[0].text||i[0].innerText)),i=e[h].getElementsByTagName("hr"),i.length>0&&(j.meta.hr=parseInt(i[0].textContent||i[0].text||i[0].innerText),this._info.hr._points.push([this._info.length,j.meta.hr]),this._info.hr._total+=j.meta.hr),this._info.elevation._points.push([this._info.length,j.meta.ele]),this._info.duration.end=j.meta.time,null!=g){this._info.length+=this._dist3d(g,j);var l=j.meta.ele-g.meta.ele;l>0?this._info.elevation.gain+=l:this._info.elevation.loss+=Math.abs(l),l=Math.abs(j.meta.time-g.meta.time),this._info.duration.total+=l,l<c.max_point_interval&&(this._info.duration.moving+=l)}else this._info.duration.start=j.meta.time;g=j,f.push(j)}return f},_dist2d:function(a,b){var c=6371e3,d=this._deg2rad(b.lat-a.lat),e=this._deg2rad(b.lng-a.lng),f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(this._deg2rad(a.lat))*Math.cos(this._deg2rad(b.lat))*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},_dist3d:function(a,b){var c=this._dist2d(a,b),d=Math.abs(b.meta.ele-a.meta.ele);return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))},_deg2rad:function(a){return a*Math.PI/180}});
/*
Copyright (c) 2016 Dominik Moritz, v0.58/28.11.2016
This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&("undefined"!=typeof b&&b.L?module.exports=a(L):module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.Control.Locate=a(L))}(function(a){var b=a.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPan",keepCurrentZoomLevel:!1,flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView"},returnToPrevBounds:!1,drawCircle:!0,drawMarker:!0,markerClass:a.CircleMarker,circleStyle:{color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:2,opacity:.5},markerStyle:{color:"#136AEC",fillColor:"#2A93EE",fillOpacity:.7,weight:2,opacity:.9,radius:5},followCircleStyle:{},followMarkerStyle:{},icon:"icon-location",iconLoading:"icon-spinner animate-spin",iconElementTag:"span",circlePadding:[0,0],metric:!0,onLocationError:function(a,b){alert(a.message)},onLocationOutsideMapBounds:function(a){a.stop(),alert(a.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(b){for(var c in b)"object"==typeof this.options[c]?a.extend(this.options[c],b[c]):this.options[c]=b[c];this.options.followMarkerStyle=a.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=a.extend({},this.options.circleStyle,this.options.followCircleStyle)},onAdd:function(b){var c=a.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");return this._layer=this.options.layer||new a.LayerGroup,this._layer.addTo(b),this._event=void 0,this._prevBounds=null,this._link=a.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single "+this.options.icon,c),this._link.href="#",this._link.title=this.options.strings.title,this._icon=a.DomUtil.create(this.options.iconElementTag,this.options.icon,this._link),a.DomEvent.on(this._link,"click",a.DomEvent.stopPropagation).on(this._link,"click",a.DomEvent.preventDefault).on(this._link,"click",this._onClick,this).on(this._link,"dblclick",a.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),c},_onClick:function(){if(this._justClicked=!0,this._userPanned=!1,this._active&&!this._event)this.stop();else if(this._active&&void 0!==this._event){var a=this._map.getBounds().contains(this._event.latlng)?this.options.clickBehavior.inView:this.options.clickBehavior.outOfView;switch(a){case"setView":this.setView();break;case"stop":if(this.stop(),this.options.returnToPrevBounds){var b=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;b.bind(this._map)(this._prevBounds)}}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},_activate:function(){this._active||(this._map.locate(this.options.locateOptions),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this))},_deactivate:function(){this._map.stopLocate(),this._active=!1,this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this)},setView:function(){if(this._drawMarker(),this._isOutsideMapBounds())this.options.onLocationOutsideMapBounds(this);else if(this.options.keepCurrentZoomLevel){var a=this.options.flyTo?this._map.flyTo:this._map.panTo;a.bind(this._map)([this._event.latitude,this._event.longitude])}else{var a=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;a.bind(this._map)(this._event.bounds,{padding:this.options.circlePadding,maxZoom:this.options.locateOptions.maxZoom})}},_drawMarker:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var b=this._event.accuracy,c=this._event.latlng;if(this.options.drawCircle){var d=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(c).setRadius(b).setStyle(d):this._circle=a.circle(c,b,d).addTo(this._layer)}var e,f;if(this.options.metric?(e=b.toFixed(0),f=this.options.strings.metersUnit):(e=(3.2808399*b).toFixed(0),f=this.options.strings.feetUnit),this.options.drawMarker){var g=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(c),this._marker.setStyle&&this._marker.setStyle(g)):this._marker=new this.options.markerClass(c,g).addTo(this._layer)}var h=this.options.strings.popup;this.options.showPopup&&h&&this._marker&&this._marker.bindPopup(a.Util.template(h,{distance:e,unit:f}))._popup.setLatLng(c)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_onLocationError:function(a){3==a.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(a,this))},_onLocationFound:function(a){if((!this._event||this._event.latlng.lat!==a.latlng.lat||this._event.latlng.lng!==a.latlng.lng||this._event.accuracy!==a.accuracy)&&this._active){switch(this._event=a,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"always":this.setView();break;case!1:}this._justClicked=!1}},_onDrag:function(){this._event&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){return!!this._active&&("always"===this.options.setView||("untilPan"===this.options.setView?!this._userPanned:void 0))},_isOutsideMapBounds:function(){return void 0!==this._event&&(this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng))},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(b){"requesting"==b?(a.DomUtil.removeClasses(this._container,"active following"),a.DomUtil.addClasses(this._container,"requesting"),a.DomUtil.removeClasses(this._icon,this.options.icon),a.DomUtil.addClasses(this._icon,this.options.iconLoading)):"active"==b?(a.DomUtil.removeClasses(this._container,"requesting following"),a.DomUtil.addClasses(this._container,"active"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)):"following"==b&&(a.DomUtil.removeClasses(this._container,"requesting"),a.DomUtil.addClasses(this._container,"active following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon))},_cleanClasses:function(){a.DomUtil.removeClass(this._container,"requesting"),a.DomUtil.removeClass(this._container,"active"),a.DomUtil.removeClass(this._container,"following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1}});return a.control.locate=function(b){return new a.Control.Locate(b)},function(){var b=function(b,c,d){d=d.split(" "),d.forEach(function(d){a.DomUtil[b].call(this,c,d)})};a.DomUtil.addClasses=function(a,c){b("addClass",a,c)},a.DomUtil.removeClasses=function(a,c){b("removeClass",a,c)}}(),b},window);
/*
URL hashes - based on leaflet-hash.js, Copyright (c) 2013 @mlevans, MIT License
https://github.com/mlevans/leaflet-hash
*/
!function(a){var b=function(){var b=a.documentMode;return"onhashchange"in a&&(void 0===b||b>7)}();L.Hash=function(b){"undefined"==typeof a.leaflet_hash_requested&&(this.onHashChange=L.Util.bind(this.onHashChange,this),b&&this.init(b),this.events=new Object,a.leaflet_hash_requested=!0)},L.Hash.parseHash=function(a){0===a.indexOf("#")&&(a=a.substr(1));var b=a.split("/");if(3==b.length){var c=parseInt(b[0],10),d=parseFloat(b[1]),e=parseFloat(b[2]);return isNaN(c)||isNaN(d)||isNaN(e)?!1:{center:new L.LatLng(d,e),zoom:c}}return!1},L.Hash.formatHash=function(a){var b=a.getCenter(),c=a.getZoom(),d=Math.max(0,Math.ceil(Math.log(c)/Math.LN2));return"#"+[c,b.lat.toFixed(d),b.lng.toFixed(d)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(a){this.map=a,this.lastHash=null,this.onHashChange(),this.startListening()},removeFrom:function(a){this.changeTimeout&&clearTimeout(this.changeTimeout),this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var a=location.hash.split("/"),b=location.hash.charAt(1);if(3!=a.length&&!isNaN(parseFloat(b))&&isFinite(b))return!1;var c=this.formatHash(this.map);if(this.events.change)for(var d=0;d<this.events.change.length;d++)c=this.events.change[d](c);if(this.lastHash!=c&&(location.replace(c),this.lastHash=c,this.events.hash))for(var d=0;d<this.events.hash.length;d++)this.events.hash[d](c)},movingMap:!1,update:function(){var a=location.hash;if(a!==this.lastHash){var b=this.parseHash(a);if(b){if(this.movingMap=!0,this.map.setView(b.center,b.zoom,{animate:!1}),this.events.update)for(var c=0;c<this.events.update.length;c++)this.events.update[c](a);this.movingMap=!1}else this.onMapMove(this.map)}},on:function(a,b){this.events[a]?this.events[a].push(b):this.events[a]=[b]},off:function(a,b){if(this.events[a])for(var c=0;c<this.events[a].length;c++)if(this.events[a][c]==b)return void this.events[a].splice(c)},trigger:function(a){"move"==a&&(this.movingMap||this.onMapMove())},setMovingMap:function(){this.movingMap=!0},clearMovingMap:function(){this.movingMap=!1},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var a=this;this.changeTimeout=setTimeout(function(){a.update(),a.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.isListening||(this.map.on("moveend",this.onMapMove,this),b?L.DomEvent.addListener(a,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0)},stopListening:function(){this.isListening&&(this.map.off("moveend",this.onMapMove,this),b?L.DomEvent.removeListener(a,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1)}},L.hash=function(a){return new L.Hash(a)},L.Map.include({addHash:function(){return this._hash=L.hash(this),this},removeHash:function(){return this._hash.remove(),this}})}(window);
/*!
 Leaflet.MarkerCluster.LayerSupport 1.0.3+1372080
 (c) 2015-2017 Boris Seang
 License MIT
 */
!function(e,r){"function"==typeof define&&define.amd?define(["leaflet"],r):r("object"==typeof module&&module.exports?require("leaflet"):e.L)}(this,function(e,r){var i=e.MarkerClusterGroup,o=i.prototype,t=i.extend({options:{singleAddRemoveBufferDuration:100},initialize:function(e){o.initialize.call(this,e),this._featureGroup=new a,this._featureGroup.addEventParent(this),this._nonPointGroup=new a,this._nonPointGroup.addEventParent(this),this._layers={},this._proxyLayerGroups={},this._proxyLayerGroupsNeedRemoving={},this._singleAddRemoveBuffer=[]},checkIn:function(e){var r=this._toArray(e);return this._checkInGetSeparated(r),this},checkOut:function(r){var i,o,t=this._toArray(r),a=this._separateSingleFromGroupLayers(t,{groups:[],singles:[]}),s=a.groups,n=a.singles;for(i=0;i<n.length;i++)o=n[i],delete this._layers[e.stamp(o)],delete o._mcgLayerSupportGroup;for(this._originalRemoveLayers(n),i=0;i<s.length;i++)o=s[i],this._dismissProxyLayerGroup(o);return this},addLayers:function(r){var i,o,t,a=this._toArray(r),s=this._checkInGetSeparated(a),n=s.groups;for(this._originalAddLayers(s.singles),i=0;i<n.length;i++)o=n[i],t=e.stamp(o),this._proxyLayerGroups[t]=o,delete this._proxyLayerGroupsNeedRemoving[t],this._map&&this._map._originalAddLayer(o)},addLayer:function(e){return this._bufferSingleAddRemove(e,"addLayers"),this},_originalAddLayer:o.addLayer,_originalAddLayers:o.addLayers,removeLayers:function(r){var i,o,t=this._toArray(r),a=this._separateSingleFromGroupLayers(t,{groups:[],singles:[]}),s=a.groups,n=a.singles,p=0;for(this._originalRemoveLayers(n);p<s.length;p++)i=s[p],o=e.stamp(i),delete this._proxyLayerGroups[o],this._map?this._map._originalRemoveLayer(i):this._proxyLayerGroupsNeedRemoving[o]=i;return this},removeLayer:function(e){return this._bufferSingleAddRemove(e,"removeLayers"),this},_originalRemoveLayer:o.removeLayer,_originalRemoveLayers:o.removeLayers,onAdd:function(r){r._originalAddLayer=r._originalAddLayer||r.addLayer,r._originalRemoveLayer=r._originalRemoveLayer||r.removeLayer,e.extend(r,n);var i,t,a,s=this._removePreAddedLayers(r);o.onAdd.call(this,r);for(i in this._proxyLayerGroups)t=this._proxyLayerGroups[i],r._originalAddLayer(t);for(i in this._proxyLayerGroupsNeedRemoving)t=this._proxyLayerGroupsNeedRemoving[i],r._originalRemoveLayer(t),delete this._proxyLayerGroupsNeedRemoving[i];for(a=0;a<s.length;a++)r.addLayer(s[a])},_bufferSingleAddRemove:function(r,i){var o,t=this.options.singleAddRemoveBufferDuration;t>0?(this._singleAddRemoveBuffer.push({type:i,layer:r}),this._singleAddRemoveBufferTimeout||(o=e.bind(this._processSingleAddRemoveBuffer,this),this._singleAddRemoveBufferTimeout=setTimeout(o,t))):this[i](r)},_processSingleAddRemoveBuffer:function(){for(var e,r,i=this._singleAddRemoveBuffer,o=0,t=[];o<i.length;o++)e=i[o],r||(r=e.type),e.type===r?t.push(e.layer):(this[r](t),t=[e.layer]);this[r](t),i.length=0,clearTimeout(this._singleAddRemoveBufferTimeout),this._singleAddRemoveBufferTimeout=null},_checkInGetSeparated:function(r){var i,o,t=this._separateSingleFromGroupLayers(r,{groups:[],singles:[]}),a=t.groups,s=t.singles;for(i=0;i<a.length;i++)o=a[i],this._recruitLayerGroupAsProxy(o);for(i=0;i<s.length;i++)o=s[i],this._removeFromOtherGroupsOrMap(o),this._layers[e.stamp(o)]=o,o._mcgLayerSupportGroup=this;return t},_separateSingleFromGroupLayers:function(r,i){for(var o,t=i.groups,a=i.singles,s=e.Util.isArray,n=0;n<r.length;n++)o=r[n],o instanceof e.LayerGroup?(t.push(o),this._separateSingleFromGroupLayers(o.getLayers(),i)):s(o)?this._separateSingleFromGroupLayers(o,i):a.push(o);return i},_recruitLayerGroupAsProxy:function(r){var i=r._proxyMcgLayerSupportGroup;if(i){if(i===this)return;i.checkOut(r)}else this._removeFromOwnMap(r);r._proxyMcgLayerSupportGroup=this,r._originalAddLayer=r._originalAddLayer||r.addLayer,r._originalRemoveLayer=r._originalRemoveLayer||r.removeLayer,e.extend(r,s)},_dismissProxyLayerGroup:function(i){if(i._proxyMcgLayerSupportGroup!==r&&i._proxyMcgLayerSupportGroup===this){delete i._proxyMcgLayerSupportGroup,i.addLayer=i._originalAddLayer,i.removeLayer=i._originalRemoveLayer;var o=e.stamp(i);delete this._proxyLayerGroups[o],delete this._proxyLayerGroupsNeedRemoving[o],this._removeFromOwnMap(i)}},_removeFromOtherGroupsOrMap:function(e){var r=e._mcgLayerSupportGroup;if(r){if(r===this)return;r.checkOut(e)}else e.__parent?e.__parent._group.removeLayer(e):this._removeFromOwnMap(e)},_removeFromOwnMap:function(e){e._map&&e._map.removeLayer(e)},_removePreAddedLayers:function(e){var r,i=this._layers,o=[];for(var t in i)r=i[t],r._map&&(o.push(r),e._originalRemoveLayer(r));return o},_toArray:function(r){return e.Util.isArray(r)?r:[r]}}),a=e.FeatureGroup.extend({addLayer:function(r){if(this.hasLayer(r))return this;r.addEventParent(this);var i=e.stamp(r);return this._layers[i]=r,this._map&&this._map._originalAddLayer(r),this.fire("layeradd",{layer:r})},removeLayer:function(r){if(!this.hasLayer(r))return this;r in this._layers&&(r=this._layers[r]),r.removeEventParent(this);var i=e.stamp(r);return this._map&&this._layers[i]&&this._map._originalRemoveLayer(this._layers[i]),delete this._layers[i],this.fire("layerremove",{layer:r})},onAdd:function(e){this._map=e,this.eachLayer(e._originalAddLayer,e)},onRemove:function(e){this.eachLayer(e._originalRemoveLayer,e),this._map=null}}),s={addLayer:function(e){var r=this.getLayerId(e);return this._layers[r]=e,this._map?this._proxyMcgLayerSupportGroup.addLayer(e):this._proxyMcgLayerSupportGroup.checkIn(e),this},removeLayer:function(e){var r=e in this._layers?e:this.getLayerId(e);return this._proxyMcgLayerSupportGroup.removeLayer(e),delete this._layers[r],this}},n={addLayer:function(e){return e._mcgLayerSupportGroup?e._mcgLayerSupportGroup._originalAddLayer(e):this._originalAddLayer(e)},removeLayer:function(e){return e._mcgLayerSupportGroup?e._mcgLayerSupportGroup._originalRemoveLayer(e):this._originalRemoveLayer(e)}};e.markerClusterGroup.layerSupport=function(e){return new t(e)}});
/*
Leaflet zoom control with a home button for resetting the view (https://github.com/torfsen/leaflet.zoomhome)
By torfsen, based code by toms (https://gis.stackexchange.com/a/127383/48264), license: Creative Commons Attribution ShareAlike (CC BY-SA 3.0)
*/
!function(){"use strict";L.Control.ZoomHome=L.Control.extend({options:{position:"topleft",mapId:"",mapnameJS:"",ondemand:!1,zoomHomeTitle:"Home",homeCoordinates:null,homeZoom:null,reenableClustering:!1},onAdd:function(a){var b="leaflet-control-zoomhome",c=L.DomUtil.create("div",b+" leaflet-bar"),d=this.options;c.setAttribute("id","leaflet-control-zoomhome-"+d.mapId),1==d.ondemand&&(c.style.display="none"),null===d.homeCoordinates&&(d.homeCoordinates=a.getCenter()),null===d.homeZoom&&(d.homeZoom=a.getZoom());var e='<span class="lmm-icon-zoomhome"></span>';return this._zoomHomeButton=this._createButton(e,d.zoomHomeTitle,b+"-home lmm-icon-zoomhome",c,this._zoomHome.bind(this)),c},_zoomHome:function(a){var b=this.options.reenableClustering;this._map.closePopup(),this._map.setView(this.options.homeCoordinates,this.options.homeZoom,{animate:!0}),"true"===b&&window["markercluster_"+this.options.mapnameJS].enableClustering();var c=this.options.mapId,d=this.options.ondemand;setTimeout(function(){1==d&&(document.getElementById("leaflet-control-zoomhome-"+c).style.display="none")},500)},_createButton:function(a,b,c,d,e){var f=L.DomUtil.create("a",c,d);return f.innerHTML=a,f.href="#",f.title=b,L.DomEvent.on(f,"mousedown dblclick",L.DomEvent.stopPropagation).on(f,"click",L.DomEvent.stop).on(f,"click",e,this).on(f,"click",this._refocusOnMap,this),f}}),L.Control.zoomHome=function(a){return new L.Control.ZoomHome(a)}}();
/*
Javascript Events API for LeafletJS, https://mapsmarker.com/jseventsapi/
*/
var MMP={maps:{byId:function(a){return window[MMP.maps[a]]},onAll:function(a,b){jQuery.each(MMP.maps,function(c,d){isNaN(c)||window[d].on(a,b)})},toAll:function(a){jQuery.each(MMP.maps,function(b,c){isNaN(b)||a(window[c])})},getAllMarkers:function(){var a=[];return jQuery.each(MMP.maps,function(b,c){"undefined"!=typeof window[MMP.maps[b]]&&jQuery.each(window[MMP.maps[b]]._layers,function(b,c){"undefined"!=typeof c.feature&&(a[c.feature.properties.markerid]=this)})}),a},getMarker:function(a,b){var c;return jQuery.each(window[MMP.maps[a]]._layers,function(a,d){"undefined"!=typeof d.feature&&d.feature.properties.markerid==b&&(c=this)}),c}}};
/*
Maps filters
*/
L.Control.Filters=L.Control.Layers.extend({options:{position:"topright",autoZIndex:!0,hideSingleBase:!1},_addItem:function(a){var d,b=document.createElement("label"),c=this._map.hasLayer(a.layer);a.overlay?(d=document.createElement("input"),d.type="checkbox",d.id=a.layer.layer_id,d.setAttribute("markercount",a.layer.markercount),d.className="leaflet-control-layers-selector lmm-filter",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers",c),d.layerId=L.stamp(a.layer),L.DomEvent.on(d,"click",this._onInputClick,this);var e=document.createElement("span");e.innerHTML=" "+a.name;var f=document.createElement("div");b.appendChild(f),f.appendChild(d),f.appendChild(e);var g=a.overlay?this._overlaysList:this._baseLayersList;return g.appendChild(b),this._checkDisabledLayers(),b},_initLayout:function(){var a="leaflet-control-layers",b=this._container=L.DomUtil.create("div",a),c=this.options.collapsed;b.setAttribute("aria-haspopup",!0),L.DomEvent.disableClickPropagation(b),L.Browser.touch||L.DomEvent.disableScrollPropagation(b);var d=this._form=L.DomUtil.create("form",a+"-list");c&&(this._map.on("click",this.collapse,this),L.Browser.android||L.DomEvent.on(b,{mouseenter:this.expand,mouseleave:this.collapse},this));var e=this._layersLink=L.DomUtil.create("a",a+"-toggle lmm-filters-icon",b);e.href="#",e.title="Layers",L.Browser.touch?L.DomEvent.on(e,"click",L.DomEvent.stop).on(e,"click",this.expand,this):L.DomEvent.on(e,"focus",this.expand,this),L.DomEvent.on(d,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),c||this.expand(),this._baseLayersList=L.DomUtil.create("div",a+"-base",d),this._separator=L.DomUtil.create("div",a+"-separator",d),this._overlaysList=L.DomUtil.create("div",a+"-overlays",d),b.appendChild(d)}}),L.control.filters=function(a,b,c){return new L.Control.Filters(a,b,c)};
/*
dynamic markers list pagination
*/
function mmp_askForMarkersFromPagination(a,e,r){if(null==a||!jQuery(a).hasClass("current-page")){if(!e)var e=jQuery(a).html();if(!r)var r=jQuery(a).attr("data-mapid");var l=jQuery("#markers_per_page_"+r).val();if("undefined"!=typeof jQuery("#search_markers_"+r).val())var t=jQuery("#search_markers_"+r).val();else var t="";if("undefined"!=typeof jQuery("#id").val())var m=jQuery("#id").val();else var m=jQuery("#"+r+"_id").val();var _=jQuery("#lmm_listmarkers_table_"+r).attr("data-mapname"),i="",n="";if("undefined"!=typeof window["mmp_cache_current_location_"+r])var i=window["mmp_cache_current_location_"+r].latitude,n=window["mmp_cache_current_location_"+r].longitude;if(null!=a)var s=a;else var s="#pagination_"+r+" .first-page:first";jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:e,order_by:jQuery("#"+r+"_orderby").val(),order:jQuery("#"+r+"_order").val(),multi_layer_map:jQuery("#"+r+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+r+"_multi_layer_map_list").val(),markercount:jQuery("#"+r+"_markercount").val(),mapid:r,layerlat:i,layerlon:n,per_page:l,mapname:_,search_text:t,id:m},beforeSend:function(){r&&jQuery(".lmm-filter").attr("disabled","disabled"),jQuery("#search_markers_"+r).addClass("searchtext_loading"),jQuery("#pagination_"+r).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>')},method:"POST",success:function(e){var l=e.replace(/^\s*[\r\n]/gm,""),l=l.match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],m=JSON.parse(l);if(jQuery("#lmm_listmarkers_table_"+r).html(m.rows),jQuery("#lmm_listmarkers_table_"+r).append('<tr id="pagination_row_'+r+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+r+'" class="tablenav-pages">'+m.pager+"</div></div></td></tr>"),jQuery(s).addClass("current-page"),""==t)try{window["mmp_calculate_total_markers_"+r]()}catch(_){}if(r&&jQuery(".lmm-filter").removeAttr("disabled"),null!=a)try{jQuery("html,body").animate({scrollTop:jQuery("#lmm_"+r).offset().top},1e3)}catch(i){jQuery("html,body").animate({scrollTop:jQuery("#lmm_backend").offset().top},1e3)}}})}}jQuery(document).on("click","a.first-page",function(a){a.preventDefault(),mmp_askForMarkersFromPagination(this)});
/*
dynamic markers per page
*/
jQuery(document).on("change",".lmm-per-page-input",function(){var a=parseInt(jQuery(this).val()),e=jQuery(this).attr("data-mapid");if("undefined"!=typeof jQuery("#id").val())var r=jQuery("#id").val();else var r=jQuery("#"+e+"_id").val();var t=jQuery("#search_markers_"+e).val();if(!isNaN(a)){jQuery(".current-page").removeClass("current-page");var l=this;jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:1,order_by:jQuery("#"+e+"_orderby").val(),order:jQuery("#"+e+"_order").val(),multi_layer_map:jQuery("#"+e+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+e+"_multi_layer_map_list").val(),markercount:jQuery("#"+e+"_markercount").val(),mapid:e,per_page:a,search_text:t,id:r},beforeSend:function(){jQuery("#pagination_"+e).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>'),jQuery("#search_markers_"+e).addClass("searchtext_loading")},method:"POST",success:function(a){var r=a.replace(/^\s*[\r\n]/gm,""),r=r.match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],_=JSON.parse(r);if("undefined"!=typeof _.pager?(jQuery("#lmm_listmarkers_table_"+e).html(_.rows),jQuery("#lmm_listmarkers_table_"+e).append('<tr id="pagination_row_'+e+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+e+'" class="tablenav-pages">'+_.pager+"</div></div></td></tr>")):jQuery("#pagination_"+e).html(""),jQuery(l).addClass("current-page"),""==t)try{window["mmp_calculate_total_markers_"+e]()}catch(m){}}})}});
/*
dynamic search
*/
function mmp_debounce(a,e,r){var t;return function(){var o=this,n=arguments,_=function(){t=null,r||a.apply(o,n)},m=r&&!t;clearTimeout(t),t=setTimeout(_,e),m&&a.apply(o,n)}}function mmp_askForMarkers(a){if(jQuery(a.target).val().length>0){var e=String.fromCharCode(a.which);if(/[a-zA-Z0-9-_ ]/.test(e)||13==a.which){r=jQuery(a.target).attr("data-mapid");"distance_current_position"==(t=jQuery("#dropdown_"+r).attr("data-sortby"))?void 0!==window["mmp_cache_current_location_"+r]?mmp_get_markers(a.target,r,window["mmp_cache_current_location_"+r]):void 0!==window["locatecontrol_"+mapname]?(window["locatecontrol_"+mapname].start(),window[mapname].on("locationfound",function(e){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=e,mmp_get_markers(a.target,r,e))})):window[mapname].locate().on("locationfound",function(e){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=e,mmp_get_markers(a.target,r,e))}):mmp_get_markers(a.target,r)}}else if(0==jQuery(a.target).val().length&&(17==a.which||8==a.which)){var r=jQuery(a.target).attr("data-mapid"),t=jQuery("#dropdown_"+r).attr("data-sortby");"distance_current_position"==t?void 0!==window["mmp_cache_current_location_"+r]?mmp_get_markers(a.target,r,window["mmp_cache_current_location_"+r]):void 0!==window["locatecontrol_"+mapname]?(window["locatecontrol_"+mapname].start(),window[mapname].on("locationfound",function(e){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=e,mmp_get_markers(a.target,r,e))})):window[mapname].locate().on("locationfound",function(e){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=e,mmp_get_markers(a.target,r,e))}):mmp_get_markers(a.target,r)}}function mmp_askForMarkersFromDropdown(a,e){var r=jQuery(a.target).parent().attr("data-mapid"),t=jQuery(a.target).attr("data-sortby"),o=jQuery("#lmm_listmarkers_table_"+r).attr("data-mapname");"distance_current_position"==t?void 0!==window["mmp_cache_current_location_"+r]?mmp_get_markers(a.target,r,window["mmp_cache_current_location_"+r],e):(mmp_get_markers(a.target,r,window[o].getCenter(),e),void 0!==window["locatecontrol_"+o]?(window["locatecontrol_"+o].start(),window[o].on("locationfound",function(t){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=t,mmp_get_markers(a.target,r,t,e))})):window[o].locate().on("locationfound",function(t){void 0===window["mmp_cache_current_location_"+r]&&(window["mmp_cache_current_location_"+r]=t,mmp_get_markers(a.target,r,t,e))})):mmp_get_markers(a.target,r)}function mmp_get_markers(a,e,r,t){t=void 0===t||t;var o=jQuery("#search_markers_"+e).val();if(void 0===jQuery(a).attr("data-sortby"))n=jQuery("#dropdown_"+e).attr("data-sortby");else var n=jQuery(a).attr("data-sortby");var _=jQuery("#lmm_listmarkers_table_"+e).attr("data-mapname");if(void 0!==jQuery("#id").val())m=jQuery("#id").val();else var m=jQuery("#"+e+"_id").val();if(r)var i=r.latitude,l=r.longitude;if(jQuery(a).hasClass("lmm-sort-by")&&t)if(jQuery(a).hasClass("up")){s="desc";jQuery(".lmm-sort-by").removeClass("up"),jQuery(".lmm-sort-by").removeClass("down"),jQuery(a).removeClass("up"),jQuery(a).addClass("down"),jQuery("#dropdown_"+e).removeClass("up"),jQuery("#dropdown_"+e).addClass("down")}else{s="asc";jQuery(".lmm-sort-by").removeClass("up"),jQuery(".lmm-sort-by").removeClass("down"),jQuery(a).removeClass("down"),jQuery(a).addClass("up"),jQuery("#dropdown_"+e).removeClass("down"),jQuery("#dropdown_"+e).addClass("up")}else if(jQuery("#dropdown_"+e).hasClass("up"))s="asc";else var s="desc";var c=parseInt(jQuery("#markers_per_page_"+e).val());jQuery(".current-page").removeClass("current-page");var d=a;jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:1,multi_layer_map:jQuery("#"+e+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+e+"_multi_layer_map_list").val(),markercount:jQuery("#"+e+"_markercount").val(),mapid:e,per_page:c,search_text:o,order_by:n,order:s,layerlat:i,layerlon:l,mapname:_,id:m},beforeSend:function(){jQuery("#pagination_"+e).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>'),jQuery("#search_markers_"+e).addClass("searchtext_loading")},method:"POST",success:function(a){var r=(r=a.replace(/^\s*[\r\n]/gm,"")).match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],t=JSON.parse(r);if(jQuery("#lmm_listmarkers_table_"+e).html(t.rows),1==t.no_pagination?""!=o&&0==t.mcount?jQuery("#lmm_listmarkers_table_"+e).append('<tr id="pagination_row_'+e+'"><td colspan="2" style="text-align:center"><div class="tablenav">'+lmm_ajax_vars.lmm_ajax_text_no_results_found+'<div id="pagination_'+e+'" class="tablenav-pages" style="display:none;">'+t.pager+"</div></div></td></tr>"):jQuery("#lmm_listmarkers_table_"+e).append('<tr id="pagination_row_'+e+'" style="display:none;"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+e+'" class="tablenav-pages">'+t.pager+"</div></div></td></tr>"):jQuery("#lmm_listmarkers_table_"+e).append('<tr id="pagination_row_'+e+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+e+'" class="tablenav-pages">'+t.pager+"</div></div></td></tr>"),jQuery(d).addClass("current-page"),""!=o){jQuery("#search_markers_"+e).focus();var n=jQuery("#search_markers_"+e).val();jQuery("#search_markers_"+e).val(""),jQuery("#search_markers_"+e).val(n)}else try{window["mmp_calculate_total_markers_"+e]()}catch(a){}}})}jQuery(document).on("keyup",".lmm-search-markers",mmp_debounce(mmp_askForMarkers,1e3)),jQuery(document).on("click",".lmm-sort-by",mmp_debounce(mmp_askForMarkersFromDropdown,500));
/*!
 Leaflet.MarkerCluster.Freezable 0.1.1+0285b6c
 (c) 2015-2016 Boris Seang
 License MIT
 */
!function(e,i){"function"==typeof define&&define.amd?define(["leaflet"],i):i("object"==typeof module&&module.exports?require("leaflet"):e.L)}(this,function(e,i){e.MarkerClusterGroup.include({_originalOnAdd:e.MarkerClusterGroup.prototype.onAdd,onAdd:function(e){var i=this._zoom;this._originalOnAdd(e),this._frozen&&(i>=0&&i!==this._zoom&&(this._featureGroup.clearLayers(),this._zoom=i,this.addLayers([])),e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),e.on("zoomend moveend",this._viewChangeEndNotClustering,this))},_originalOnRemove:e.MarkerClusterGroup.prototype.onRemove,onRemove:function(e){e.off("zoomend moveend",this._viewChangeEndNotClustering,this),this._originalOnRemove(e)},disableClustering:function(){return this.freezeAtZoom(this._maxZoom+1)},disableClusteringKeepSpiderfy:function(){return this.freezeAtZoom(this._maxZoom)},enableClustering:function(){return this.unfreeze()},unfreeze:function(){return this.freezeAtZoom(!1)},freezeAtZoom:function(e){this._processQueue();var o=this._map;e===i||e===!0||e!==e?e=o?Math.round(o.getZoom()):-1:"max"===e?e=this._maxZoom+1:"maxKeepSpiderfy"===e&&(e=this._maxZoom);var t="number"==typeof e;if(this._frozen){if(!t)return this._unfreeze(),this}else{if(!t)return this;this._initiateFreeze()}return this._artificialZoomSafe(this._zoom,e),this},_initiateFreeze:function(){var e=this._map;this._frozen=!0,e&&(e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),e.on("zoomend moveend",this._viewChangeEndNotClustering,this))},_unfreeze:function(){var e=this._map;this._frozen=!1,e&&(e.off("zoomend moveend",this._viewChangeEndNotClustering,this),e.on("zoomend",this._zoomEnd,this),e.on("moveend",this._moveEnd,this),this._executeAfterUnspiderfy(function(){this._zoomEnd()},this))},_executeAfterUnspiderfy:function(e,i){return this._unspiderfy&&this._spiderfied?(this.once("animationend",function(){e.call(i)}),void this._unspiderfy()):void e.call(i)},_artificialZoomSafe:function(e,i){this._zoom=i,this._map&&e!==i&&this._executeAfterUnspiderfy(function(){this._artificialZoom(e,i)},this)},_artificialZoom:function(e,i){e<i?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e,this._getExpandedVisibleBounds()),this._animationZoomIn(e,i)):e>i&&(this._animationStart(),this._animationZoomOut(e,i))},_viewChangeEndNotClustering:function(){var e=this._featureGroup,i=this._getExpandedVisibleBounds(),o=this._zoom;e.eachLayer(function(t){!i.contains(t._latlng)&&t.__parent&&t.__parent._zoom<o&&e.removeLayer(t)}),this._topClusterLevel._recursively(i,-1,o,function(t){if(t._zoom!==o)for(var n,r=t._markers,s=0;s<r.length;s++)n=t._markers[s],i.contains(n._latlng)&&e.addLayer(n)},function(e){e._addToMap()})},_originalZoomOrSpiderfy:e.MarkerClusterGroup.prototype._zoomOrSpiderfy,_zoomOrSpiderfy:function(e){this._frozen&&this.options.spiderfyOnMaxZoom?(e.layer.spiderfy(),e.originalEvent&&13===e.originalEvent.keyCode&&map._container.focus()):this._originalZoomOrSpiderfy(e)}})});
/*
 * Leaflet.EdgeBuffer, https://github.com/TolonUK/Leaflet.EdgeBuffer (v1.0.5), License: MIT
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),void 0!==b&&b.L&&!b.L.EdgeBuffer&&a(b.L)}(function(a){a.EdgeBuffer={previousMethods:{getTiledPixelBounds:a.GridLayer.prototype._getTiledPixelBounds}},a.GridLayer.include({_getTiledPixelBounds:function(b,c,d){var e=a.EdgeBuffer.previousMethods.getTiledPixelBounds.call(this,b,c,d),f=1;if(void 0!==this.options.edgeBufferTiles&&null!==this.options.edgeBufferTiles&&(f=this.options.edgeBufferTiles),f>0){var g=f*this.options.tileSize;e=new a.Bounds(e.min.subtract([g,g]),e.max.add([g,g]))}return e}})},window);
