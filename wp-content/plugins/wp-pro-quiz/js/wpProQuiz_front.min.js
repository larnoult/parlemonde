!function(i,e){function t(){if(!r){r=!0;for(var i=0;i<n.length;i++)n[i].fn.call(window,n[i].ctx);n=[]}}function o(){"complete"===document.readyState&&t()}i=i||"wpProQuizReady",e=e||window;var n=[],r=!1,s=!1;e[i]=function(i,e){return r?void setTimeout(function(){i(e)},1):(n.push({fn:i,ctx:e}),void("complete"===document.readyState?setTimeout(t,1):s||(document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):(document.attachEvent("onreadystatechange",o),window.attachEvent("onload",t)),s=!0)))}}("wpProQuizReady",window),wpProQuizReady(function(){for(var i=window.wpProQuizInitList||[],e=0;e<i.length;e++)jQuery(i[e].id).wpProQuizFront(i[e].init)}),function(i){i.wpProQuizFront=function(e,t){function o(){var i=0,e=-1,t=0,o=!1;this.questionStart=function(t){-1!=e&&this.questionStop(),e=t,i=+new Date},this.questionStop=function(){-1!=e&&(a[e].time+=Math.round((new Date-i)/1e3),e=-1)},this.startQuiz=function(){o&&this.stopQuiz(),t=+new Date,o=!0},this.stopQuiz=function(){o&&(a.comp.quizTime+=Math.round((new Date-t)/1e3),o=!1)},this.init=function(){}}var n=i(e),r=t,s=this,a=new Object,u=new Object,d=0,c=null,p=[],l="",h=!1,f=1,m={randomAnswer:0,randomQuestion:0,disabledAnswerMark:0,checkBeforeStart:0,preview:0,cors:0,isAddAutomatic:0,quizSummeryHide:0,skipButton:0,reviewQustion:0,autoStart:0,forcingQuestionSolve:0,hideQuestionPositionOverview:0,formActivated:0,maxShowQuestion:0,sortCategories:0},w={isQuizStart:0,isLocked:0,loadLock:0,isPrerequisite:0,isUserStartLocked:0},Q={check:'input[name="check"]',next:'input[name="next"]',questionList:".wpProQuiz_questionList",skip:'input[name="skip"]',singlePageLeft:'input[name="wpProQuiz_pageLeft"]',singlePageRight:'input[name="wpProQuiz_pageRight"]'},v={back:n.find('input[name="back"]'),next:n.find(Q.next),quiz:n.find(".wpProQuiz_quiz"),questionList:n.find(".wpProQuiz_list"),results:n.find(".wpProQuiz_results"),quizStartPage:n.find(".wpProQuiz_text"),timelimit:n.find(".wpProQuiz_time_limit"),toplistShowInButton:n.find(".wpProQuiz_toplistShowInButton"),listItems:i()},z={token:"",isUser:0},_={START:0,END:1},P=function(){var i=r.timelimit,e=0,t={};return t.stop=function(){i&&(window.clearInterval(e),v.timelimit.hide())},t.start=function(){if(i){var o=1e3*i,n=v.timelimit.find("span").text(s.methode.parseTime(i)),r=v.timelimit.find(".wpProQuiz_progress");v.timelimit.show();var a=+new Date;e=window.setInterval(function(){var i=+new Date-a,e=o-i;i>=500&&n.text(s.methode.parseTime(Math.ceil(e/1e3))),r.css("width",e/o*100+"%"),0>=e&&(t.stop(),s.methode.finishQuiz(!0))},16)}},t}(),g=new function(){function e(i){var e=c.eq(i),t=e.offset().top,o=a.offset().top,n=t-o;if(0>n-4||n+32>100){var r=o-c.eq(0).offset().top-(o-d.offset().top)+e.position().top;r>w&&(r=w);var s=r/h;d.attr("style","margin-top: "+-r+"px !important"),u.css({top:s})}}function t(i){var e="",t=Q[i];t.review?e="#FFB800":t.solved&&(e="#6CA54C"),c.eq(i).css("background-color",e)}function o(i){i.preventDefault();var e=i.pageY-l;0>e&&(e=0),e>p&&(e=p);var t=h*e;d.attr("style","margin-top: "+-t+"px !important"),u.css({top:e})}function r(e){e.preventDefault(),i(document).unbind(".scrollEvent")}var a=[],u=[],d=[],c=[],p=0,l=0,h=0,f=0,w=0,Q=[];this.init=function(){a=n.find(".wpProQuiz_reviewQuestion"),u=a.find("div"),d=a.find("ol"),c=d.children(),u.mousedown(function(e){e.preventDefault(),e.stopPropagation(),l=e.pageY-u.offset().top+f,i(document).bind("mouseup.scrollEvent",r),i(document).bind("mousemove.scrollEvent",o)}),c.click(function(e){s.methode.showQuestion(i(this).index())}),n.bind("questionSolved",function(i){Q[i.values.index].solved=i.values.solved,t(i.values.index)}),n.bind("changeQuestion",function(i){c.removeClass("wpProQuiz_reviewQuestionTarget"),c.eq(i.values.index).addClass("wpProQuiz_reviewQuestionTarget"),e(i.values.index)}),n.bind("reviewQuestion",function(i){Q[i.values.index].review=!Q[i.values.index].review,t(i.values.index)}),a.bind("mousewheel DOMMouseScroll",function(i){i.preventDefault();var e=i.originalEvent,t=e.wheelDelta?-e.wheelDelta/120:e.detail/3,o=20*t,n=f-d.offset().top+o;n>w&&(n=w),0>n&&(n=0);var r=n/h;return d.attr("style","margin-top: "+-n+"px !important"),u.css({top:r}),!1})},this.show=function(i){if(m.reviewQustion&&a.parent().show(),n.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").show(),!i){d.attr("style","margin-top: 0px !important"),u.css({top:0});var e=d.outerHeight(),t=a.height();p=t-u.height(),l=0,w=e-t,h=w/p,this.reset(),e>100&&u.show(),f=u.offset().top}},this.hide=function(){a.parent().hide()},this.toggle=function(){if(m.reviewQustion){a.parent().toggle(),c.removeClass("wpProQuiz_reviewQuestionTarget"),n.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").hide(),d.attr("style","margin-top: 0px !important"),u.css({top:0});var i=d.outerHeight(),e=a.height();p=e-u.height(),l=0,w=i-e,h=w/p,i>100&&u.show(),f=u.offset().top}},this.reset=function(){for(var i=0,e=c.length;e>i;i++)Q[i]={};c.removeClass("wpProQuiz_reviewQuestionTarget").css("background-color","")}},q=new o,x=function(e,t,o,n){var r=!0,a=0,u=i.isArray(t.points),d={},c={singleMulti:function(){var e=n.find(".wpProQuiz_questionInput").attr("disabled","disabled"),o=t.diffMode;n.children().each(function(n){var d=i(this),c=d.data("pos"),p=e.eq(n).is(":checked");t.correct[c]?(p?u&&(o?a=t.points[c]:a+=t.points[c]):r=!1,t.disCorrect?r=!0:s.methode.marker(d,!0)):p?(t.disCorrect?r=!0:(s.methode.marker(d,!1),r=!1),o&&(a=t.points[c])):u&&!o&&(a+=t.points[c])})},sort_answer:function(){var e=n.children();e.each(function(e,o){var n=i(this);d[e]=n.data("pos"),e==n.data("pos")?(s.methode.marker(n,!0),u&&(a+=t.points[e])):(s.methode.marker(n,!1),r=!1)}),e.children().css({"box-shadow":"0 0",cursor:"auto"}),n.sortable("destroy"),e.sort(function(e,t){return i(e).data("pos")>i(t).data("pos")?1:-1}),n.append(e)},matrix_sort_answer:function(){var e=n.children(),c=new Array;d={0:-1},e.each(function(){var e=i(this),o=e.data("pos"),n=e.find(".wpProQuiz_maxtrixSortCriterion"),p=n.children();p.length&&(d[o]=p.data("pos")),p.length&&i.inArray(String(o),String(p.data("correct")).split(","))>=0?(s.methode.marker(n,!0),u&&(a+=t.points[o])):(r=!1,s.methode.marker(n,!1)),c[o]=n}),s.methode.resetMatrix(o),o.find(".wpProQuiz_sortStringItem").each(function(){var e=c[i(this).data("pos")];void 0!=e&&e.append(this)}).css({"box-shadow":"0 0",cursor:"auto"}),o.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("destroy")},free_answer:function(){var e=n.children(),o=e.find(".wpProQuiz_questionInput").attr("disabled","disabled").val();i.inArray(i.trim(o).toLowerCase(),t.correct)>=0?s.methode.marker(e,!0):(s.methode.marker(e,!1),r=!1)},cloze_answer:function(){n.find(".wpProQuiz_cloze").each(function(e,o){var n=i(this),d=n.children(),c=d.eq(0),p=d.eq(1),l=s.methode.cleanupCurlyQuotes(c.val());i.inArray(l,t.correct[e])>=0?(u&&(a+=t.points[e]),m.disabledAnswerMark||c.css("background-color","#B0DAB0")):(m.disabledAnswerMark||c.css("background-color","#FFBABA"),r=!1,p.show()),c.attr("disabled","disabled")})},assessment_answer:function(){r=!0;var e=n.find(".wpProQuiz_questionInput").attr("disabled","disabled"),t=0;e.filter(":checked").each(function(){t+=parseInt(i(this).val())}),a=t}};return c[e](),!u&&r&&(a=t.points),{c:r,p:a,s:d}},k=new function(){var e={isEmpty:function(e){return e=i.trim(e),!e||0===e.length}},t={TEXT:0,TEXTAREA:1,NUMBER:2,CHECKBOX:3,EMAIL:4,YES_NO:5,DATE:6,SELECT:7,RADIO:8};this.checkForm=function(){var o=!0;return n.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var n=i(this),r=1==n.data("required"),s=n.data("type"),a=!0,u=i.trim(n.val());switch(s){case t.TEXT:case t.TEXTAREA:case t.SELECT:r&&(a=!e.isEmpty(u));break;case t.NUMBER:(r||!e.isEmpty(u))&&(a=!e.isEmpty(u)&&!isNaN(u));break;case t.EMAIL:(r||!e.isEmpty(u))&&(a=!e.isEmpty(u)&&new RegExp(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/).test(u));break;case t.CHECKBOX:r&&(a=n.is(":checked"));break;case t.YES_NO:case t.RADIO:r&&(a=void 0!==n.find('input[type="radio"]:checked').val());break;case t.DATE:var d=0,c=0;n.find("select").each(function(){d++,c+=e.isEmpty(i(this).val())?0:1}),(r||c>0)&&(a=d==c)}a?n.siblings(".wpProQuiz_invalidate").hide():(o=!1,n.siblings(".wpProQuiz_invalidate").show())}),o},this.getFormData=function(){var e={};return n.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var o=i(this),n=o.data("form_id"),r=o.data("type");switch(r){case t.TEXT:case t.TEXTAREA:case t.SELECT:case t.NUMBER:case t.EMAIL:e[n]=o.val();break;case t.CHECKBOX:e[n]=o.is(":checked")?1:0;break;case t.YES_NO:case t.RADIO:e[n]=o.find('input[type="radio"]:checked').val();break;case t.DATE:e[n]={day:o.find('select[name="wpProQuiz_field_'+n+'_day"]').val(),month:o.find('select[name="wpProQuiz_field_'+n+'_month"]').val(),year:o.find('select[name="wpProQuiz_field_'+n+'_year"]').val()}}}),e}},S=function(e){n.find(".wpProQuiz_questionList").each(function(){var t=i(this),o=t.data("question_id"),n=t.data("type"),r={};if("single"==n||"multiple"==n)t.find(".wpProQuiz_questionListItem").each(function(){r[i(this).data("pos")]=+i(this).find(".wpProQuiz_questionInput").is(":checked")});else if("free_answer"==n)r[0]=t.find(".wpProQuiz_questionInput").val();else{if("sort_answer"==n)return!0;if("matrix_sort_answer"==n)return!0;if("cloze_answer"==n){var s=0;t.find(".wpProQuiz_cloze input").each(function(){r[s++]=i(this).val()})}else"assessment_answer"==n&&(r[0]="",t.find(".wpProQuiz_questionInput:checked").each(function(){r[i(this).data("index")]=i(this).val()}))}e[o].data=r})};s.methode={parseBitOptions:function(){if(r.bo){m.randomAnswer=1&r.bo,m.randomQuestion=2&r.bo,m.disabledAnswerMark=4&r.bo,m.checkBeforeStart=8&r.bo,m.preview=16&r.bo,m.isAddAutomatic=64&r.bo,m.reviewQustion=128&r.bo,m.quizSummeryHide=256&r.bo,m.skipButton=512&r.bo,m.autoStart=1024&r.bo,m.forcingQuestionSolve=2048&r.bo,m.hideQuestionPositionOverview=4096&r.bo,m.formActivated=8192&r.bo,m.maxShowQuestion=16384&r.bo,m.sortCategories=32768&r.bo;var i=32&r.bo;i&&void 0!=jQuery.support&&void 0!=jQuery.support.cors&&0==jQuery.support.cors&&(m.cors=i)}},setClozeStyle:function(){n.find(".wpProQuiz_cloze input").each(function(){for(var e=i(this),t="",o=e.data("wordlen"),n=0;o>n;n++)t+="w";var r=i(document.createElement("span")).css("visibility","hidden").text(t).appendTo(i("body")),s=r.width();r.remove(),e.width(s+5)})},parseTime:function(i){var e=parseInt(i%60),t=parseInt(i/60%60),o=parseInt(i/3600%24);return e=(e>9?"":"0")+e,t=(t>9?"":"0")+t,o=(o>9?"":"0")+o,o+":"+t+":"+e},cleanupCurlyQuotes:function(e){return e=e.replace(/\u2018/,"'"),e=e.replace(/\u2019/,"'"),e=e.replace(/\u201C/,'"'),e=e.replace(/\u201D/,'"'),i.trim(e).toLowerCase()},resetMatrix:function(e){e.each(function(){var e=i(this),t=e.find(".wpProQuiz_sortStringList");e.find(".wpProQuiz_sortStringItem").each(function(){t.append(i(this))})})},marker:function(i,e){m.disabledAnswerMark||(e?i.addClass("wpProQuiz_answerCorrect"):i.addClass("wpProQuiz_answerIncorrect"))},startQuiz:function(e){if(w.loadLock)return void(w.isQuizStart=1);if(w.isQuizStart=0,w.isLocked)return v.quizStartPage.hide(),void n.find(".wpProQuiz_lock").show();if(w.isPrerequisite)return v.quizStartPage.hide(),void n.find(".wpProQuiz_prerequisite").show();if(w.isUserStartLocked)return v.quizStartPage.hide(),void n.find(".wpProQuiz_startOnlyRegisteredUser").show();if(m.maxShowQuestion&&!e)return v.quizStartPage.hide(),n.find(".wpProQuiz_loadQuiz").show(),void s.methode.loadQuizDataAjax(!0);if(!m.formActivated||r.formPos!=_.START||k.checkForm()){switch(s.methode.loadQuizData(),m.randomQuestion&&s.methode.random(v.questionList),m.randomAnswer&&s.methode.random(n.find(Q.questionList)),m.sortCategories&&s.methode.sortCategories(),s.methode.random(n.find(".wpProQuiz_sortStringList")),s.methode.random(n.find('[data-type="sort_answer"]')),n.find(".wpProQuiz_listItem").each(function(e,t){var o=i(this);o.find(".wpProQuiz_question_page span:eq(0)").text(e+1),o.find("> h5 span").text(e+1),o.find(".wpProQuiz_questionListItem").each(function(e,t){i(this).find("> span:not(.wpProQuiz_cloze)").text(e+1+". ")})}),v.next=n.find(Q.next),r.mode){case 3:n.find('input[name="checkSingle"]').show();break;case 2:n.find(Q.check).show(),!m.skipButton&&m.reviewQustion&&n.find(Q.skip).show();break;case 1:n.find('input[name="back"]').slice(1).show();case 0:v.next.show()}(m.hideQuestionPositionOverview||3==r.mode)&&n.find(".wpProQuiz_question_page").hide();var o=v.next.last();l=o.val(),o.val(r.lbn);var h=v.questionList.children();if(v.listItems=n.find(".wpProQuiz_list > li"),3==r.mode)s.methode.showSinglePage(0);else{c=h.eq(0).show();var f=c.find(Q.questionList).data("question_id");q.questionStart(f)}q.startQuiz(),n.find(".wpProQuiz_sortable").parents("ul").sortable({update:function(e,t){var o=i(this).parents(".wpProQuiz_listItem");n.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),n.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable({connectWith:".wpProQuiz_maxtrixSortCriterion:not(:has(li)), .wpProQuiz_sortStringList",placeholder:"wpProQuiz_placehold",update:function(e,t){var o=i(this).parents(".wpProQuiz_listItem");n.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),p=[],P.start(),d=+new Date,a={comp:{points:0,correctQuestions:0,quizTime:0}},n.find(".wpProQuiz_questionList").each(function(){var e=i(this).data("question_id");a[e]={time:0,solved:0}}),u={},i.each(t.catPoints,function(i,e){u[i]=0}),v.quizStartPage.hide(),n.find(".wpProQuiz_loadQuiz").hide(),v.quiz.show(),g.show(),3!=r.mode&&n.trigger({type:"changeQuestion",values:{item:c,index:c.index()}})}},showSingleQuestion:function(i){var e=i?Math.ceil(i/r.qpp):1;this.showSinglePage(e)},showSinglePage:function(i){if($listItem=v.questionList.children().hide(),!r.qpp)return void $listItem.show();i=i?+i:1;var e=Math.ceil(n.find(".wpProQuiz_list > li").length/r.qpp);if(!(i>e)){var t=n.find(Q.singlePageLeft).hide(),o=n.find(Q.singlePageRight).hide(),a=n.find('input[name="checkSingle"]').hide();i>1&&t.val(t.data("text").replace(/%d/,i-1)).show(),i==e?a.show():o.val(o.data("text").replace(/%d/,i+1)).show(),f=i;var u=r.qpp*(i-1);$listItem.slice(u,u+r.qpp).show(),s.methode.scrollTo(v.quiz)}},nextQuestion:function(){this.showQuestionObject(c.next())},prevQuestion:function(){this.showQuestionObject(c.prev())},showQuestion:function(i){var e=v.listItems.eq(i);return 3==r.mode||h?(r.qpp&&s.methode.showSingleQuestion(i+1),s.methode.scrollTo(e,1),void q.startQuiz()):void this.showQuestionObject(e)},showQuestionObject:function(i){if(!i.length&&m.forcingQuestionSolve&&m.quizSummeryHide&&m.reviewQustion)for(var e=0,t=n.find(".wpProQuiz_listItem").length;t>e;e++)if(!p[e])return alert(WpProQuizGlobal.questionsNotSolved),!1;if(c.hide(),c=i.show(),s.methode.scrollTo(v.quiz),n.trigger({type:"changeQuestion",values:{item:c,index:c.index()}}),c.length){var o=c.find(Q.questionList).data("question_id");q.questionStart(o)}else s.methode.showQuizSummary()},skipQuestion:function(){n.trigger({type:"skipQuestion",values:{item:c,index:c.index()}}),s.methode.nextQuestion()},reviewQuestion:function(){n.trigger({type:"reviewQuestion",values:{item:c,index:c.index()}})},showQuizSummary:function(){if(q.questionStop(),q.stopQuiz(),m.quizSummeryHide||!m.reviewQustion)return void(m.formActivated&&r.formPos==_.END?(g.hide(),v.quiz.hide(),s.methode.scrollTo(n.find(".wpProQuiz_infopage").show())):s.methode.finishQuiz());var e=n.find(".wpProQuiz_checkPage");e.find("ol:eq(0)").empty().append(n.find(".wpProQuiz_reviewQuestion ol li").clone().removeClass("wpProQuiz_reviewQuestionTarget")).children().click(function(t){e.hide(),v.quiz.show(),g.show(!0),s.methode.showQuestion(i(this).index())});for(var t=0,o=0,a=p.length;a>o;o++)p[o]&&t++;e.find("span:eq(0)").text(t),g.hide(),v.quiz.hide(),e.show(),s.methode.scrollTo(e)},finishQuiz:function(e){q.questionStop(),q.stopQuiz(),P.stop();var t=(+new Date-d)/1e3;t=r.timelimit&&t>r.timelimit?r.timelimit:t,n.find(".wpProQuiz_quiz_time span").text(s.methode.parseTime(t)),e&&v.results.find(".wpProQuiz_time_limit_expired").show(),s.methode.checkQuestion(v.questionList.children(),!0),n.find(".wpProQuiz_correct_answer").text(a.comp.correctQuestions),a.comp.result=Math.round(a.comp.points/r.globalPoints*100*100)/100,a.comp.solved=0;var o=n.find(".wpProQuiz_points span");o.eq(0).text(a.comp.points),o.eq(1).text(r.globalPoints),o.eq(2).text(a.comp.result+"%");var u=n.find(".wpProQuiz_resultsList > li").eq(s.methode.findResultIndex(a.comp.result)),c=k.getFormData();u.find(".wpProQuiz_resultForm").each(function(){var e=i(this),t=e.data("form_id"),o=c[t];"object"==typeof o&&(o=o.day+"-"+o.month+"-"+o.year),e.text(o).show()}),u.show(),s.methode.setAverageResult(a.comp.result,!1),this.setCategoryOverview(),s.methode.sendCompletedQuiz(),m.isAddAutomatic&&z.isUser&&s.methode.addToplist(),g.hide(),n.find(".wpProQuiz_checkPage, .wpProQuiz_infopage").hide(),v.quiz.hide(),v.results.show(),s.methode.scrollTo(v.results)},setCategoryOverview:function(){a.comp.cats={},n.find(".wpProQuiz_catOverview li").each(function(){var e=i(this),t=e.data("category_id");if(void 0===r.catPoints[t])return e.hide(),!0;var o=Math.round(u[t]/r.catPoints[t]*100*100)/100;a.comp.cats[t]=o,e.find(".wpProQuiz_catPercent").text(o+"%"),e.show()})},questionSolved:function(i){p[i.values.index]=i.values.solved;var e=i.values.item.find(Q.questionList),t=r.json[e.data("question_id")];a[t.id].solved=Number(i.values.fake?a[t.id].solved:i.values.solved)},sendCompletedQuiz:function(){if(!m.preview){S(a);var i=k.getFormData();s.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"completedQuiz",data:{quizId:r.quizId,results:a,forms:i}})}},findResultIndex:function(i){for(var e=r.resultsGrade,t=-1,o=999999,n=0;n<e.length;n++){var s=e[n];i>=s&&o>i-s&&(o=i-s,t=n)}return t},showQustionList:function(){h=!h,v.toplistShowInButton.hide(),v.quiz.toggle(),n.find(".wpProQuiz_QuestionButton").hide(),v.questionList.children().show(),g.toggle(),n.find(".wpProQuiz_question_page").hide()},random:function(e){e.each(function(){var e=i(this).children().get().sort(function(){return Math.round(Math.random())-.5});i(e).appendTo(e[0].parentNode)})},sortCategories:function(){var e=i(".wpProQuiz_list").children().get().sort(function(e,t){var o=i(e).find(".wpProQuiz_questionList").data("question_id"),n=i(t).find(".wpProQuiz_questionList").data("question_id");return r.json[o].catId-r.json[n].catId});i(e).appendTo(e[0].parentNode)},restartQuiz:function(){v.results.hide(),v.quizStartPage.show(),v.questionList.children().hide(),v.toplistShowInButton.hide(),g.hide(),n.find(".wpProQuiz_questionInput, .wpProQuiz_cloze input").removeAttr("disabled").removeAttr("checked").css("background-color",""),n.find('.wpProQuiz_questionListItem input[type="text"]').val(""),n.find(".wpProQuiz_answerCorrect, .wpProQuiz_answerIncorrect").removeClass("wpProQuiz_answerCorrect wpProQuiz_answerIncorrect"),n.find(".wpProQuiz_listItem").data("check",!1),n.find(".wpProQuiz_response").hide().children().hide(),s.methode.resetMatrix(n.find(".wpProQuiz_listItem")),n.find(".wpProQuiz_sortStringItem, .wpProQuiz_sortable").removeAttr("style"),n.find(".wpProQuiz_clozeCorrect, .wpProQuiz_QuestionButton, .wpProQuiz_resultsList > li").hide(),n.find('.wpProQuiz_question_page, input[name="tip"]').show(),n.find(".wpProQuiz_resultForm").text("").hide(),v.results.find(".wpProQuiz_time_limit_expired").hide(),v.next.last().val(l),h=!1},checkQuestion:function(e,t){e=void 0==e?c:e,e.each(function(){var e=i(this),o=e.find(Q.questionList),s=r.json[o.data("question_id")],d=s.type;if(q.questionStop(),e.data("check"))return!0;("single"==s.type||"multiple"==s.type)&&(d="singleMulti");var c=x(d,s,e,o);e.find(".wpProQuiz_response").show(),e.find(Q.check).hide(),e.find(Q.skip).hide(),e.find(Q.next).show(),a[s.id].points=c.p,a[s.id].correct=Number(c.c),a[s.id].data=c.s,a.comp.points+=c.p,u[s.catId]+=c.p,c.c?(e.find(".wpProQuiz_correct").show(),a.comp.correctQuestions+=1):e.find(".wpProQuiz_incorrect").show(),e.find(".wpProQuiz_responsePoints").text(c.p),e.data("check",!0),t||n.trigger({type:"questionSolved",values:{item:e,index:e.index(),solved:!0,fake:!0}})})},showTip:function(){var e=i(this),t=e.siblings(".wpProQuiz_question").find(Q.questionList).data("question_id");e.siblings(".wpProQuiz_tipp").toggle("fast"),a[t].tip=1,i(document).bind("mouseup.tipEvent",function(e){var t=n.find(".wpProQuiz_tipp"),o=n.find('input[name="tip"]');t.is(e.target)||0!=t.has(e.target).length||o.is(e.target)||(t.hide("fast"),i(document).unbind(".tipEvent"))})},ajax:function(e,t,o){o=o||"json",m.cors&&(jQuery.support.cors=!0),i.post(WpProQuizGlobal.ajaxurl,e,t,o),m.cors&&(jQuery.support.cors=!1)},checkQuizLock:function(){w.loadLock=1,s.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizCheckLock",data:{quizId:r.quizId}},function(i){void 0!=i.lock&&(w.isLocked=i.lock.is,i.lock.pre&&n.find('input[name="restartQuiz"]').hide()),void 0!=i.prerequisite&&(w.isPrerequisite=1,n.find(".wpProQuiz_prerequisite span").text(i.prerequisite)),void 0!=i.startUserLock&&(w.isUserStartLocked=i.startUserLock),w.loadLock=0,w.isQuizStart&&s.methode.startQuiz()})},loadQuizData:function(){s.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"loadQuizData",data:{quizId:r.quizId}},function(i){i.toplist&&s.methode.handleToplistData(i.toplist),void 0!=i.averageResult&&s.methode.setAverageResult(i.averageResult,!0)})},setAverageResult:function(i,e){var t=n.find(".wpProQuiz_resultValue:eq("+(e?0:1)+") > * ");t.eq(1).text(i+"%"),t.eq(0).css("width",240*i/100+"px")},handleToplistData:function(i){var e=n.find(".wpProQuiz_addToplist"),t=e.find(".wpProQuiz_addBox").show().children("div");if(i.canAdd)if(e.show(),e.find(".wpProQuiz_addToplistMessage").hide(),e.find(".wpProQuiz_toplistButton").show(),z.token=i.token,z.isUser=0,i.userId)t.hide(),z.isUser=1,m.isAddAutomatic&&e.hide();else{t.show();var o=t.children().eq(1);i.captcha?(o.find('input[name="wpProQuiz_captchaPrefix"]').val(i.captcha.code),o.find(".wpProQuiz_captchaImg").attr("src",i.captcha.img),o.find('input[name="wpProQuiz_captcha"]').val(""),o.show()):o.hide()}else e.hide()},scrollTo:function(e,t){var o=e.offset().top-100;(t||(window.pageYOffset||document.body.scrollTop)>o)&&i("html,body").animate({scrollTop:o},300)},addToplist:function(){if(!m.preview){var i=n.find(".wpProQuiz_addToplistMessage").text(WpProQuizGlobal.loadData).show(),e=n.find(".wpProQuiz_addBox").hide();s.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"addInToplist",data:{quizId:r.quizId,token:z.token,name:e.find('input[name="wpProQuiz_toplistName"]').val(),email:e.find('input[name="wpProQuiz_toplistEmail"]').val(),captcha:e.find('input[name="wpProQuiz_captcha"]').val(),prefix:e.find('input[name="wpProQuiz_captchaPrefix"]').val(),points:a.comp.points,totalPoints:r.globalPoints}},function(t){i.text(t.text),t.clear?(e.hide(),s.methode.updateToplist()):e.show(),t.captcha&&(e.find(".wpProQuiz_captchaImg").attr("src",t.captcha.img),e.find('input[name="wpProQuiz_captchaPrefix"]').val(t.captcha.code),e.find('input[name="wpProQuiz_captcha"]').val(""))})}},updateToplist:function(){"function"==typeof wpProQuiz_fetchToplist&&wpProQuiz_fetchToplist()},registerSolved:function(){n.find('.wpProQuiz_questionInput[type="text"]').change(function(e){var t=i(this),o=t.parents(".wpProQuiz_listItem"),r=!1;""!=t.val()&&(r=!0),n.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:r}})}),n.find('.wpProQuiz_questionList[data-type="single"] .wpProQuiz_questionInput, .wpProQuiz_questionList[data-type="assessment_answer"] .wpProQuiz_questionInput').change(function(e){var t=i(this),o=t.parents(".wpProQuiz_listItem"),r=this.checked;n.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:r}})}),n.find(".wpProQuiz_cloze input").change(function(){var e=i(this),t=e.parents(".wpProQuiz_listItem"),o=!0;t.find(".wpProQuiz_cloze input").each(function(){return""==i(this).val()?(o=!1,!1):void 0}),n.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:o}})}),n.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').change(function(e){var t=i(this),o=t.parents(".wpProQuiz_listItem"),r=0;o.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').each(function(i){this.checked&&r++}),n.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:r?!0:!1}})})},loadQuizDataAjax:function(e){s.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizLoadData",data:{quizId:r.quizId}},function(t){r.globalPoints=t.globalPoints,r.catPoints=t.catPoints,r.json=t.json,v.quiz.remove(),n.find(".wpProQuiz_quizAnker").after(t.content),v={back:n.find('input[name="back"]'),next:n.find(Q.next),quiz:n.find(".wpProQuiz_quiz"),questionList:n.find(".wpProQuiz_list"),results:n.find(".wpProQuiz_results"),quizStartPage:n.find(".wpProQuiz_text"),timelimit:n.find(".wpProQuiz_time_limit"),toplistShowInButton:n.find(".wpProQuiz_toplistShowInButton"),listItems:i()},s.methode.initQuiz(),e&&s.methode.startQuiz(!0)})},initQuiz:function(){s.methode.setClozeStyle(),s.methode.registerSolved(),v.next.click(function(){return!m.forcingQuestionSolve||p[c.index()]||!m.quizSummeryHide&&m.reviewQustion?void s.methode.nextQuestion():(alert(WpProQuizGlobal.questionNotSolved),!1)}),v.back.click(function(){s.methode.prevQuestion()}),n.find(Q.check).click(function(){return!m.forcingQuestionSolve||p[c.index()]||!m.quizSummeryHide&&m.reviewQustion?void s.methode.checkQuestion():(alert(WpProQuizGlobal.questionNotSolved),!1)}),n.find('input[name="checkSingle"]').click(function(){if(m.forcingQuestionSolve&&(m.quizSummeryHide||!m.reviewQustion))for(var i=0,e=n.find(".wpProQuiz_listItem").length;e>i;i++)if(!p[i])return alert(WpProQuizGlobal.questionsNotSolved),!1;s.methode.showQuizSummary()}),n.find('input[name="tip"]').click(s.methode.showTip),n.find('input[name="skip"]').click(s.methode.skipQuestion),n.find('input[name="wpProQuiz_pageLeft"]').click(function(){s.methode.showSinglePage(f-1)}),n.find('input[name="wpProQuiz_pageRight"]').click(function(){s.methode.showSinglePage(f+1)})}},s.preInit=function(){s.methode.parseBitOptions(),g.init(),n.find('input[name="startQuiz"]').click(function(){return s.methode.startQuiz(),!1}),m.checkBeforeStart&&!m.preview&&s.methode.checkQuizLock(),n.find('input[name="reShowQuestion"]').click(function(){s.methode.showQustionList()}),n.find('input[name="restartQuiz"]').click(function(){s.methode.restartQuiz()}),n.find('input[name="review"]').click(s.methode.reviewQuestion),n.find('input[name="wpProQuiz_toplistAdd"]').click(s.methode.addToplist),n.find('input[name="quizSummary"]').click(s.methode.showQuizSummary),n.find('input[name="endQuizSummary"]').click(function(){if(m.forcingQuestionSolve)for(var i=0,e=n.find(".wpProQuiz_listItem").length;e>i;i++)if(!p[i])return alert(WpProQuizGlobal.questionsNotSolved),!1;(!m.formActivated||r.formPos!=_.END||k.checkForm())&&s.methode.finishQuiz()}),n.find('input[name="endInfopage"]').click(function(){k.checkForm()&&s.methode.finishQuiz()}),n.find('input[name="showToplist"]').click(function(){v.quiz.hide(),v.toplistShowInButton.toggle()}),n.bind("questionSolved",s.methode.questionSolved),m.maxShowQuestion||s.methode.initQuiz(),m.autoStart&&s.methode.startQuiz()},s.preInit()},i.fn.wpProQuizFront=function(e){return this.each(function(){void 0==i(this).data("wpProQuizFront")&&i(this).data("wpProQuizFront",new i.wpProQuizFront(this,e))})}}(jQuery);