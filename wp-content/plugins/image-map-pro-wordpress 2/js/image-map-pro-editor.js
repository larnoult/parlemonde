!function(t,e,o,i){function r(){this.wcpEditorSettings=i,this.actionStack=new Array,this.actionIndex=0,this.canvasImage=new Image,this.canvasWidth=0,this.canvasHeight=0,this.canvas=i,this.ix=0,this.iy=0,this.x=0,this.y=0,this.dx=0,this.dy=0,this.ixss=0,this.iyss=0,this.xss=0,this.yss=0,this.dxss=0,this.dyss=0,this.drawRectWidth=0,this.drawRectHeight=0,this.transformX=0,this.transformY=0,this.transformWidth=0,this.transformHeight=0,this.eventSpotId=i,this.redrawEl=i,this.redrawSvgEl=i,this.redrawPolygonEl=i,this.tempControlPoint=i,this.tempControlPointLine=i,this.tempControlPointIndex=i,this.controlPointInsertionPointX=0,this.controlPointInsertionPointY=0,this.translatedPointIndex=0,this.translatedPoint=i,this.translatedPointX=0,this.translatedPointY=0,this.polyPoints=new Array,this.canvasInitialX=0,this.canvasInitialY=0,this.startedSelecting=!1,this.startedMoving=!1,this.startedTransforming=!1,this.didTransforming=!1,this.transformDirection=0,this.startedDrawingSpot=!1,this.startedDrawingRect=!1,this.createdDrawingRect=!1,this.startedDrawingOval=!1,this.createdDrawingOval=!1,this.startedDrawingPoly=!1,this.drawingPoly=!1,this.finishedDrawingPoly=!1,this.mouseDownWhileDrawingPoly=!1,this.startedTranslatingControlPoint=!1,this.translatingControlPoint=!1,this.didDeleteControlPoint=!1,this.shouldDeselectShape=!1,this.ctrlKeyDown=!1,this.altKeyDown=!1,this.shiftKeyDown=!1,this.spaceKeyDown=!1,this.commandKeyDown=!1,this.draggingCanvas=!1,this.selectedSpot=i,this.eventSpot=i,this.shapesFormSpotIndex=i,this.iconsHTML=i,this.zoom=1,this.canvasX=0,this.canvasY=0}function n(e,o,r,n){e.complete&&e.naturalWidth!==i&&e.naturalHeight!==i?r():(o(),t(e).on("load",function(){t(e).off("load"),r()}),t(e).on("error",function(){t(e).off("error"),n()}))}function a(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function s(t,e,o){return{x:Math.round(1e3*(t-o.offset().left))/1e3,y:Math.round(1e3*(e-o.offset().top))/1e3}}function l(t,e){return{x:e.width*(t.x/100)+e.x,y:e.height*(t.y/100)+e.y}}function d(t,e){return{x:(t.x-e.x)/e.width*100,y:(t.y-e.y)/e.height*100}}function p(t,e){return t<0&&(t=0),t>100&&(t=100),e<0&&(e=0),e>100&&(e=100),{x:Math.round(1e3*t)/1e3,y:Math.round(1e3*e)/1e3}}function c(t,e){for(var o=t.x,i=t.y,r=!1,n=0,a=e.length-1;n<e.length;a=n++){var s=e[n][0],l=e[n][1],d=e[a][0],p=e[a][1],c=l>i!=p>i&&o<(d-s)*(i-l)/(p-l)+s;c&&(r=!r)}return r}function h(t,e){this.x=t,this.y=e}var g=i,u=i,_=!1,m=i,y=0,S=0,w=5,f=6,x=7,E="spot",b="oval",C="rect",F="poly",k="select",P="zoom-in",I="zoom-out",M="drag",H=32,D={id:1718,editor:{selected_shape:"spot-8364",tool:"poly"},general:{name:"Demo",shortcode:"image-map-demo",width:1280,height:776},spots:[{id:"spot-8364",title:"spot-8364",x:26,y:19.8,default_style:{icon_is_pin:1},mouseover_style:{icon_fill:"#ffcd00"},tooltip_style:{position:"left",auto_width:1},tooltip_content:{plain_text:"Mouseover the building below!",squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}}},{id:"poly-2893",title:"poly-2893",type:"poly",x:15.757,y:22.263,width:22.844,height:65.977,default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{width:450},tooltip_content:{content_type:"content-builder",squares_settings:{containers:[{id:"sq-container-359931",settings:{elements:[{settings:{name:"Heading",iconClass:"fa fa-header"},options:{heading:{text:"Content Builder for the Tooltips"}}},{settings:{name:"Image",iconClass:"fa fa-camera"},options:{layout:{column_span:{lg:{class:"col-lg-6"}}}}},{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:"Image Map Pro 3.0 comes with a fully featured content builder that allows you to add rich content to your tooltips. Images, video, buttons, responsive grid system - it has it all!"},layout:{column_span:{lg:{class:"col-lg-6"}}}}},{settings:{name:"Button",iconClass:"fa fa-link"},options:{button:{text:"Example Button!",display:"block"}}}]}}]}},points:[{x:2.8712844939993056,y:100},{x:3.536549668697936,y:95.06062700400813},{x:.8754889699034004,y:95.06062700400813},{x:0,y:47.12265849973005},{x:.7847960076976461,y:23.53692508155694},{x:3.9088248123944527,y:17.15586649440026},{x:12.222274912965194,y:15.76484496015944},{x:15.056281433779493,y:7.219083609526608},{x:19.502913861465178,y:6.533930832820084},{x:19.502913861465178,y:4.254220219285366},{x:26.155565608451525,y:1.9745096057506475},{x:33.47348253013651,y:.8346542989832882},{x:38.79560392772559,y:.4547025300608352},{x:44.78299050001331,y:0},{x:52.766172596396935,y:1.8997588446122655},{x:59.41882434338327,y:.7599035378449062},{x:64.49612815668326,y:2.2028938646528204},{x:70.93855610846484,y:3.267998410281798},{x:70.30788472285052,y:9.951430765378646},{x:85.60898374091914,y:7.900104410746106},{x:100,y:12.231141378913366},{x:99.33473482530137,y:71.50361733081603},{x:94.67787860241093,y:71.1236655618936},{x:94.67787860241093,y:73.02342440650584},{x:74.71992336145188,y:73.02342440650584},{x:74.71992336145188,y:99.62004823107758}],vs:[[210.09118541033433,684.7416413373859],[212.03647416413372,659.4528875379939],[204.25531914893617,659.4528875379939],[201.69531914893616,414.0186018237082],[203.99012564995655,293.2636383750531],[213.12503655683665,260.593698339942],[237.43423174842115,253.4719035012826],[245.72109422492397,209.7190516717325],[258.7234042553191,206.21118541033434],[258.7234042553191,194.53945288753798],[278.17629179331306,182.86772036474164],[299.57446808510633,177.03185410334345],[315.1367781155015,175.08656534954406],[332.64437689969606,172.75856534954406],[355.9878419452888,182.48500911854103],[375.44072948328267,176.64914285714283],[390.2871732522796,184.03700911854102],[409.12534954407295,189.49016413373857],[407.2812158054711,223.70820668693008],[452.0228571428571,213.20576291793313],[494.10334346504555,235.37993920972644],[492.15805471124617,538.8449848024316],[478.54103343465044,536.8996960486323],[478.54103343465044,546.6261398176291],[420.18237082066867,546.6261398176291],[420.18237082066867,682.7963525835867]]},{id:"poly-974",title:"poly-974",type:"poly",x:41.033,y:2.507,width:19.909,height:84.48,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:3.0534351145038165,y:91.98813056379822},{x:0,y:10.979228486646884},{x:11.450381679389313,y:7.71513353115727},{x:11.450381679389313,y:6.528189910979229},{x:3.0534351145038165,y:3.857566765578635},{x:29.00763358778626,y:0},{x:55.72519083969466,y:5.934718100890208},{x:60.30534351145038,y:5.341246290801187},{x:72.51908396946564,y:8.605341246290802},{x:73.2824427480916,y:9.792284866468842},{x:93.12977099236642,y:14.540059347181009},{x:93.12977099236642,y:28.18991097922849},{x:100,y:30.267062314540063},{x:98.47328244274809,y:100},{x:58.01526717557252,y:100},{x:57.25190839694656,y:91.3946587537092},{x:25.190839694656486,y:91.0979228486647},{x:25.190839694656486,y:89.31750741839762},{x:10.687022900763358,y:89.02077151335311},{x:10.687022900763358,y:90.80118694362018}],vs:[[533.0091185410333,622.4924012158053],[525.2279635258358,91.4285714285714],[554.4072948328267,70.0303951367781],[554.4072948328267,62.24924012158054],[533.0091185410333,44.741641337386014],[599.1489361702127,19.45288753799392],[667.2340425531914,58.358662613981764],[678.9057750759878,54.46808510638297],[710.030395136778,75.86626139817629],[711.9756838905774,83.64741641337383],[762.5531914893617,114.77203647416411],[762.5531914893617,204.25531914893614],[780.0607902735562,217.8723404255319],[776.1702127659574,675.0151975683889],[673.0699088145896,675.0151975683889],[671.1246200607902,618.6018237082064],[589.4224924012158,616.6565349544071],[589.4224924012158,604.9848024316108],[552.4620060790272,603.0395136778113],[552.4620060790272,614.7112462006078]]},{id:"poly-225",title:"poly-225",type:"poly",x:64.742,y:16.044,width:18.845,height:71.444,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:1.6129032258064515,y:92.28070175438596},{x:0,y:25.6140350877193},{x:2.4193548387096775,y:25.6140350877193},{x:2.4193548387096775,y:12.982456140350877},{x:15.32258064516129,y:11.578947368421053},{x:15.32258064516129,y:5.964912280701754},{x:31.451612903225808,y:4.912280701754386},{x:30.64516129032258,y:2.807017543859649},{x:54.03225806451613,y:1.7543859649122806},{x:54.83870967741935,y:3.1578947368421053},{x:77.41935483870968,y:0},{x:91.12903225806451,y:5.614035087719298},{x:91.93548387096774,y:21.75438596491228},{x:98.38709677419355,y:25.6140350877193},{x:100,y:81.05263157894737},{x:98.38709677419355,y:89.47368421052632},{x:86.29032258064517,y:89.47368421052632},{x:85.48387096774194,y:99.64912280701755},{x:3.225806451612903,y:100}],vs:[[832.5835866261398,636.1094224924011],[828.693009118541,266.5045592705167],[834.5288753799392,266.5045592705167],[834.5288753799392,196.47416413373858],[865.6534954407294,188.69300911854103],[865.6534954407294,157.56838905775075],[904.5592705167173,151.73252279635258],[902.6139817629179,140.06079027355622],[959.0273556231002,134.22492401215806],[960.9726443768997,142.0060790273556],[1015.4407294832827,124.4984802431611],[1048.5106382978722,155.62310030395136],[1050.4559270516718,245.1063829787234],[1066.018237082067,266.5045592705167],[1069.9088145896656,573.8601823708206],[1066.018237082067,620.547112462006],[1036.838905775076,620.547112462006],[1034.8936170212764,676.9604863221883],[836.4741641337386,678.9057750759878]]},{id:"poly-1879",title:"poly-1879",type:"poly",x:88.146,y:53.144,width:11.854,height:35.095,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:5.128205128205128,y:99.28571428571429},{x:3.8461538461538463,y:19.28571428571429},{x:0,y:13.571428571428571},{x:8.974358974358974,y:13.571428571428571},{x:10.256410256410255,y:10},{x:14.102564102564102,y:9.285714285714286},{x:15.384615384615385,y:5.714285714285714},{x:98.71794871794873,y:0},{x:100,y:100}],vs:[[1136.0486322188447,682.7963525835867],[1134.1033434650453,464.9240121580547],[1128.267477203647,449.36170212765956],[1141.8844984802429,449.36170212765956],[1143.8297872340422,439.6352583586626],[1149.6656534954404,437.6899696048632],[1151.6109422492398,427.9635258358662],[1278.0547112462002,412.4012158054711],[1279.9999999999995,684.741641337386]]},{id:"poly-5080",title:"poly-5080",type:"poly",x:3.191,y:57.155,width:12.614,height:31.085,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:1.2048192771084338,y:100},{x:0,y:92.74193548387096},{x:13.253012048192772,y:90.32258064516128},{x:14.457831325301203,y:87.09677419354838},{x:28.915662650602407,y:87.09677419354838},{x:32.53012048192771,y:50},{x:38.55421686746988,y:41.12903225806452},{x:45.78313253012048,y:41.12903225806452},{x:44.57831325301205,y:20.967741935483872},{x:66.26506024096386,y:15.32258064516129},{x:67.46987951807229,y:2.4193548387096775},{x:83.13253012048193,y:0},{x:98.79518072289156,y:4.838709677419355},{x:100,y:99.19354838709677}],vs:[[42.796352583586625,684.741641337386],[40.85106382978723,667.2340425531914],[62.24924012158054,661.3981762917932],[64.19452887537993,653.6170212765958],[87.53799392097264,653.6170212765958],[93.37386018237082,564.1337386018237],[103.10030395136778,542.7355623100304],[114.77203647416414,542.7355623100304],[112.82674772036475,494.10334346504555],[147.8419452887538,480.48632218844983],[149.7872340425532,449.36170212765956],[175.07598784194528,443.5258358662614],[200.3647416413374,455.1975683890577],[202.31003039513678,682.7963525835866]]},{id:"poly-3579",title:"poly-3579",type:"poly",x:33.587,y:69.94,width:7.599,height:18.55,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:100,y:0},{x:0,y:9.45945945945946},{x:4,y:97.2972972972973},{x:84,y:100},{x:80,y:56.75675675675676},{x:100,y:52.702702702702695}],vs:[[527.1732522796352,542.7355623100303],[429.9088145896656,556.3525835866261],[433.7993920972644,682.7963525835866],[511.61094224924005,686.6869300911853],[507.7203647416413,624.4376899696048],[527.1732522796352,618.6018237082067]]},{id:"poly-919",title:"poly-919",type:"poly",x:39.666,y:77.711,width:12.918,height:10.278,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:96.47058823529412,y:100},{x:100,y:26.82926829268293},{x:50.588235294117645,y:17.073170731707318},{x:50.588235294117645,y:12.195121951219512},{x:44.70588235294118,y:0},{x:28.235294117647058,y:0},{x:27.058823529411764,y:14.634146341463413},{x:0,y:24.390243902439025},{x:1.1764705882352942,y:97.5609756097561}],vs:[[667.2340425531916,682.7963525835866],[673.0699088145897,624.4376899696048],[591.3677811550152,616.6565349544072],[591.3677811550152,612.7659574468084],[581.6413373860182,603.0395136778114],[554.4072948328268,603.0395136778114],[552.4620060790273,614.7112462006078],[507.72036474164133,622.4924012158053],[509.6656534954407,680.8510638297871]]},{id:"poly-9983",title:"poly-9983",type:"poly",x:60.334,y:73.951,width:4.863,height:14.038,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:15.625,y:0},{x:84.375,y:0},{x:96.875,y:10.714285714285714},{x:100,y:96.42857142857143},{x:0,y:100},{x:0,y:16.071428571428573}],vs:[[782.0060790273557,573.8601823708207],[824.8024316109422,573.8601823708207],[832.5835866261398,585.531914893617],[834.5288753799392,678.9057750759879],[772.2796352583587,682.7963525835867],[772.2796352583587,591.3677811550152]]},{id:"poly-9416",title:"poly-9416",type:"poly",x:80.699,y:74.202,width:8.055,height:13.787,actions:{mouseover:"no-action"},default_style:{fill:"#ffcd00",fill_opacity:0,use_icon:0,icon_svg_path:"",icon_svg_viewbox:"",icon_fill:"#2196f3"},mouseover_style:{fill:"#ffcd00",fill_opacity:.5112781954887218},tooltip_style:{auto_width:1},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}},points:[{x:0,y:98.18181818181819},{x:0,y:47.27272727272727},{x:30.188679245282955,y:41.81818181818181},{x:33.962264150943305,y:.029659090909091627},{x:84.90566037735844,y:0},{x:98.11320754716974,y:10.909090909090908},{x:100,y:100}],vs:[[1032.9483282674773,680.8510638297872],[1032.9483282674773,626.3829787234042],[1064.0729483282676,620.547112462006],[1067.9635258358662,575.8372036474163],[1120.48632218845,575.80547112462],[1134.1033434650458,587.4772036474163],[1136.0486322188451,682.7963525835866]]}]},W=i,V=t.imageMapProEditorDefaults,T=t.imageMapProShapeDefaults;t.imageMapProDefaultSettings=t.extend(!0,{},V),t.imageMapProDefaultSpotSettings=t.extend(!0,{},T),t.squaresExtendElementDefaults({defaultControls:{font:{text_color:{name:"Text Color",type:"color",default:"#ffffff"}}}}),t.wcpTourCoordinatesForTipForStep=function(e){return"Drawing Shapes"==e?{x:t("#wcp-editor-toolbar").offset().left,y:t("#wcp-editor-toolbar").offset().top+t("#wcp-editor-toolbar").height()/2}:"Customize Your Shapes"==e?{x:t('[data-wcp-main-tab-button-name="Shape"]').offset().left+20,y:t('[data-wcp-main-tab-button-name="Shape"]').offset().top+40}:"Edit and Delete Shapes"==e?{x:t("#wcp-editor-right").offset().left-20,y:t("#wcp-editor-right").offset().top+50}:"Use Icons"==e?{x:t('[data-wcp-form-tab-button-name="icon"]').offset().left+64,y:t('[data-wcp-form-tab-button-name="icon"]').offset().top+28}:"Tooltip Content Builder"==e?{x:t('[data-wcp-form-tab-button-name="tooltip_content"]').offset().left+64,y:t('[data-wcp-form-tab-button-name="tooltip_content"]').offset().top+28}:"Responsive &amp; Fullscreen Tooltips"==e?{x:t('[data-wcp-main-tab-button-name="Image Map"]').offset().left+150,y:t('[data-wcp-main-tab-button-name="Image Map"]').offset().top+40}:"Preview Mode"==e?{x:t("#wcp-editor-button-preview").offset().left+64,y:t("#wcp-editor-button-preview").offset().top+32}:"Save and Load"==e?{x:t("#wcp-editor-button-load").offset().left+64,y:t("#wcp-editor-button-load").offset().top+32}:"Publish"==e?{x:t("#wcp-editor-form-control-image_map_shortcode").offset().left+t("#wcp-editor-form-control-image_map_shortcode").outerWidth()+20,y:t("#wcp-editor-form-control-image_map_shortcode").offset().top+t("#wcp-editor-form-control-image_map_shortcode").outerHeight()/2}:"Import and Export"==e?{x:t('[data-wcp-editor-extra-main-button-name="export"]').offset().left+64,y:t('[data-wcp-editor-extra-main-button-name="export"]').offset().top+32}:"Code"==e?{x:t('[data-wcp-editor-extra-main-button-name="code"]').offset().left+64,y:t('[data-wcp-editor-extra-main-button-name="code"]').offset().top+32}:void 0},t.wcpTourCoordinatesForHighlightRect=function(e){return"Drawing Shapes"==e?{x:t("#wcp-editor-toolbar").offset().left,y:t("#wcp-editor-toolbar").offset().top,width:t("#wcp-editor-toolbar").outerWidth(),height:t("#wcp-editor-toolbar").outerHeight()}:"Customize Your Shapes"==e?{x:t('[data-wcp-main-tab-button-name="Shape"]').offset().left,y:t('[data-wcp-main-tab-button-name="Shape"]').offset().top,width:t('[data-wcp-main-tab-button-name="Shape"]').outerWidth(),height:t('[data-wcp-main-tab-button-name="Shape"]').outerHeight()}:"Edit and Delete Shapes"==e?{x:t("#wcp-editor-right").offset().left,y:t("#wcp-editor-right").offset().top,width:t("#wcp-editor-right").outerWidth(),height:t("#wcp-editor-right").outerHeight()}:"Use Icons"==e?{x:t('[data-wcp-form-tab-button-name="icon"]').offset().left,y:t('[data-wcp-form-tab-button-name="icon"]').offset().top,width:t('[data-wcp-form-tab-button-name="icon"]').outerWidth(),height:t('[data-wcp-form-tab-button-name="icon"]').outerHeight()}:"Tooltip Content Builder"==e?{x:t('[data-wcp-form-tab-button-name="tooltip_content"]').offset().left,y:t('[data-wcp-form-tab-button-name="tooltip_content"]').offset().top,width:t('[data-wcp-form-tab-button-name="tooltip_content"]').outerWidth(),height:t('[data-wcp-form-tab-button-name="tooltip_content"]').outerHeight()}:"Responsive &amp; Fullscreen Tooltips"==e?{x:t('[data-wcp-main-tab-button-name="Image Map"]').offset().left,y:t('[data-wcp-main-tab-button-name="Image Map"]').offset().top,width:t('[data-wcp-main-tab-button-name="Image Map"]').outerWidth(),height:t('[data-wcp-main-tab-button-name="Image Map"]').outerHeight()}:"Preview Mode"==e?{x:t("#wcp-editor-button-preview").offset().left,y:t("#wcp-editor-button-preview").offset().top,width:t("#wcp-editor-button-preview").outerWidth(),height:t("#wcp-editor-button-preview").outerHeight()}:"Save and Load"==e?{x:t("#wcp-editor-button-save").offset().left,y:t("#wcp-editor-button-save").offset().top,width:t("#wcp-editor-button-save").outerWidth()+t("#wcp-editor-button-load").outerWidth(),height:t("#wcp-editor-button-save").outerHeight()}:"Publish"==e?{x:t("#wcp-editor-form-control-image_map_shortcode").offset().left-10,y:t("#wcp-editor-form-control-image_map_shortcode").offset().top-10,width:t("#wcp-editor-form-control-image_map_shortcode").outerWidth()+20,height:t("#wcp-editor-form-control-image_map_shortcode").outerHeight()+20}:"Import and Export"==e?{x:t('[data-wcp-editor-extra-main-button-name="import"]').offset().left,y:t('[data-wcp-editor-extra-main-button-name="import"]').offset().top,width:t('[data-wcp-editor-extra-main-button-name="import"]').outerWidth()+t('[data-wcp-editor-extra-main-button-name="export"]').outerWidth(),height:t('[data-wcp-editor-extra-main-button-name="import"]').outerHeight()}:"Code"==e?{x:t('[data-wcp-editor-extra-main-button-name="code"]').offset().left,y:t('[data-wcp-editor-extra-main-button-name="code"]').offset().top,width:t('[data-wcp-editor-extra-main-button-name="code"]').outerWidth(),height:t('[data-wcp-editor-extra-main-button-name="code"]').outerHeight()}:void 0},t.wcpTourEventStarted=function(){W=u,u=D,g.shapesFormSpotIndex=-1,g.parseSettings(),g.redraw(),t.wcpEditorOpenMainTabWithName("Shape")},t.wcpTourEventFinished=function(){u=W,g.redraw()},t.wcpTourEventStepWillChange=function(e){"Publish"==e?t.wcpEditorOpenMainTabWithName("Image Map"):t.wcpEditorOpenMainTabWithName("Shape")},t.wcpEditorGetContentForTabWithName=function(e){return"Image Map"==e?t.wcpEditorGetHTMLForFormWithName("Image Map Settings"):"Shape"==e?t.wcpEditorGetHTMLForFormWithName("Shape Settings"):void 0},t.wcpEditorGetContentForCanvas=function(){return""},t.wcpEditorGetListItems=function(){for(var t=[],e=u.spots.length-1;e>=0;e--){var o=u.spots[e];t.push({id:o.id,title:o.title})}return t},t.wcpEditorGetSaves=function(e){t.imp_editor_storage_get_saves_list(function(t){for(var o=new Array,i=0;i<t.length;i++){var r={};r=t[i].name?{name:t[i].name,id:t[i].id}:{name:"Untitled",id:t[i].id},o.push(r)}e(o)})},t.wcpEditorGetExportJSON=function(){return JSON.stringify(g.getCompressedSettings())},t.wcpEditorEventFormUpdated=function(e,o){if("Image Map Settings"==e){var r=t.wcpEditorGetModelOfFormWithName(e);r.image.image_url&&r.image.image_url.length>0&&u.image.url!==r.image.image_url?(u.image.url=r.image.image_url,g.canvasImage.src=r.image.image_url,n(g.canvasImage,function(){t.wcpEditorPresentLoadingScreen("Loading Image...")},function(){g.canvas_events(),t.wcpEditorHideLoadingScreen(),u.general.width=g.canvasImage.naturalWidth,u.general.height=g.canvasImage.naturalHeight,u.general.naturalWidth=g.canvasImage.naturalWidth,u.general.naturalHeight=g.canvasImage.naturalHeight,t.wcpEditorSetControlValue("Image Map Settings","image_map_width",u.general.width),t.wcpEditorSetControlValue("Image Map Settings","image_map_height",u.general.height),t.wcpEditorUpdateForm("Image Map Settings"),g.redraw(),g.addAction()},function(){t.wcpEditorHideLoadingScreenWithMessage("Error Loading Image!",!0,!1)})):(u.general.name=r.general.image_map_name.trim(),r.general.image_map_shortcode&&(u.general.shortcode=r.general.image_map_shortcode.replace(/[\[\]']+/g,"").trim()),u.general.width=r.general.image_map_width,u.general.height=r.general.image_map_height,u.general.responsive=r.general.responsive,u.general.preserve_quality=r.general.preserve_quality,u.general.pageload_animation=r.general.pageload_animation,u.general.late_initialization=r.general.late_initialization,u.general.center_image_map=r.general.center_image_map,u.image.url=r.image.image_url,u.tooltips.sticky_tooltips=r.tooltips.sticky_tooltips,u.tooltips.constrain_tooltips=r.tooltips.constrain_tooltips,u.tooltips.tooltip_animation=r.tooltips.tooltip_animation,u.tooltips.fullscreen_tooltips=r.tooltips.fullscreen_tooltips,u.fullscreen.enable_fullscreen_mode=r.fullscreen.enable_fullscreen_mode,u.fullscreen.start_in_fullscreen_mode=r.fullscreen.start_in_fullscreen_mode,u.fullscreen.fullscreen_background=r.fullscreen.fullscreen_background,u.fullscreen.fullscreen_button_position=r.fullscreen.fullscreen_button_position,u.fullscreen.fullscreen_button_type=r.fullscreen.fullscreen_button_type,u.fullscreen.fullscreen_button_color=r.fullscreen.fullscreen_button_color,u.fullscreen.fullscreen_button_text_color=r.fullscreen.fullscreen_button_text_color,g.redraw(),g.addAction())}if("Shape Settings"==e&&g.selectedSpot!==i){var a=g.selectedSpot,s=t.wcpEditorGetModelOfFormWithName("Shape Settings");a.x=s.general.x,a.y=s.general.y,a.width=s.general.width,a.height=s.general.height,a.actions.mouseover=s.actions.mouseover,a.actions.click=s.actions.click,a.actions.link=s.actions.link,a.actions.open_link_in_new_window=s.actions.open_link_in_new_window,a.default_style.opacity=s.default_style.opacity,a.default_style.icon_fill=s.default_style.icon_fill,a.default_style.border_radius=s.default_style.border_radius,a.default_style.background_color=s.default_style.background_color,a.default_style.background_opacity=s.default_style.background_opacity,a.default_style.border_width=s.default_style.border_width,a.default_style.border_style=s.default_style.border_style,a.default_style.border_color=s.default_style.border_color,a.default_style.border_opacity=s.default_style.border_opacity,a.default_style.fill=s.default_style.fill,a.default_style.fill_opacity=s.default_style.fill_opacity,a.default_style.stroke_color=s.default_style.stroke_color,a.default_style.stroke_opacity=s.default_style.stroke_opacity,a.default_style.stroke_width=s.default_style.stroke_width,a.default_style.stroke_dasharray=s.default_style.stroke_dasharray,a.default_style.stroke_linecap=s.default_style.stroke_linecap,a.default_style.use_icon=s.icon.use_icon,a.default_style.icon_type=s.icon.icon_type,a.default_style.icon_svg_path=s.icon.icon_svg_path,a.default_style.icon_svg_viewbox=s.icon.icon_svg_viewbox,a.default_style.icon_url=s.icon.icon_url,a.default_style.icon_is_pin=s.icon.icon_is_pin,a.default_style.icon_shadow=s.icon.icon_shadow,a.mouseover_style.opacity=s.mouseover_style.mouseover_opacity,a.mouseover_style.icon_fill=s.mouseover_style.mouseover_icon_fill,a.mouseover_style.border_radius=s.mouseover_style.mouseover_border_radius,a.mouseover_style.background_color=s.mouseover_style.mouseover_background_color,a.mouseover_style.background_opacity=s.mouseover_style.mouseover_background_opacity,a.mouseover_style.border_width=s.mouseover_style.mouseover_border_width,a.mouseover_style.border_style=s.mouseover_style.mouseover_border_style,a.mouseover_style.border_color=s.mouseover_style.mouseover_border_color,a.mouseover_style.border_opacity=s.mouseover_style.mouseover_border_opacity,a.mouseover_style.fill=s.mouseover_style.mouseover_fill,a.mouseover_style.fill_opacity=s.mouseover_style.mouseover_fill_opacity,a.mouseover_style.stroke_color=s.mouseover_style.mouseover_stroke_color,a.mouseover_style.stroke_opacity=s.mouseover_style.mouseover_stroke_opacity,a.mouseover_style.stroke_width=s.mouseover_style.mouseover_stroke_width,a.mouseover_style.stroke_dasharray=s.mouseover_style.mouseover_stroke_dasharray,a.mouseover_style.stroke_linecap=s.mouseover_style.mouseover_stroke_linecap,a.tooltip_style.border_radius=s.tooltip_settings.tooltip_border_radius,a.tooltip_style.padding=s.tooltip_settings.tooltip_padding,a.tooltip_style.background_color=s.tooltip_settings.tooltip_background_color,a.tooltip_style.background_opacity=s.tooltip_settings.tooltip_background_opacity,a.tooltip_style.position=s.tooltip_settings.tooltip_position,a.tooltip_style.width=s.tooltip_settings.tooltip_width,a.tooltip_style.auto_width=s.tooltip_settings.tooltip_auto_width,a.tooltip_content.content_type=s.tooltip_content.tooltip_content_type,a.tooltip_content.plain_text=s.tooltip_content.plain_text,a.tooltip_content.plain_text_color=s.tooltip_content.plain_text_color,a.tooltip_content.squares_settings=s.tooltip_content.squares_settings,g.redraw(),_||g.addAction()}},t.wcpEditorEventNewButtonPressed=function(){},t.wcpEditorEventSaveButtonPressed=function(){t.wcpEditorPresentLoadingScreen("Saving..."),t.imp_editor_storage_store_save(g.getCompressedSettings(),function(e){if(e)t.wcpEditorHideLoadingScreenWithMessage("Saved!",!1,!1);else{t.wcpEditorHideLoadingScreenWithMessage("There was an error saving the image map!",!0,!1);var o="";o+='<div class="modal-info-text">Please save this code in order to preserve your work and try again later. <br>This code can be imported any time by opening an existing image map and pressing the Import button. <br>You can also <a href="https://webcraftplugins.com/support">contact us</a>!</div>',o+='<textarea id="textarea-error-saving">'+JSON.stringify(g.getCompressedSettings())+"</textarea>",setTimeout(function(){t.wcpEditorPresentModal({name:"error-saving",title:"Error Saving Image Map",buttons:[{class:"primary",name:"done",title:"Done"}],body:o})},1e3)}})},t.wcpEditorEventLoadButtonPressed=function(){},t.wcpEditorEventUndoButtonPressed=function(){g.undo()},t.wcpEditorEventRedoButtonPressed=function(){g.redo()},t.wcpEditorEventPreviewButtonPressed=function(){},t.wcpEditorEventEnteredPreviewMode=function(){u.editor.previewMode=1,g.redraw()},t.wcpEditorEventExitedPreviewMode=function(){u.editor.previewMode=0,g.redraw()},t.wcpEditorEventListItemMouseover=function(e){for(var o=i,r=0;r<u.spots.length;r++)u.spots[r].id==e&&(o=u.spots[r].title);1==parseInt(u.editor.previewMode,10)&&t.imageMapProHighlightShape(u.general.name,o)},t.wcpEditorEventListItemSelected=function(e){g.selectSpot(e),g.redraw();for(var o=i,r=0;r<u.spots.length;r++)u.spots[r].id==e&&(o=u.spots[r].title);1==parseInt(u.editor.previewMode,10)&&(t.imageMapProHighlightShape(u.general.name,o),"show-tooltip"!=g.selectedSpot.actions.mouseover&&"show-tooltip"!=g.selectedSpot.actions.click||t.imageMapProOpenTooltip(u.general.name,o))},t.wcpEditorEventListItemMoved=function(t,e,o){o=u.spots.length-1-o,e=u.spots.length-1-e,o>u.spots.length-1&&(o=u.spots.length-1),u.spots.splice(o,0,u.spots.splice(e,1)[0]),g.updateShapesList(),g.redraw()},t.wcpEditorEventListItemButtonPressed=function(t,e){},t.wcpEditorEventListItemTitleButtonPressed=function(e){if(g.selectedSpot){if("duplicate"==e){var o=t.extend(!0,{},g.selectedSpot);"spot"==o.type&&(o.id=g.createIdForSpot()),"rect"==o.type&&(o.id=g.createIdForRect()),"oval"==o.type&&(o.id=g.createIdForOval()),"poly"==o.type&&(o.id=g.createIdForPoly()),o.title+=" Copy",u.spots.push(o),g.redraw(),g.addAction()}if("copy"==e&&(m={default_style:t.extend(!0,{},g.selectedSpot.default_style),mouseover_style:t.extend(!0,{},g.selectedSpot.mouseover_style),tooltip_style:t.extend(!0,{},g.selectedSpot.tooltip_style),tooltip_content:{plain_text_color:g.selectedSpot.tooltip_content.plain_text_color}}),"paste"==e&&(g.selectedSpot.default_style=t.extend(!0,{},m.default_style),g.selectedSpot.mouseover_style=t.extend(!0,{},m.mouseover_style),g.selectedSpot.tooltip_style=t.extend(!0,{},m.tooltip_style),g.selectedSpot.tooltip_content.plain_text_color=m.tooltip_content.plain_text_color,g.redraw(),g.addAction()),"delete"==e&&(y=g.getIndexOfSpotWithId(g.selectedSpot.id),t.wcpEditorPresentModal({
name:"confirm-delete-shape",title:"Confirm Delete",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"delete",title:"Delete",class:"danger"}],body:"Delete this shape?"})),"rename"==e){var i='<div class="wcp-editor-form-control">';i+="<label>Shape Name</label>",i+='<input type="text" id="input-shape-name">',i+='<div class="modal-error-text" id="rename-shape-error" style="margin-top: 10px; display: none;"></div>',i+="</div>",t.wcpEditorPresentModal({name:"confirm-rename-shape",title:"Rename Shape",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"rename",title:"Rename",class:"primary"}],body:i}),t("#input-shape-name").val(g.selectedSpot.title)}}},t.wcpEditorEventSelectedTool=function(t){u.editor.tool=t,g.redraw()},t.wcpEditorEventPressedTool=function(t){"reset"==t&&g.zoomReset()},t.wcpEditorEventExtraMainButtonClick=function(e){if("code"==e){var o="";o+='<div id="imp-generated-code-wrap">',o+='<div class="generated-code-help">',o+="    This is a sample HTML document, showing how to install the plugin in your website.",o+="</div>",o+="<pre>",o+="&lt;!doctype html&gt;<br>",o+="&lt;html&gt;<br>",o+="&lt;head&gt;<br>",o+='    <strong><span class="em-code">&lt;link rel=&quot;stylesheet&quot; href=&quot;css/image-map-pro.min.css&quot;&gt;</span></strong><br>',o+="&lt;/head&gt;<br>",o+="&lt;body&gt;<br>",o+='    &lt;div id=&quot;<strong><span class="em-code">image-map-pro-container</span></strong>&quot;&gt;&lt;/div&gt;<br><br>',o+="    &lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;<br>",o+='    <strong><span class="em-code">&lt;script src=&quot;js/image-map-pro.min.js&quot;&gt;&lt;/script&gt;</span></strong><br>',o+="    &lt;script type=&quot;text/javascript&quot;&gt;<br>",o+="        ;(function ($, window, document, undefined) {<br>",o+="            $(document).ready(function() {<br>",o+="</pre>",o+='<div class="generated-code-help">The code that contains all settings and initializes the plugin:</div>',o+='<textarea id="textarea-generated-code" rows="4"></textarea>',o+="    <pre>",o+="            });<br>",o+="        })(jQuery, window, document);<br>",o+="    &lt;/script&gt;<br>",o+="&lt;/body&gt;<br>",o+="&lt;/html&gt;<br>",o+="</pre>",o+="</div>",t.wcpEditorPresentModal({name:"code",title:"Code",buttons:[{name:"done",title:"Done",class:"primary"}],body:o}),t("#textarea-generated-code").val("$('#image-map-pro-container').imageMapPro("+JSON.stringify(g.getCompressedSettings())+");")}if("activate"==e){var o='<div class="wcp-editor-form-control">';o+='<label>Purchase Code <a href="https://help.market.envato.com/hc/en-us/articles/202822600-Where-Is-My-Purchase-Code-" target="_blank"><i class="fa fa-question-circle" aria-hidden="true" data-wcp-tooltip="Trouble finding your purchase code?" data-wcp-tooltip-position="right"></i></a></label>',o+='<input type="text" id="input-purchase-code">',o+="</div>",t.wcpEditorPresentModal({name:"activate",title:"Activate",buttons:[{name:"cancel",title:"Cancel",class:"default"},{name:"activate",title:"Activate",class:"primary"}],body:o})}"help"==e&&t.wcpTourRestart("Image Map Pro Editor Tour")},t.wcpEditorEventModalButtonClicked=function(e,o){if("create_new"==e&&"cancel"==o&&t.wcpEditorCloseModal(),"modal-choose-icon"==e&&"cancel"==o&&t.wcpEditorCloseModal(),"load"==e&&"cancel"==o&&t.wcpEditorCloseModal(),"confirm-delete-shape"==e&&("delete"==o&&(u.editor.selected_shape==u.spots[y].id&&g.deselectSpot(),u.spots.splice(y,1),t.wcpEditorCloseModal(),g.redraw(),g.addAction()),"cancel"==o&&t.wcpEditorCloseModal()),"code"==e&&"done"==o&&t.wcpEditorCloseModal(),"export"==e&&"cancel"==o&&t.wcpEditorCloseModal(),"import"==e&&"cancel"==o&&t.wcpEditorCloseModal(),"error-saving"==e&&"done"==o&&t.wcpEditorCloseModal(),"activate"==e&&("cancel"==o&&t.wcpEditorCloseModal(),"activate"==o&&(t.wcpEditorCloseModal(),t.wcpEditorPresentLoadingScreen("Validating Purchase Code..."),t.wcpValidatePurchaseCode?t.wcpValidatePurchaseCode(t("#input-purchase-code").val(),function(e,o){e?(t.wcpEditorHideLoadingScreenWithMessage("Success!",!1,!1),t.wcpEditorHideExtraMainButton("activate")):t.wcpEditorHideLoadingScreenWithMessage("Failed to validate your purchase code.",!0,!1)}):t.wcpEditorHideLoadingScreenWithMessage("Failed to validate your purchase code.</div>",!0,!0))),"confirm-rename-shape"==e&&("cancel"==o&&t.wcpEditorCloseModal(),"rename"==o)){var i=t("#input-shape-name").val();if(0==i.length)return void t("#rename-shape-error").show().html("Please enter a new name for the shape, or press Cancel.");for(var r=!1,n=0;n<u.spots.length;n++)if(u.spots[n].title==i&&u.spots[n].id!=g.selectedSpot.id){r=!0;break}if(r||0==i.length)return void t("#rename-shape-error").show().html("A shape with this name already exists!");g.selectedSpot.title=i,t.wcpEditorCloseModal(),g.redraw()}},t.wcpEditorEventModalClosed=function(t){},t.wcpEditorEventCreatedNewInstance=function(e){u=t.extend(!0,{},V),u.id=Math.round(1e4*Math.random())+1,u.general.name=e,t.wcpEditorPresentLoadingScreen("Creating..."),t.imp_editor_storage_store_save(g.getCompressedSettings(),function(){t.imp_editor_storage_set_last_save(u.id,function(){g.launch(),t.wcpEditorHideLoadingScreenWithMessage("Created!",!1,!1)})})},t.wcpEditorEventLoadSaveWithID=function(e){t.wcpEditorPresentLoadingScreen("Loading Image Map..."),t.imp_editor_storage_get_save(e,function(e){e?(u=e,t.imp_editor_storage_set_last_save(u.id,function(){t.wcpEditorHideLoadingScreen(),g.launch()})):t.wcpEditorHideLoadingScreenWithMessage("Error loading image map.",!0,!1)})},t.wcpEditorEventDeleteSaveWithID=function(e,o){t.imp_editor_storage_delete_save(e,function(){o()})},t.wcpEditorEventImportedJSON=function(e){var o=u.general.name,i=u.id;u=t.extend(!0,{},e),u.general.name=o,u.id=i,g.launch()},t.wcpEditorEventHelpButtonPressed=function(){},t.wcpEditorSliderStartedDragging=function(){_=!0},t.wcpEditorSliderFinishedDragging=function(){_=!1},t.image_map_pro_default_spot_settings=function(){return T},t.image_map_pro_init_editor=function(t,e){g=new r,g.init(t,e)},t.image_map_pro_editor_current_settings=function(){return u},t.image_map_pro_editor_compressed_settings=function(){return g.getCompressedSettings()},t.image_map_pro_user_uploaded_image=function(){},r.prototype.init=function(e,o){var i=this;i.events(),i.loadIconLibrary(),i.wcpEditorSettings=o,u=t.extend(!0,{},V),t.wcpEditorInit(this.wcpEditorSettings),e?(u=e,i.launch()):t.imp_editor_storage_get_last_save(function(e){e&&0!=parseInt(e,10)&&!isNaN(parseInt(e,10))?(t.wcpEditorPresentLoadingScreen("Loading Image Map..."),t.imp_editor_storage_get_save(parseInt(e,10),function(e){e?(u=e,g.launch()):t.wcpEditorHideLoadingScreenWithMessage("Error loading image map.",!0,!1)})):t.wcpTourIsFinished("Image Map Pro Editor Tour")?t.imp_editor_storage_get_saves_list(function(e){e.length>0?(u=t.extend(!0,{},V),u.general.name="Untitled",u.id=Math.round(1e4*Math.random())+1,i.launch(),t.wcpEditorPresentLoadModal()):(u=t.extend(!0,{},V),u.general.name="Untitled",u.id=Math.round(1e4*Math.random())+1,i.launch())}):t.wcpTourStart("Image Map Pro Editor Tour")})},r.prototype.launch=function(){var e=this;t.wcpEditorInit(this.wcpEditorSettings),t("#wcp-editor-canvas").attr("data-editor-object-type","0"),this.selectedSpot=i,this.eventSpot=i,this.shapesFormSpotIndex=i,this.parseSettings(),u.image.url&&u.image.url.length>0?(e.canvasImage.src=u.image.url,n(e.canvasImage,function(){t.wcpEditorPresentLoadingScreen("Loading Image...")},function(){e.canvas_events(),u.general.naturalWidth=e.canvasImage.naturalWidth,u.general.naturalHeight=e.canvasImage.naturalHeight,u.editor.state={dragging:!1,canvasX:0,canvasY:0,canvasZoom:1},e.redraw(),e.selectSpot(u.editor.selected_shape),t.wcpEditorHideLoadingScreen()},function(){t.wcpEditorHideLoadingScreenWithMessage("Error Loading Image!",!0,!1)})):(t.wcpEditorHideLoadingScreen(),t.wcpEditorOpenMainTabWithName("Image Map"),t.wcpEditorFormOpenTab("Image Map Settings","image")),this.actionIndex=-1,this.actionStack=new Array,this.addAction(),this.canvas=t("#wcp-editor-canvas"),t.wcpEditorSelectTool(u.editor.tool),this.updateImageMapForm()},r.prototype.parseSettings=function(){for(var e=0;e<u.spots.length;e++){var o=u.spots[e];if(o.x=parseFloat(o.x),o.y=parseFloat(o.y),o.width&&(o.width=parseFloat(o.width)),o.height&&(o.height=parseFloat(o.height)),"poly"==o.type){if(o.points)for(var r=0;r<o.points.length;r++)o.points[r].x=parseFloat(o.points[r].x),o.points[r].y=parseFloat(o.points[r].y);if(o.vs)for(var r=0;r<o.vs.length;r++)for(var n=0;n<o.vs[r].length;n++)o.vs[r][0]=parseFloat(o.vs[r][0]),o.vs[r][1]=parseFloat(o.vs[r][1])}}for(var e=0;e<u.spots.length;e++){if(u.spots[e]=t.extend(!0,{},T,u.spots[e]),u.spots[e].tooltip_content.title||u.spots[e].tooltip_content.text){var a="";u.spots[e].tooltip_content.title&&(a+="<h3>"+u.spots[e].tooltip_content.title+"</h3>"),u.spots[e].tooltip_content.text&&(a+="<p>"+u.spots[e].tooltip_content.text+"</p>"),u.spots[e].tooltip_content.plain_text=a,u.spots[e].tooltip_content={content_type:u.spots[e].tooltip_content.content_type,plain_text:u.spots[e].tooltip_content.plain_text,plain_text_color:u.spots[e].tooltip_content.plain_text_color,squares_json:u.spots[e].tooltip_content.squares_json}}if(u.spots[e].tooltip_content.squares_json)try{u.spots[e].tooltip_content.squares_settings=JSON.parse(u.spots[e].tooltip_content.squares_json),u.spots[e].tooltip_content.squares_json=""}catch(t){}u.spots[e].title||(u.spots[e].title=u.spots[e].id)}u.general=t.extend(!0,{},V.general,u.general),u.image=t.extend(!0,{},V.image,u.image),u.tooltips=t.extend(!0,{},V.tooltips,u.tooltips),u.fullscreen=t.extend(!0,{},V.fullscreen,u.fullscreen),u.editor=t.extend(!0,{},V.editor,u.editor),u.general.width=parseInt(u.general.width),u.general.height=parseInt(u.general.height),u.general.image_url&&(u.image.url=u.general.image_url,u.general.image_url=i),u.general.sticky_tooltips&&(u.tooltips.sticky_tooltips=u.general.sticky_tooltips,u.general.sticky_tooltips=i),u.general.constrain_tooltips&&(u.tooltips.constrain_tooltips=u.general.constrain_tooltips,u.general.constrain_tooltips=i),u.general.fullscreen_tooltips&&(u.tooltips.fullscreen_tooltips=u.general.fullscreen_tooltips,u.general.fullscreen_tooltips=i),u.general.tooltip_animation&&(u.tooltips.tooltip_animation=u.general.tooltip_animation,u.general.tooltip_animation=i);for(var e=0;e<u.spots.length;e++)u.spots[e].tooltip_content.squares_settings||(u.spots[e].tooltip_content.squares_settings=t.extend(!0,{},T.tooltip_content.squares_settings));u.general.imageurl&&(u.image.url=u.general.imageurl),u.general.name=u.general.name.trim(),u.general.shortcode=u.general.shortcode.trim()},r.prototype.redraw=function(){var e=this,o=e.getCanvasDefaultSize();if(e.canvasWidth=o.w*e.zoom,e.canvasHeight=o.h*e.zoom,t("#wcp-editor-canvas").css({width:e.canvasWidth,height:e.canvasHeight}),0==parseInt(u.editor.previewMode,10))t("#wcp-editor-canvas").html(t.image_map_pro_editor_content()),t("#imp-editor-image").css({width:e.canvasWidth,height:e.canvasHeight}),t.wcpEditorSetPreviewModeOff();else{var i=t.extend(!0,{},u);i.fullscreen.start_in_fullscreen_mode=!1,t("#wcp-editor-canvas").imageMapPro(i),1!=this.zoom&&e.zoomReset(),t.wcpEditorSetPreviewModeOn()}e.redrawSpotSelection(),e.updateShapesForm(),this.updateShapesFormState(),e.updateShapesList(),e.updateImageMapFormState(),e.drawingPoly&&e.redrawTempPoly()},r.prototype.redrawCanvas=function(){this.canvas.css({transform:"translate("+this.canvasX+"px, "+this.canvasY+"px)"})},r.prototype.getCanvasDefaultSize=function(){var e={w:0,h:0},o=t("#wcp-editor-center").width()-80,i=t("#wcp-editor-center").height()-80;if(u.general.width>o||u.general.height>i){var r=u.general.width/u.general.height,n=o/i;r<=n?(e.w=i*r,e.h=t("#wcp-editor-center").height()-80):(e.w=t("#wcp-editor-center").width()-80,e.h=o/r)}else e.w=u.general.width,e.h=u.general.height;return e},r.prototype.redrawSpotSelection=function(){var e=this;if(t(".imp-editor-shape").removeClass("selected"),u.editor.selected_shape!=-1){var o=e.getIndexOfSpotWithId(u.editor.selected_shape);if(o==i)return void(u.editor.selected_shape=-1);t('.imp-editor-shape[data-id="'+u.editor.selected_shape+'"]').addClass("selected"),e.selectedSpot=u.spots[o],"poly"==e.selectedSpot.type&&(e.tempControlPoint=t('.imp-editor-poly[data-id="'+u.editor.selected_shape+'"]').find(".imp-editor-poly-svg-temp-control-point"),e.tempControlPointLine=t('.imp-editor-poly[data-id="'+u.editor.selected_shape+'"]').find(".imp-editor-poly-svg-temp-control-point-line"))}else e.selectedSpot=i},r.prototype.events=function(){var e=this;t(o).off("button-choose-icon-clicked"),t(o).on("button-choose-icon-clicked",function(){t.wcpEditorPresentModal({name:"modal-choose-icon",title:"Choose Icon",buttons:[{name:"cancel",title:"Cancel",class:"default",id:"imp-editor-button-cancel-choose-icon"}],body:e.iconsHTML})}),t(o).off("button-copy-from-default-styles-clicked"),t(o).on("button-copy-from-default-styles-clicked",function(){e.selectedSpot.mouseover_style.opacity=e.selectedSpot.default_style.opacity,e.selectedSpot.mouseover_style.border_radius=e.selectedSpot.default_style.border_radius,e.selectedSpot.mouseover_style.background_color=e.selectedSpot.default_style.background_color,e.selectedSpot.mouseover_style.background_opacity=e.selectedSpot.default_style.background_opacity,e.selectedSpot.mouseover_style.border_width=e.selectedSpot.default_style.border_width,e.selectedSpot.mouseover_style.border_style=e.selectedSpot.default_style.border_style,e.selectedSpot.mouseover_style.border_color=e.selectedSpot.default_style.border_color,e.selectedSpot.mouseover_style.border_opacity=e.selectedSpot.default_style.border_opacity,e.selectedSpot.mouseover_style.fill=e.selectedSpot.default_style.fill,e.selectedSpot.mouseover_style.fill_opacity=e.selectedSpot.default_style.fill_opacity,e.selectedSpot.mouseover_style.stroke_color=e.selectedSpot.default_style.stroke_color,e.selectedSpot.mouseover_style.stroke_opacity=e.selectedSpot.default_style.stroke_opacity,e.selectedSpot.mouseover_style.stroke_width=e.selectedSpot.default_style.stroke_width,e.selectedSpot.mouseover_style.stroke_dasharray=e.selectedSpot.default_style.stroke_dasharray,e.selectedSpot.mouseover_style.stroke_linecap=e.selectedSpot.default_style.stroke_linecap,e.selectedSpot.mouseover_style.icon_fill=e.selectedSpot.default_style.icon_fill,e.redraw(),e.addAction()}),t(o).off("button-reset-size-clicked"),t(o).on("button-reset-size-clicked",function(){u.general.width=e.canvasImage.naturalWidth,u.general.height=e.canvasImage.naturalHeight,e.updateImageMapForm(),e.redraw()}),t(o).off("button-launch-content-builder-clicked"),t(o).on("button-launch-content-builder-clicked",function(){e.launchTooltipContentBuilder()}),t(o).off("click",".imp-spot-icon"),t(o).on("click",".imp-spot-icon",function(){t.wcpEditorCloseModal(),e.selectedSpot.default_style.icon_svg_path=t(this).data("path"),e.selectedSpot.default_style.icon_svg_viewbox=t(this).data("viewbox"),e.redraw(),e.addAction()}),t(o).off("click","#imp-editor-done-editing-tooltip, #imp-editor-tooltip-content-builder-close"),t(o).on("click","#imp-editor-done-editing-tooltip, #imp-editor-tooltip-content-builder-close",function(){t("#imp-editor-tooltip-content-builder-wrap").removeClass("imp-visible"),setTimeout(function(){t("#imp-editor-tooltip-content-builder-wrap").hide()},250),e.doneEditingTooltip(),t.squaresHideEditorWindow()})},r.prototype.canvas_events=function(){var i=this;t(e).off("resize.imp-redraw"),t(e).on("resize.imp-redraw",function(){i.redraw()}),t(o).off("mousedown","#wcp-editor-center"),t(o).on("mousedown","#wcp-editor-center",function(t){i.handleMouseDown(t)}),t(o).off("mousemove","#wcp-editor"),t(o).on("mousemove","#wcp-editor",function(t){i.handleMouseMove(t)}),t(o).off("mouseup","#wcp-editor"),t(o).on("mouseup","#wcp-editor",function(t){i.handleMouseUp(t)}),t(o).off("keyup.canvasEvents"),t(o).on("keyup.canvasEvents",function(e){27==e.keyCode&&i.drawingPoly&&(i.drawingPoly=!1,i.startedDrawingPoly=!1,i.mouseDownWhileDrawingPoly=!1,t("#temp-poly").remove())}),t("body").on("contextmenu",function(t){if(i.didDeleteControlPoint)return i.didDeleteControlPoint=!1,!1}),t(o).off("keydown"),t(o).on("keydown",function(t){return!i.handleKeyDown(t)}),t(o).off("keyup"),t(o).on("keyup",function(t){return!i.handleKeyUp(t)})},r.prototype.addAction=function(){var e=this;e.actionIndex<e.actionStack.length-1&&e.actionStack.splice(e.actionIndex+1,e.actionStack.length),e.actionStack.push(t.extend(!0,{},u)),e.actionIndex++,e.actionStack.length>100&&(e.actionStack.splice(0,1),e.actionIndex--),t("#button-save").html('<span class="glyphicon glyphicon-hdd"></span> Save')},r.prototype.undo=function(){var e=this;e.actionIndex>0&&e.actionIndex--,u=t.extend(!0,{},e.actionStack[e.actionIndex]),e.redraw()},r.prototype.redo=function(){var e=this;e.actionIndex<e.actionStack.length-1&&e.actionIndex++,u=t.extend(!0,{},e.actionStack[e.actionIndex]),e.redraw()},r.prototype.loadIconLibrary=function(){for(var e="",o=0;o<t.webcraft_icon_library.length;o++)e+='<div class="imp-spot-icon" data-path="'+t.webcraft_icon_library[o][1]+'" data-viewbox="'+t.webcraft_icon_library[o][0]+'">',e+='   <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="'+t.webcraft_icon_library[o][0]+'" xml:space="preserve" width="40px" height="40px">',e+='       <path style="fill:#000000" d="'+t.webcraft_icon_library[o][1]+'"></path>',e+="   </svg>",e+="</div>";this.iconsHTML=e},r.prototype.handleMouseDown=function(e){var o=this;if("wcp-editor-toolbar"!=t(e.target).attr("id")&&1!=t(e.target).closest("#wcp-editor-toolbar").length&&"wcp-editor-extra-main-buttons"!=t(e.target).attr("id")&&1!=t(e.target).closest("#wcp-editor-extra-main-buttons").length&&"imp-poly-tooltip-close-button"!=t(e.target).attr("id")&&1!=parseInt(u.editor.previewMode,10)&&!t("body").hasClass("modal-open")){var i=s(e.pageX,e.pageY,o.canvas);o.ix=i.x,o.iy=i.y,o.ixss=e.pageX,o.iyss=e.pageY;var r=!1;i.x>0&&i.x<o.canvasWidth*o.zoom&&i.y>0&&i.y<o.canvasHeight*o.zoom&&(r=!0);var n=t(e.target).data("editor-object-type")||t(e.target).closest("[data-editor-object-type]").data("editor-object-type");if((o.spaceKeyDown||u.editor.tool==M)&&r)return o.draggingCanvas=!0,o.canvasInitialX=o.canvasX,void(o.canvasInitialY=o.canvasY);if(u.editor.tool==P&&"wcp-editor-center"!=t(e.target).attr("id"))return o.zoomIn(e),void(this.shouldDeselectShape=!0);if(u.editor.tool==I&&"wcp-editor-center"!=t(e.target).attr("id"))return o.zoomOut(e),void(this.shouldDeselectShape=!0);if(o.drawingPoly)return t(e.target).is("circle")&&0==t(e.target).data("index")?(o.drawingPoly=!1,void(o.finishedDrawingPoly=!0)):(o.placePointForTempPoly(o.ix,o.iy),o.redrawTempPoly(),void(o.mouseDownWhileDrawingPoly=!0));if(u.editor.tool==M&&"wcp-editor-center"!=t(e.target).attr("id"))return o.startedDraggingCanvas=!0,void(this.shouldDeselectShape=!0);if(n==x)return t(e.target).addClass("active"),o.translatedPointIndex=t(e.target).data("index"),2==e.button?(o.selectedSpot.points.splice(o.translatedPointIndex,1),o.updateBoundingBoxForPolygonSpot(o.selectedSpot),o.redraw(),o.addAction(),void(o.didDeleteControlPoint=!0)):(o.translatingControlPoint=!0,o.translatedPointX=o.selectedSpot.points[o.translatedPointIndex].x,o.translatedPointY=o.selectedSpot.points[o.translatedPointIndex].y,o.translatedPoint=t(e.target),void(o.redrawPolygonEl=t(e.target).closest(".imp-editor-shape").find(".imp-editor-poly-svg polygon")));if(n==f){o.selectedSpot.points.splice(o.tempControlPointIndex+1,0,{x:o.controlPointInsertionPointX,y:o.controlPointInsertionPointY}),o.redraw();var i=t('.imp-editor-shape[data-id="'+o.selectedSpot.id+'"]').find('.imp-poly-control-point[data-index="'+(o.tempControlPointIndex+1)+'"]');return i.addClass("active"),o.translatedPointIndex=i.data("index"),o.translatingControlPoint=!0,o.translatedPointX=o.selectedSpot.points[o.translatedPointIndex].x,o.translatedPointY=o.selectedSpot.points[o.translatedPointIndex].y,o.translatedPoint=i,void(o.redrawPolygonEl=i.closest(".imp-editor-shape").find(".imp-editor-poly-svg polygon"))}if(n!=w){for(var a=u.spots.length-1;a>=0;a--)if("poly"==u.spots[a].type&&o.shouldSelectPoly(u.spots[a].id))return o.eventSpotId=u.spots[a].id,void(o.startedSelecting=!0);if((t(e.target).hasClass("imp-editor-shape")||t(e.target).closest(".imp-editor-shape").length>0)&&!t(e.target).hasClass("imp-editor-poly")&&0==t(e.target).closest(".imp-editor-poly").length)return o.eventSpotId=t(e.target).data("id")||t(e.target).closest(".imp-editor-shape").data("id"),void(o.startedSelecting=!0);if(r){if(u.editor.tool==E)return void(o.startedDrawingSpot=!0);if(u.editor.tool==C)return void(o.startedDrawingRect=!0);if(u.editor.tool==b)return void(o.startedDrawingOval=!0);if(u.editor.tool==F)return o.startedDrawingPoly=!0,o.deselectSpot(),o.redraw(),o.polyPoints=new Array,t("#imp-editor-shapes-container").append('<svg id="temp-poly" width="'+o.canvasWidth+'px" height="'+o.canvasHeight+'px" viewBox="0 0 '+o.canvasWidth+" "+o.canvasHeight+'" version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>'),o.placePointForTempPoly(o.ix,o.iy),o.redrawTempPoly(),o.mouseDownWhileDrawingPoly=!0,void(o.drawingPoly=!0)}return u.editor.tool==k&&n==S?void(this.shouldDeselectShape=!0):"wcp-editor-center"==t(e.target).attr("id")&&this.selectedSpot?void(this.shouldDeselectShape=!0):void 0}if(o.startedTransforming=!0,o.transformDirection=t(e.target).data("transform-direction"),o.redrawEl=t(e.target).closest(".imp-editor-shape"),"poly"==o.selectedSpot.type){o.redrawSvgEl=o.redrawEl.find(".imp-editor-poly-svg"),o.redrawPolygonEl=o.redrawSvgEl.find("polygon"),o.polyPoints=new Array;for(var a=0;a<o.selectedSpot.points.length;a++)o.polyPoints.push({x:o.selectedSpot.points[a].x,y:o.selectedSpot.points[a].y})}}},r.prototype.handleMouseMove=function(e){var o=this;if(1!=parseInt(u.editor.previewMode,10)){var i=s(e.pageX,e.pageY,o.canvas);if(o.x=i.x,o.y=i.y,o.dx=(o.x-o.ix)/o.canvasWidth*100,o.dy=(o.y-o.iy)/o.canvasHeight*100,o.dx=Math.round(1e3*o.dx)/1e3,o.dy=Math.round(1e3*o.dy)/1e3,o.xss=e.pageX,o.yss=e.pageY,o.dxss=o.xss-o.ixss,o.dyss=o.yss-o.iyss,o.draggingCanvas){var r=o.canvasInitialX+o.dxss,n=o.canvasInitialY+o.dyss;o.canvasX=o.canvasInitialX+o.dxss,o.canvasY=o.canvasInitialY+o.dyss,o.redrawCanvas()}if(o.startedSelecting&&(o.selectSpot(o.eventSpotId),o.redrawEl=t('.imp-editor-shape[data-id="'+o.eventSpotId+'"]'),o.redrawSpotSelection(),o.startedMoving=!0,o.startedSelecting=!1),o.startedMoving){var a=p(o.selectedSpot.x+o.dx,o.selectedSpot.y+o.dy);return"rect"!=o.selectedSpot.type&&"oval"!=o.selectedSpot.type&&"poly"!=o.selectedSpot.type||(a.x+o.selectedSpot.width>100&&(a.x=100-o.selectedSpot.width),a.y+o.selectedSpot.height>100&&(a.y=100-o.selectedSpot.height)),void o.redrawEl.css({left:a.x+"%",top:a.y+"%"})}if(!o.startedTransforming){if(o.startedDrawingRect){var i=s(e.pageX,e.pageY,o.canvas);o.createdDrawingRect||(o.createdDrawingRect=!0,o.eventSpot=o.createRect(),o.eventSpot.x=o.x/o.canvasWidth*100,o.eventSpot.y=o.y/o.canvasHeight*100,o.eventSpot.x=Math.round(1e3*o.eventSpot.x)/1e3,o.eventSpot.y=Math.round(1e3*o.eventSpot.y)/1e3,o.redraw(),o.redrawEl=t('.imp-editor-shape[data-id="'+o.eventSpot.id+'"]'));var d={x:o.dx,y:o.dy};if(o.eventSpot.x+d.x>100&&(d.x=100-o.eventSpot.x),o.eventSpot.y+d.y>100&&(d.y=100-o.eventSpot.y),o.drawRectWidth=d.x,o.drawRectHeight=d.y,o.shiftKeyDown){var c=o.canvasWidth/o.canvasHeight;o.drawRectHeight=o.drawRectWidth*c}return void o.redrawEl.css({width:o.drawRectWidth+"%",height:o.drawRectHeight+"%"})}if(o.startedDrawingOval){var i=s(e.pageX,e.pageY,o.canvas);o.createdDrawingOval||(o.createdDrawingOval=!0,o.eventSpot=o.createOval(),o.eventSpot.x=o.x/o.canvasWidth*100,o.eventSpot.y=o.y/o.canvasHeight*100,o.eventSpot.x=Math.round(1e3*o.eventSpot.x)/1e3,o.eventSpot.y=Math.round(1e3*o.eventSpot.y)/1e3,o.redraw(),o.redrawEl=t('.imp-editor-shape[data-id="'+o.eventSpot.id+'"]'));var d={x:o.dx,y:o.dy};if(o.eventSpot.x+d.x>100&&(d.x=100-o.eventSpot.x),o.eventSpot.y+d.y>100&&(d.y=100-o.eventSpot.y),o.drawRectWidth=d.x,o.drawRectHeight=d.y,o.shiftKeyDown){var c=o.canvasWidth/o.canvasHeight;o.drawRectHeight=o.drawRectWidth*c}return void o.redrawEl.css({width:o.drawRectWidth+"%",height:o.drawRectHeight+"%"})}if(o.mouseDownWhileDrawingPoly)return o.polyPoints[o.polyPoints.length-1].x=o.x/o.zoom,o.polyPoints[o.polyPoints.length-1].y=o.y/o.zoom,void o.redrawTempPoly();if(o.translatingControlPoint){if(!o.startedTranslatingControlPoint){o.startedTranslatingControlPoint=!0,t(e.target).closest(".imp-editor-shape").find(".imp-selection").hide(),t(e.target).closest(".imp-editor-shape").css({left:0,top:0,width:"100%",height:"100%"}),t(e.target).closest(".imp-editor-shape").find(".imp-editor-poly-svg")[0].setAttribute("viewBox","0 0 "+u.general.width+" "+u.general.height);for(var h=0;h<o.selectedSpot.points.length;h++)t('.imp-editor-shape[data-id="'+o.selectedSpot.id+'"]').find('.imp-poly-control-point[data-index="'+h+'"]').css({left:l(o.selectedSpot.points[h],o.selectedSpot).x+"%",top:l(o.selectedSpot.points[h],o.selectedSpot).y+"%"})}l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).x+o.dx<0&&(o.dx=-l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).x),l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).x+o.dx>100&&(o.dx=100-l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).x),l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).y+o.dy<0&&(o.dy=-l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).y),l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).y+o.dy>100&&(o.dy=100-l({x:o.translatedPointX,y:o.translatedPointY},o.selectedSpot).y);var g=o.dx/(o.selectedSpot.width/100*o.canvasWidth/o.canvasWidth),_=o.dy/(o.selectedSpot.height/100*o.canvasHeight/o.canvasHeight);o.selectedSpot.points[o.translatedPointIndex].x=o.translatedPointX+g,o.selectedSpot.points[o.translatedPointIndex].y=o.translatedPointY+_,o.translatedPoint.css({left:l(o.selectedSpot.points[o.translatedPointIndex],o.selectedSpot).x+"%",top:l(o.selectedSpot.points[o.translatedPointIndex],o.selectedSpot).y+"%"});for(var m="",y=0;y<o.selectedSpot.points.length;y++){var S=l(o.selectedSpot.points[y],o.selectedSpot),r=o.selectedSpot.default_style.stroke_width+S.x/100*(u.general.width-2*o.selectedSpot.default_style.stroke_width),n=o.selectedSpot.default_style.stroke_width+S.y/100*(u.general.height-2*o.selectedSpot.default_style.stroke_width);m+=r+","+n+" "}return void o.redrawPolygonEl.attr("points",m)}return o.selectedSpot&&"poly"==o.selectedSpot.type?void o.redrawSelectedPolyTempPoint(e):void 0}o.didTransform=!0;var a,d;if(1==o.transformDirection&&(a={x:o.selectedSpot.x+o.dx,y:o.selectedSpot.y+o.dy},d={x:o.selectedSpot.width-o.dx,y:o.selectedSpot.height-o.dy}),2==o.transformDirection&&(a={x:o.selectedSpot.x,y:o.selectedSpot.y+o.dy},d={x:o.selectedSpot.width,y:o.selectedSpot.height-o.dy}),3==o.transformDirection&&(a={x:o.selectedSpot.x,y:o.selectedSpot.y+o.dy},d={x:o.selectedSpot.width+o.dx,y:o.selectedSpot.height-o.dy}),4==o.transformDirection&&(a={x:o.selectedSpot.x,y:o.selectedSpot.y},d={x:o.selectedSpot.width+o.dx,y:o.selectedSpot.height}),5==o.transformDirection&&(a={x:o.selectedSpot.x,y:o.selectedSpot.y},d={x:o.selectedSpot.width+o.dx,y:o.selectedSpot.height+o.dy}),6==o.transformDirection&&(a={x:o.selectedSpot.x,y:o.selectedSpot.y},d={x:o.selectedSpot.width,y:o.selectedSpot.height+o.dy}),7==o.transformDirection&&(a={x:o.selectedSpot.x+o.dx,y:o.selectedSpot.y},d={x:o.selectedSpot.width-o.dx,y:o.selectedSpot.height+o.dy}),8==o.transformDirection&&(a={x:o.selectedSpot.x+o.dx,y:o.selectedSpot.y},d={x:o.selectedSpot.width-o.dx,y:o.selectedSpot.height}),a.x<0&&(d.x=o.selectedSpot.x+o.selectedSpot.width,a.x=0),a.y<0&&(a.y=0,d.y=o.selectedSpot.y+o.selectedSpot.height),d.x+a.x>100&&(d.x=100-a.x),d.y+a.y>100&&(d.y=100-a.y),a.x>o.selectedSpot.x+o.selectedSpot.width&&(a.x=o.selectedSpot.x+o.selectedSpot.width),a.y>o.selectedSpot.y+o.selectedSpot.height&&(a.y=o.selectedSpot.y+o.selectedSpot.height),d.x<0&&(d.x=0),d.y<0&&(d.y=0),o.transformX=a.x,o.transformY=a.y,o.transformWidth=d.x,o.transformHeight=d.y,o.redrawEl.css({left:o.transformX+"%",top:o.transformY+"%",width:o.transformWidth+"%",height:o.transformHeight+"%"}),"poly"==o.selectedSpot.type){var w=u.general.width*(d.x/100),f=u.general.height*(d.y/100);o.redrawSvgEl[0].setAttribute("viewBox","0 0 "+w+" "+f);for(var m="",y=0;y<o.selectedSpot.points.length;y++){var S=o.selectedSpot.points[y],r=o.selectedSpot.default_style.stroke_width+S.x/100*(w-2*o.selectedSpot.default_style.stroke_width),n=o.selectedSpot.default_style.stroke_width+S.y/100*(f-2*o.selectedSpot.default_style.stroke_width);m+=r+","+n+" "}o.redrawPolygonEl.attr("points",m)}}},r.prototype.handleMouseUp=function(e){var o=this;if(1!=parseInt(u.editor.previewMode,10)){if("imp-poly-tooltip-close-button"==t(e.target).attr("id")&&t("#imp-poly-tooltip").remove(),o.startedDrawingSpot){var i=o.createSpot();i.x=o.ix/o.canvasWidth*100,i.y=o.iy/o.canvasHeight*100,i.x=Math.round(1e3*i.x)/1e3,i.y=Math.round(1e3*i.y)/1e3,o.selectSpot(i.id),o.redraw(),o.addAction()}else if(o.startedDrawingRect&&o.createdDrawingRect){var r=p(o.dx,o.dy);o.eventSpot.width=Math.round(1e3*o.drawRectWidth)/1e3,o.eventSpot.height=Math.round(1e3*o.drawRectHeight)/1e3,o.selectSpot(o.eventSpot.id),o.redraw(),o.addAction()}else if(o.startedDrawingOval&&o.createdDrawingOval){var r=p(o.dx,o.dy);o.eventSpot.width=Math.round(1e3*o.drawRectWidth)/1e3,o.eventSpot.height=Math.round(1e3*o.drawRectHeight)/1e3,o.selectSpot(o.eventSpot.id),o.redraw(),o.addAction()}else if(o.finishedDrawingPoly){t("#temp-poly").remove();var n=o.createPoly(o.polyPoints);o.selectSpot(n.id),o.addAction(),o.redraw()}else if(o.startedMoving){var r=p(o.selectedSpot.x+o.dx,o.selectedSpot.y+o.dy);"rect"!=o.selectedSpot.type&&"oval"!=o.selectedSpot.type&&"poly"!=o.selectedSpot.type||(r.x+o.selectedSpot.width>100&&(r.x=100-o.selectedSpot.width),r.y+o.selectedSpot.height>100&&(r.y=100-o.selectedSpot.height)),o.selectedSpot.x=Math.round(1e3*r.x)/1e3,o.selectedSpot.y=Math.round(1e3*r.y)/1e3,o.redraw(),o.addAction()}else if(o.startedTransforming&&o.didTransform)o.selectedSpot.x=Math.round(1e3*o.transformX)/1e3,o.selectedSpot.y=Math.round(1e3*o.transformY)/1e3,o.selectedSpot.width=Math.round(1e3*o.transformWidth)/1e3,o.selectedSpot.height=Math.round(1e3*o.transformHeight)/1e3,o.redraw(),o.addAction();else if(o.translatingControlPoint){o.dx/(o.selectedSpot.width/100*o.canvasWidth/o.canvasWidth),o.dy/(o.selectedSpot.height/100*o.canvasHeight/o.canvasHeight);o.updateBoundingBoxForPolygonSpot(o.selectedSpot),o.redraw(),o.addAction()}else o.startedSelecting?(o.selectedSpot&&o.selectedSpot.id!=o.eventSpotId&&o.deselectSpot(),o.selectSpot(o.eventSpotId),o.redraw(),o.addAction()):o.shouldDeselectShape&&(o.deselectSpot(),o.redraw(),o.addAction());o.draggingCanvas=!1,o.startedSelecting=!1,o.startedMoving=!1,o.startedTransforming=!1,o.didTransform=!1,o.transformDirection=0,o.startedDrawingSpot=!1,o.startedDrawingRect=!1,o.createdDrawingRect=!1,o.startedDrawingOval=!1,o.createdDrawingOval=!1,o.startedDrawingPoly=!1,o.finishedDrawingPoly=!1,o.mouseDownWhileDrawingPoly=!1,o.translatingControlPoint=!1,o.startedTranslatingControlPoint=!1,o.shouldDeselectShape=!1}},r.prototype.handleKeyDown=function(t){var e=i;return 32==t.keyCode&&(this.spaceKeyDown=!0,this.enterCanvasDragMode(),e=!1),91==t.keyCode&&(this.commandKeyDown=!0,e=!0),17==t.keyCode&&(this.ctrlKeyDown=!0,e=!0),16==t.keyCode&&(this.shiftKeyDown=!0,e=!0),187!=t.keyCode&&107!=t.keyCode||(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomIn(),e=!0),189!=t.keyCode&&109!=t.keyCode||(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomOut(),e=!0),48==t.keyCode&&(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomReset(),e=!0),e},r.prototype.handleKeyUp=function(e){var o=this,i=!1;if(32==e.keyCode&&(o.spaceKeyDown=!1,o.exitCanvasDragMode(),i=!1),91==e.keyCode&&(o.commandKeyDown=!1,i=!0),17==e.keyCode&&(o.ctrlKeyDown=!1,i=!0),16==e.keyCode&&(o.shiftKeyDown=!1,i=!0),13==e.keyCode&&o.drawingPoly){
o.drawingPoly=!1,o.finishedDrawingPoly=!1,t("#temp-poly").remove();var r=o.createPoly(o.polyPoints);o.selectSpot(r.id),o.addAction(),o.redraw()}return i},r.prototype.getIndexOfSpotWithId=function(t){for(var e=0;e<u.spots.length;e++)if(u.spots[e].id==t)return e},r.prototype.selectSpot=function(t){u.editor.selected_shape=t},r.prototype.deselectSpot=function(){u.editor.selected_shape=-1},r.prototype.createIdForSpot=function(){var t=0,e=!1;do{t="spot-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<u.spots.length;o++)if(u.spots[o].id==t){e=!0;break}}while(e);return t},r.prototype.createIdForRect=function(){var t=0,e=!1;do{t="rect-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<u.spots.length;o++)if(u.spots[o].id==t){e=!0;break}}while(e);return t},r.prototype.createIdForOval=function(){var t=0,e=!1;do{t="oval-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<u.spots.length;o++)if(u.spots[o].id==t){e=!0;break}}while(e);return t},r.prototype.createIdForPoly=function(){var t=0,e=!1;do{t="rect-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<u.spots.length;o++)if(u.spots[o].id==t){e=!0;break}}while(e);return t},r.prototype.createSpot=function(){var e=this,o=t.extend(!0,{},T);return o.type="spot",o.id=e.createIdForSpot(),o.title=o.id,u.spots.push(o),o},r.prototype.createRect=function(){var e=this,o=t.extend(!0,{},T);return o.type="rect",o.default_style.border_radius=10,o.mouseover_style.border_radius=10,o.id=e.createIdForRect(),o.title=o.id,u.spots.push(o),o},r.prototype.createOval=function(){var e=this,o=t.extend(!0,{},T);return o.type="oval",o.id=e.createIdForOval(),o.title=o.id,u.spots.push(o),o},r.prototype.createPoly=function(){var e=this,o=t.extend(!0,{},T);o.type="poly",o.id=e.createIdForPoly(),o.title=o.id;for(var i=99999,r=99999,n=0,a=0,s=0;s<e.polyPoints.length;s++){var l=e.polyPoints[s];l.x<i&&(i=l.x),l.x>n&&(n=l.x),l.y<r&&(r=l.y),l.y>a&&(a=l.y)}var d=n-i,p=a-r;o.x=i/e.canvasWidth*100*e.zoom,o.y=r/e.canvasHeight*100*e.zoom,o.width=d/e.canvasWidth*100*e.zoom,o.height=p/e.canvasHeight*100*e.zoom;for(var s=0;s<e.polyPoints.length;s++)o.points.push({x:(e.polyPoints[s].x-i)/d*100,y:(e.polyPoints[s].y-r)/p*100});return u.spots.push(o),o},r.prototype.enterCanvasDragMode=function(){u.editor.state.dragging||(u.editor.state.dragging=!0,this.canvas.append('<div class="imp-editor-canvas-overlay" id="imp-editor-canvas-overlay-drag"></div>'))},r.prototype.exitCanvasDragMode=function(){u.editor.state.dragging&&(u.editor.state.dragging=!1,this.canvas.find("#imp-editor-canvas-overlay-drag").remove())},r.prototype.zoomIn=function(e){var o=this;if(o.zoom*=2,o.zoom>H)o.zoom=H;else{var i=0,r=0,n=0,a=0;if(e)n=o.ix,a=o.iy;else{var l=t("#wcp-editor-center"),d=l.offset().left+l.width()/2,p=l.offset().top+l.height()/2,c=s(d,p,o.canvas);n=c.x,a=c.y}i=o.canvasWidth/2-n,r=o.canvasHeight/2-a,o.canvasX+=i,o.canvasY+=r,o.redrawCanvas(),o.redraw()}},r.prototype.zoomOut=function(e){var o=this;if(o.zoom/=2,o.zoom<1)o.zoom=1;else{var i=0,r=0,n=0,a=0;if(e)n=o.ix,a=o.iy;else{var l=t("#wcp-editor-center"),d=l.offset().left+l.width()/2,p=l.offset().top+l.height()/2,c=s(d,p,o.canvas);n=c.x,a=c.y}i=o.canvasWidth/2-n,r=o.canvasHeight/2-a,o.canvasX-=i/2,o.canvasY-=r/2,o.redrawCanvas(),o.redraw()}1==o.zoom&&(o.canvasX=0,o.canvasY=0,o.redrawCanvas())},r.prototype.zoomReset=function(){this.zoom=1,this.canvasX=0,this.canvasY=0,this.redrawCanvas(),this.redraw()},r.prototype.shouldSelectPoly=function(t){for(var e,o=this,i=0;i<u.spots.length;i++)u.spots[i].id==t&&(e=u.spots[i]);var r=o.ix-e.x/100*o.canvasWidth,n=o.iy-e.y/100*o.canvasHeight,a=e.width/100*o.canvasWidth,s=e.height/100*o.canvasHeight;r=r/a*100,n=n/s*100;for(var l=new Array,i=0;i<e.points.length;i++)l.push([e.points[i].x,e.points[i].y]);return!!c({x:r,y:n},l)},r.prototype.placePointForTempPoly=function(t,e){var o=this;o.polyPoints.push({x:t/o.zoom,y:e/o.zoom})},r.prototype.redrawTempPoly=function(){for(var e=this,o='<polygon points="',i=0;i<e.polyPoints.length;i++){var r=e.polyPoints[i].x*e.zoom,n=e.polyPoints[i].y*e.zoom;o+=r+","+n+" "}o+='" />';for(var i=0;i<e.polyPoints.length;i++){var r=e.polyPoints[i].x*e.zoom,n=e.polyPoints[i].y*e.zoom;o+='<circle cx="'+r+'" cy="'+n+'" r="4" data-index="'+i+'" />'}0==t("#temp-poly").length&&t("#imp-editor-shapes-container").append('<svg id="temp-poly" width="'+e.canvasWidth+'px" height="'+e.canvasHeight+'px" viewBox="0 0 '+e.canvasWidth+" "+e.canvasHeight+'" version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>'),t("#temp-poly").html(o);var o="";if(1!=localStorage["image-map-pro-seen-poly-tooltip"]){localStorage["image-map-pro-seen-poly-tooltip"]=1;var r=e.polyPoints[0].x*e.zoom,n=e.polyPoints[0].y*e.zoom;o+='<div id="imp-poly-tooltip" style="left: '+r+"px; top: "+n+'px;">Click the first point or press ENTER to finish <i class="fa fa-times" aria-hidden="true" id="imp-poly-tooltip-close-button"></i></div>',t("#imp-editor-shapes-container").append(o),t("#imp-poly-tooltip").css({left:t("#imp-poly-tooltip").position().left-t("#imp-poly-tooltip").outerWidth()-20,top:t("#imp-poly-tooltip").position().top-t("#imp-poly-tooltip").outerHeight()/2})}},r.prototype.redrawSelectedPolyTempPoint=function(t){var e,o=this,i=o.selectedSpot.width/100*o.canvasWidth,r=o.selectedSpot.height/100*o.canvasHeight,n=o.x-o.selectedSpot.x/100*o.canvasWidth,a=o.y-o.selectedSpot.y/100*o.canvasHeight,s=n/i*100,l=a/r*100;(e=o.shouldShowTempControlPoint(s,l,o.selectedSpot.points,t))?(o.tempControlPoint.show(),o.tempControlPointLine.show(),o.tempControlPoint.css({left:e.x+"%",top:e.y+"%"}),o.controlPointInsertionPointX=e.x,o.controlPointInsertionPointY=e.y):(o.tempControlPoint.hide(),o.tempControlPointLine.hide())},r.prototype.shouldShowTempControlPoint=function(e,o,r,n){var a=t(n.target).data("editor-object-type")||t(n.target).closest("[data-editor-object-type]").data("editor-object-type");if(a==x)return!1;for(var s=this,l={x:e,y:o},d=9999,p=-1,c=!1,g=s.canvasWidth*(s.selectedSpot.width/100),u=20,_=100*u/g,m=0;m<r.length;m++){var y={x:r[m].x,y:r[m].y},S=i;S=r[m+1]?{x:r[m+1].x,y:r[m+1].y}:{x:r[0].x,y:r[0].y};var w=new h(l.x,l.y).closestPointOnLine(new h(y.x,y.y),new h(S.x,S.y)),f=Math.sqrt(Math.pow(l.x-w.x,2)+Math.pow(l.y-w.y,2));f<d&&f<_&&(s.tempControlPointIndex=m,d=f,p=m,c={x:w.x,y:w.y})}return p!=-1&&c},r.prototype.updateBoundingBoxForPolygonSpot=function(t){for(var e=99999,o=99999,i=-99999,r=-99999,n=0;n<t.points.length;n++){var a=t.points[n];a.x<e&&(e=a.x),a.x>i&&(i=a.x),a.y<o&&(o=a.y),a.y>r&&(r=a.y)}for(var s=l({x:e,y:o},t),p=l({x:i,y:r},t),n=0;n<t.points.length;n++){var a=t.points[n],c=l(a,t),h=d(c,{x:s.x,y:s.y,width:p.x-s.x,height:p.y-s.y});a.x=h.x,a.y=h.y}t.x=s.x,t.y=s.y,t.width=p.x-s.x,t.height=p.y-s.y},r.prototype.updateShapesList=function(){for(var e=[],o=u.spots.length-1;o>=0;o--){var i=u.spots[o];e.push({id:i.id,title:i.title})}t.wcpEditorSetListItems(e),t.wcpEditorSelectListItem(u.editor.selected_shape)},r.prototype.updateShapesForm=function(){var e=this.getIndexOfSpotWithId(u.editor.selected_shape),o=u.spots[e];if(o){if(t.wcpEditorSetControlValue("Shape Settings","x",o.x),t.wcpEditorSetControlValue("Shape Settings","y",o.y),t.wcpEditorSetControlValue("Shape Settings","width",o.width),t.wcpEditorSetControlValue("Shape Settings","height",o.height),t.wcpEditorSetControlValue("Shape Settings","mouseover",o.actions.mouseover),t.wcpEditorSetControlValue("Shape Settings","click",o.actions.click),t.wcpEditorSetControlValue("Shape Settings","link",o.actions.link),t.wcpEditorSetControlValue("Shape Settings","open_link_in_new_window",o.actions.open_link_in_new_window),t.wcpEditorSetControlValue("Shape Settings","use_icon",o.default_style.use_icon),t.wcpEditorSetControlValue("Shape Settings","icon_type",o.default_style.icon_type),t.wcpEditorSetControlValue("Shape Settings","icon_svg_path",o.default_style.icon_svg_path),t.wcpEditorSetControlValue("Shape Settings","icon_svg_viewbox",o.default_style.icon_svg_viewbox),t.wcpEditorSetControlValue("Shape Settings","icon_url",o.default_style.icon_url),t.wcpEditorSetControlValue("Shape Settings","icon_is_pin",o.default_style.icon_is_pin),t.wcpEditorSetControlValue("Shape Settings","icon_shadow",o.default_style.icon_shadow),t.wcpEditorSetControlValue("Shape Settings","opacity",o.default_style.opacity),t.wcpEditorSetControlValue("Shape Settings","icon_fill",o.default_style.icon_fill),t.wcpEditorSetControlValue("Shape Settings","border_radius",o.default_style.border_radius),t.wcpEditorSetControlValue("Shape Settings","background_color",o.default_style.background_color),t.wcpEditorSetControlValue("Shape Settings","background_opacity",o.default_style.background_opacity),t.wcpEditorSetControlValue("Shape Settings","border_width",o.default_style.border_width),t.wcpEditorSetControlValue("Shape Settings","border_style",o.default_style.border_style),t.wcpEditorSetControlValue("Shape Settings","border_color",o.default_style.border_color),t.wcpEditorSetControlValue("Shape Settings","border_opacity",o.default_style.border_opacity),t.wcpEditorSetControlValue("Shape Settings","fill",o.default_style.fill),t.wcpEditorSetControlValue("Shape Settings","fill_opacity",o.default_style.fill_opacity),t.wcpEditorSetControlValue("Shape Settings","stroke_color",o.default_style.stroke_color),t.wcpEditorSetControlValue("Shape Settings","stroke_opacity",o.default_style.stroke_opacity),t.wcpEditorSetControlValue("Shape Settings","stroke_width",o.default_style.stroke_width),t.wcpEditorSetControlValue("Shape Settings","stroke_dasharray",o.default_style.stroke_dasharray),t.wcpEditorSetControlValue("Shape Settings","stroke_linecap",o.default_style.stroke_linecap),t.wcpEditorSetControlValue("Shape Settings","mouseover_opacity",o.mouseover_style.opacity),t.wcpEditorSetControlValue("Shape Settings","mouseover_icon_fill",o.mouseover_style.icon_fill),t.wcpEditorSetControlValue("Shape Settings","mouseover_border_radius",o.mouseover_style.border_radius),t.wcpEditorSetControlValue("Shape Settings","mouseover_background_color",o.mouseover_style.background_color),t.wcpEditorSetControlValue("Shape Settings","mouseover_background_opacity",o.mouseover_style.background_opacity),t.wcpEditorSetControlValue("Shape Settings","mouseover_border_width",o.mouseover_style.border_width),t.wcpEditorSetControlValue("Shape Settings","mouseover_border_style",o.mouseover_style.border_style),t.wcpEditorSetControlValue("Shape Settings","mouseover_border_color",o.mouseover_style.border_color),t.wcpEditorSetControlValue("Shape Settings","mouseover_border_opacity",o.mouseover_style.border_opacity),t.wcpEditorSetControlValue("Shape Settings","mouseover_fill",o.mouseover_style.fill),t.wcpEditorSetControlValue("Shape Settings","mouseover_fill_opacity",o.mouseover_style.fill_opacity),t.wcpEditorSetControlValue("Shape Settings","mouseover_stroke_color",o.mouseover_style.stroke_color),t.wcpEditorSetControlValue("Shape Settings","mouseover_stroke_opacity",o.mouseover_style.stroke_opacity),t.wcpEditorSetControlValue("Shape Settings","mouseover_stroke_width",o.mouseover_style.stroke_width),t.wcpEditorSetControlValue("Shape Settings","mouseover_stroke_dasharray",o.mouseover_style.stroke_dasharray),t.wcpEditorSetControlValue("Shape Settings","mouseover_stroke_linecap",o.mouseover_style.stroke_linecap),t.wcpEditorSetControlValue("Shape Settings","tooltip_border_radius",o.tooltip_style.border_radius),t.wcpEditorSetControlValue("Shape Settings","tooltip_padding",o.tooltip_style.padding),t.wcpEditorSetControlValue("Shape Settings","tooltip_background_color",o.tooltip_style.background_color),t.wcpEditorSetControlValue("Shape Settings","tooltip_background_opacity",o.tooltip_style.background_opacity),t.wcpEditorSetControlValue("Shape Settings","tooltip_position",o.tooltip_style.position),t.wcpEditorSetControlValue("Shape Settings","tooltip_width",o.tooltip_style.width),t.wcpEditorSetControlValue("Shape Settings","tooltip_auto_width",o.tooltip_style.auto_width),t.wcpEditorSetControlValue("Shape Settings","tooltip_content_type",o.tooltip_content.content_type),t.wcpEditorSetControlValue("Shape Settings","plain_text",o.tooltip_content.plain_text),t.wcpEditorSetControlValue("Shape Settings","squares_settings",o.tooltip_content.squares_settings),e==this.shapesFormSpotIndex)return;this.shapesFormSpotIndex=e;var i=t.wcpEditorGetHTMLForFormWithName("Shape Settings");t.wcpEditorSetContentForTabWithName("Shape",i),t.wcpEditorUpdateForm("Shape Settings"),t.wcpEditorOpenMainTabWithName("Shape"),this.updateShapesFormStateMaster()}else this.shapesFormSpotIndex=-1,t.wcpEditorSetContentForTabWithName("Shape",'<div class="wcp-editor-form-tabs-content-wrap">No shape selected.</div>')},r.prototype.updateShapesFormState=function(){var e=this.getIndexOfSpotWithId(u.editor.selected_shape),o=u.spots[e];o&&("spot"==o.type&&(1==parseInt(o.default_style.use_icon,10)?(t.wcpEditorFormShowControl("Shape Settings","icon_type"),"library"==o.default_style.icon_type&&(t.wcpEditorFormHideControl("Shape Settings","icon_url"),t.wcpEditorFormShowControl("Shape Settings","choose_icon_from_library")),"custom"==o.default_style.icon_type&&(t.wcpEditorFormShowControl("Shape Settings","icon_url"),t.wcpEditorFormHideControl("Shape Settings","choose_icon_from_library")),t.wcpEditorFormShowControl("Shape Settings","icon_is_pin"),t.wcpEditorFormShowControl("Shape Settings","icon_shadow"),t.wcpEditorFormShowControl("Shape Settings","icon_fill"),t.wcpEditorFormHideControl("Shape Settings","border_radius"),t.wcpEditorFormHideControl("Shape Settings","background_color"),t.wcpEditorFormHideControl("Shape Settings","background_opacity"),t.wcpEditorFormHideControl("Shape Settings","border_width"),t.wcpEditorFormHideControl("Shape Settings","border_style"),t.wcpEditorFormHideControl("Shape Settings","border_color"),t.wcpEditorFormHideControl("Shape Settings","border_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormHideControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_opacity")):(t.wcpEditorFormHideControl("Shape Settings","choose_icon_from_library"),t.wcpEditorFormHideControl("Shape Settings","icon_type"),t.wcpEditorFormHideControl("Shape Settings","icon_url"),t.wcpEditorFormHideControl("Shape Settings","icon_is_pin"),t.wcpEditorFormHideControl("Shape Settings","icon_shadow"),t.wcpEditorFormHideControl("Shape Settings","icon_fill"),t.wcpEditorFormShowControl("Shape Settings","border_radius"),t.wcpEditorFormShowControl("Shape Settings","background_color"),t.wcpEditorFormShowControl("Shape Settings","background_opacity"),t.wcpEditorFormShowControl("Shape Settings","border_width"),t.wcpEditorFormShowControl("Shape Settings","border_style"),t.wcpEditorFormShowControl("Shape Settings","border_color"),t.wcpEditorFormShowControl("Shape Settings","border_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_opacity"))),"plain-text"==o.tooltip_content.content_type?(t.wcpEditorFormShowControl("Shape Settings","plain_text"),t.wcpEditorFormHideControl("Shape Settings","launch_content_builder"),t.wcpEditorFormShowControl("Shape Settings","plain_text_color")):(t.wcpEditorFormHideControl("Shape Settings","plain_text"),t.wcpEditorFormShowControl("Shape Settings","launch_content_builder"),t.wcpEditorFormHideControl("Shape Settings","plain_text_color")),1==parseInt(o.tooltip_style.auto_width,10)?t.wcpEditorFormHideControl("Shape Settings","tooltip_width"):t.wcpEditorFormShowControl("Shape Settings","tooltip_width"),"follow-link"==o.actions.click?(t.wcpEditorFormShowControl("Shape Settings","link"),t.wcpEditorFormShowControl("Shape Settings","open_link_in_new_window")):(t.wcpEditorFormHideControl("Shape Settings","link"),t.wcpEditorFormHideControl("Shape Settings","open_link_in_new_window")))},r.prototype.updateShapesFormStateMaster=function(){var e=this.getIndexOfSpotWithId(u.editor.selected_shape),o=u.spots[e];o&&("spot"==o.type&&(t.wcpEditorFormShowControlsGroup("Shape Settings","icon"),t.wcpEditorFormShowControl("Shape Settings","icon_fill"),t.wcpEditorFormShowControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormShowControl("Shape Settings","opacity"),t.wcpEditorFormShowControl("Shape Settings","border_radius"),t.wcpEditorFormShowControl("Shape Settings","background_color"),t.wcpEditorFormShowControl("Shape Settings","background_opacity"),t.wcpEditorFormShowControl("Shape Settings","border_width"),t.wcpEditorFormShowControl("Shape Settings","border_style"),t.wcpEditorFormShowControl("Shape Settings","border_color"),t.wcpEditorFormShowControl("Shape Settings","border_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_opacity"),t.wcpEditorFormHideControl("Shape Settings","fill"),t.wcpEditorFormHideControl("Shape Settings","fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_color"),t.wcpEditorFormHideControl("Shape Settings","stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_width"),t.wcpEditorFormHideControl("Shape Settings","stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","stroke_linecap"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_width"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_linecap")),"rect"==o.type&&(t.wcpEditorFormHideControlsGroup("Shape Settings","icon"),t.wcpEditorFormHideControl("Shape Settings","icon_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormShowControl("Shape Settings","opacity"),t.wcpEditorFormShowControl("Shape Settings","border_radius"),t.wcpEditorFormShowControl("Shape Settings","background_color"),t.wcpEditorFormShowControl("Shape Settings","background_opacity"),t.wcpEditorFormShowControl("Shape Settings","border_width"),t.wcpEditorFormShowControl("Shape Settings","border_style"),t.wcpEditorFormShowControl("Shape Settings","border_color"),t.wcpEditorFormShowControl("Shape Settings","border_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_opacity"),t.wcpEditorFormHideControl("Shape Settings","fill"),t.wcpEditorFormHideControl("Shape Settings","fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_color"),t.wcpEditorFormHideControl("Shape Settings","stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_width"),t.wcpEditorFormHideControl("Shape Settings","stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","stroke_linecap"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_width"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_linecap")),"oval"==o.type&&(t.wcpEditorFormHideControlsGroup("Shape Settings","icon"),t.wcpEditorFormHideControl("Shape Settings","icon_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormShowControl("Shape Settings","opacity"),t.wcpEditorFormShowControl("Shape Settings","border_radius"),t.wcpEditorFormShowControl("Shape Settings","background_color"),t.wcpEditorFormShowControl("Shape Settings","background_opacity"),t.wcpEditorFormShowControl("Shape Settings","border_width"),t.wcpEditorFormShowControl("Shape Settings","border_style"),t.wcpEditorFormShowControl("Shape Settings","border_color"),t.wcpEditorFormShowControl("Shape Settings","border_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_border_opacity"),t.wcpEditorFormHideControl("Shape Settings","fill"),t.wcpEditorFormHideControl("Shape Settings","fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_color"),t.wcpEditorFormHideControl("Shape Settings","stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","stroke_width"),t.wcpEditorFormHideControl("Shape Settings","stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","stroke_linecap"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_fill_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_width"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_dasharray"),t.wcpEditorFormHideControl("Shape Settings","mouseover_stroke_linecap")),"poly"==o.type&&(t.wcpEditorFormHideControlsGroup("Shape Settings","icon"),t.wcpEditorFormHideControl("Shape Settings","icon_fill"),t.wcpEditorFormHideControl("Shape Settings","mouseover_icon_fill"),t.wcpEditorFormHideControl("Shape Settings","opacity"),t.wcpEditorFormHideControl("Shape Settings","border_radius"),t.wcpEditorFormHideControl("Shape Settings","background_color"),t.wcpEditorFormHideControl("Shape Settings","background_opacity"),t.wcpEditorFormHideControl("Shape Settings","border_width"),t.wcpEditorFormHideControl("Shape Settings","border_style"),t.wcpEditorFormHideControl("Shape Settings","border_color"),t.wcpEditorFormHideControl("Shape Settings","border_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_radius"),t.wcpEditorFormHideControl("Shape Settings","mouseover_background_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_background_opacity"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_width"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_style"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_color"),t.wcpEditorFormHideControl("Shape Settings","mouseover_border_opacity"),t.wcpEditorFormShowControl("Shape Settings","fill"),t.wcpEditorFormShowControl("Shape Settings","fill_opacity"),t.wcpEditorFormShowControl("Shape Settings","stroke_color"),t.wcpEditorFormShowControl("Shape Settings","stroke_opacity"),t.wcpEditorFormShowControl("Shape Settings","stroke_width"),t.wcpEditorFormShowControl("Shape Settings","stroke_dasharray"),t.wcpEditorFormShowControl("Shape Settings","stroke_linecap"),t.wcpEditorFormShowControl("Shape Settings","mouseover_fill"),t.wcpEditorFormShowControl("Shape Settings","mouseover_fill_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_stroke_color"),t.wcpEditorFormShowControl("Shape Settings","mouseover_stroke_opacity"),t.wcpEditorFormShowControl("Shape Settings","mouseover_stroke_width"),t.wcpEditorFormShowControl("Shape Settings","mouseover_stroke_dasharray"),t.wcpEditorFormShowControl("Shape Settings","mouseover_stroke_linecap")))},r.prototype.updateImageMapForm=function(){t.wcpEditorSetControlValue("Image Map Settings","image_map_name",u.general.name),t.wcpEditorSetControlValue("Image Map Settings","image_map_shortcode",u.general.shortcode),t.wcpEditorSetControlValue("Image Map Settings","image_map_width",u.general.width),t.wcpEditorSetControlValue("Image Map Settings","image_map_height",u.general.height),t.wcpEditorSetControlValue("Image Map Settings","responsive",u.general.responsive),t.wcpEditorSetControlValue("Image Map Settings","preserve_quality",u.general.preserve_quality),t.wcpEditorSetControlValue("Image Map Settings","pageload_animation",u.general.pageload_animation),t.wcpEditorSetControlValue("Image Map Settings","late_initialization",u.general.late_initialization),t.wcpEditorSetControlValue("Image Map Settings","center_image_map",u.general.center_image_map),t.wcpEditorSetControlValue("Image Map Settings","image_url",u.image.url),t.wcpEditorSetControlValue("Image Map Settings","sticky_tooltips",u.tooltips.sticky_tooltips),t.wcpEditorSetControlValue("Image Map Settings","constrain_tooltips",u.tooltips.constrain_tooltips),t.wcpEditorSetControlValue("Image Map Settings","tooltip_animation",u.tooltips.tooltip_animation),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_tooltips",u.tooltips.fullscreen_tooltips),t.wcpEditorSetControlValue("Image Map Settings","enable_fullscreen_mode",u.fullscreen.enable_fullscreen_mode),t.wcpEditorSetControlValue("Image Map Settings","start_in_fullscreen_mode",u.fullscreen.start_in_fullscreen_mode),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_background",u.fullscreen.fullscreen_background),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_button_position",u.fullscreen.fullscreen_button_position),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_button_type",u.fullscreen.fullscreen_button_type),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_button_color",u.fullscreen.fullscreen_button_color),t.wcpEditorSetControlValue("Image Map Settings","fullscreen_button_text_color",u.fullscreen.fullscreen_button_text_color),t.wcpEditorUpdateForm("Image Map Settings")},r.prototype.updateImageMapFormState=function(){0==parseInt(u.general.responsive,10)?(t.wcpEditorFormShowControl("Image Map Settings","image_map_width"),t.wcpEditorFormShowControl("Image Map Settings","image_map_height"),t.wcpEditorFormShowControl("Image Map Settings","reset_size"),t.wcpEditorFormHideControl("Image Map Settings","preserve_quality")):(t.wcpEditorFormHideControl("Image Map Settings","image_map_width"),t.wcpEditorFormHideControl("Image Map Settings","image_map_height"),t.wcpEditorFormHideControl("Image Map Settings","reset_size"),t.wcpEditorFormShowControl("Image Map Settings","preserve_quality")),1==parseInt(u.fullscreen.enable_fullscreen_mode,10)?(t.wcpEditorFormShowControl("Image Map Settings","start_in_fullscreen_mode"),t.wcpEditorFormShowControl("Image Map Settings","fullscreen_background"),t.wcpEditorFormShowControl("Image Map Settings","fullscreen_button_position"),t.wcpEditorFormShowControl("Image Map Settings","fullscreen_button_type"),t.wcpEditorFormShowControl("Image Map Settings","fullscreen_button_color"),t.wcpEditorFormShowControl("Image Map Settings","fullscreen_button_text_color")):(t.wcpEditorFormHideControl("Image Map Settings","start_in_fullscreen_mode"),t.wcpEditorFormHideControl("Image Map Settings","fullscreen_background"),t.wcpEditorFormHideControl("Image Map Settings","fullscreen_button_position"),t.wcpEditorFormHideControl("Image Map Settings","fullscreen_button_type"),t.wcpEditorFormHideControl("Image Map Settings","fullscreen_button_color"),t.wcpEditorFormHideControl("Image Map Settings","fullscreen_button_text_color"))},r.prototype.launchTooltipContentBuilder=function(){if(0==t("#imp-editor-tooltip-content-builder-wrap").length){var e="";e+='<div id="imp-editor-tooltip-content-builder-wrap">',e+='   <div id="imp-editor-tooltip-content-builder-background"></div>',e+='   <div id="imp-editor-tooltip-content-builder-close"><i class="fa fa-times" aria-hidden="true"></i></div>',e+='   <div id="imp-editor-tooltip-content-builder-tooltip-wrap" class="squares">',e+='       <div id="imp-editor-tooltip-content-builder" class="squares"></div>',e+="   </div>",e+='   <div id="imp-editor-tooltip-content-builder-description">',e+="       <p>Press the Done button when you are done editing, or click the Close button in the upper-right corner.</p>",e+="   </div>",e+='   <div class="wcp-editor-control-button" id="imp-editor-done-editing-tooltip">Done</div>',e+="</div>",t("body").append(e)}else t("#imp-editor-tooltip-content-builder-wrap").show();setTimeout(function(){t("#imp-editor-tooltip-content-builder-wrap").addClass("imp-visible")},10);var o=this.selectedSpot.tooltip_style.width,i=a(this.selectedSpot.tooltip_style.background_color),r="rgba("+i.r+", "+i.g+", "+i.b+", "+this.selectedSpot.tooltip_style.background_opacity+")";t("#imp-editor-tooltip-content-builder-tooltip-wrap").css({width:o,background:r}),t.squaresInitWithSettings(t("#imp-editor-tooltip-content-builder"),this.selectedSpot.tooltip_content.squares_settings),t.squaresShowEditorWindow(20,20)},r.prototype.doneEditingTooltip=function(){var e=t.squaresGetCurrentSettings(t("#imp-editor-tooltip-content-builder"));t.squaresGenerateHTML(t("#imp-editor-tooltip-content-builder"));this.selectedSpot.tooltip_content.squares_settings=e,this.redraw()},r.prototype.getCompressedSettings=function(){for(var e=t.extend(!0,{},u),o=[],i=0;i<e.spots.length;i++)o[i]=t.wcpCompress(e.spots[i],T),o[i].x=Math.round(1e3*o[i].x)/1e3,o[i].y=Math.round(1e3*o[i].y)/1e3,o[i].width&&(o[i].width=Math.round(1e3*o[i].width)/1e3),o[i].height&&(o[i].height=Math.round(1e3*o[i].height)/1e3);return e=t.wcpCompress(u,V),e.spots=o,e},h.prototype.add=function(t){return new h(this.x+t.x,this.y+t.y)},h.prototype.subtract=function(t){return new h(this.x-t.x,this.y-t.y)},h.prototype.scale=function(t){return new h(this.x*t,this.y*t)},h.prototype.normalized=function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new h(this.x/t,this.y/t)},h.prototype.dot=function(t){return this.x*t.x+this.y*t.y},h.prototype.closestPointOnLine=function(t,e){function o(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}var i=o(t,e);if(0==i)return o(this,v);var r=((this.x-t.x)*(e.x-t.x)+(this.y-t.y)*(e.y-t.y))/i;return r<0?t:r>1?e:new h(t.x+r*(e.x-t.x),t.y+r*(e.y-t.y))},h.prototype.vector2Args=function(t,e){return t=t||0,e=e||0,[this.x+t,this.y+e]}}(jQuery,window,document);