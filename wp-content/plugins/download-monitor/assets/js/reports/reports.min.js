function DLM_createLoaderObj(){var a=document.createElement("div");a=jQuery(a),a.addClass("dlm_reports_loader");var b=document.createElement("img");return b=jQuery(b),b.attr("src",dlm_rs.img_path+"ajax-loader.gif"),a.append(b),a}jQuery(function(a){a.each(a(".dlm-reports-block-chart"),function(a,b){new DLM_Reports_Block_Chart(b)}),a.each(a(".dlm-reports-block-summary"),function(a,b){new DLM_Reports_Block_Summary(b)}),a.each(a(".dlm-reports-block-table"),function(a,b){new DLM_Reports_Block_Table(b)})});var DLM_Reports_Data=function(a){this.type=null,this.from=null,this.to=null,this.period=null,this.init=function(a){this.type=jQuery(a).data("type"),this.to=jQuery(a).data("to"),this.from=jQuery(a).data("from"),this.period=jQuery(a).data("period")},this.init(a)},DLM_Reports_Data_Fetch=function(a,b,c){this.id=a,this.data=b,this.cb=c,this.fetch()};DLM_Reports_Data_Fetch.prototype.fetch=function(){var a=this.id,b=this.cb,c=this.data.from,d=this.data.to,e=this.data.period;jQuery.get(ajaxurl,{action:"dlm_reports_data",nonce:dlm_rs.ajax_nonce,id:a,from:c,to:d,period:e},function(a){b(a)})};var DLM_Reports_Block_Chart=function(a){this.container=a,this.id=null,this.queryData=null,this.data=null,this.chart=null,this.setup=function(){this.id=jQuery(this.container).attr("id"),this.queryData=new DLM_Reports_Data(this.container),this.displayLoader(),this.fetch()},this.setup()};DLM_Reports_Block_Chart.prototype.displayLoader=function(){jQuery(this.container).append(DLM_createLoaderObj())},DLM_Reports_Block_Chart.prototype.hideLoader=function(){jQuery(this.container).find(".dlm_reports_loader").remove()},DLM_Reports_Block_Chart.prototype.fetch=function(){var a=this;new DLM_Reports_Data_Fetch(this.id,this.queryData,function(b){a.data=b,a.hideLoader(),a.render()})},DLM_Reports_Block_Chart.prototype.render=function(){null!==this.data&&(this.chart=new Chart({parent:this.container,title:"",data:this.data,type:this.queryData.type,height:250,show_dots:0,x_axis_mode:"tick",y_axis_mode:"span",is_series:1,format_tooltip_x:function(a){return(a+"").toUpperCase()},format_tooltip_y:function(a){return a+" downloads"}}))};var DLM_Reports_Block_Summary=function(a){this.container=a,this.id=null,this.data=null,this.data=null,this.chart=null,this.setup=function(){this.id=jQuery(this.container).attr("id"),this.data=new DLM_Reports_Data(this.container),this.displayLoader(),this.fetch()},this.setup()};DLM_Reports_Block_Summary.prototype.displayLoader=function(){jQuery(this.container).append(DLM_createLoaderObj())},DLM_Reports_Block_Summary.prototype.hideLoader=function(){jQuery(this.container).find(".dlm_reports_loader").remove()},DLM_Reports_Block_Summary.prototype.fetch=function(){var a=this;new DLM_Reports_Data_Fetch(this.id,this.data,function(b){a.data=b,a.hideLoader(),a.render()})},DLM_Reports_Block_Summary.prototype.render=function(){if(null!==this.data){var a=this;jQuery.each(this.data,function(b,c){jQuery(a.container).find("#"+b)&&jQuery(a.container).find("#"+b).find("span:first").html(c)})}};var DLM_Reports_Block_Table=function(a){this.container=a,this.id=null,this.data=null,this.data=null,this.chart=null,this.setup=function(){this.id=jQuery(this.container).attr("id"),this.data=new DLM_Reports_Data(this.container),this.displayLoader(),this.fetch()},this.setup()};DLM_Reports_Block_Table.prototype.displayLoader=function(){jQuery(this.container).append(DLM_createLoaderObj())},DLM_Reports_Block_Table.prototype.hideLoader=function(){jQuery(this.container).find(".dlm_reports_loader").remove()},DLM_Reports_Block_Table.prototype.fetch=function(){var a=this;new DLM_Reports_Data_Fetch(this.id,this.data,function(b){a.data=b,a.hideLoader(),a.render()})},DLM_Reports_Block_Table.prototype.render=function(){if(!(null===this.data||this.data.length<2)){var a=jQuery(document.createElement("table"));a.attr("cellspacing",0).attr("cellpadding",0).attr("border",0);for(var b=document.createElement("tr"),c=0;c<this.data[0].length;c++){var d=document.createElement("th");d.innerHTML=this.data[0][c],b.appendChild(d)}a.append(b);for(var c=1;c<this.data.length;c++){for(var e=document.createElement("tr"),f=0;f<this.data[c].length;f++){var g=document.createElement("td");g.innerHTML=this.data[c][f],e.appendChild(g)}a.append(e)}jQuery(this.container).html("").append(a)}};